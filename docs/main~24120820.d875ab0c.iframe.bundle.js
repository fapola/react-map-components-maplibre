!function(e){function t(t){for(var n,i,s=t[0],c=t[1],l=t[2],p=0,d=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);d.length;)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={3:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],r=a[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=n);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+""+({}[e]||e)+"."+{0:"58f925e1",1:"e06451c0",2:"65411edc",17:"5c380d3a",18:"d576a087",19:"bed6027b",20:"b34f5fdd",21:"bf0dcc9e",22:"b4caed9c"}[e]+".iframe.bundle.js"}(e);var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(l);var r=a[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",c.name="ChunkLoadError",c.type=n,c.request=o,r[1](c)}a[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([693,7,5,15,13,6,16,4,14,11,9,10,12,8]),r()}({1014:function(e,t,r){},1015:function(e,t,r){"use strict";(function(e){(0,r(481).configure)([r(1016),r(1056)],e,!1)}).call(this,r(294)(e))},1016:function(e,t,r){var n={"./stories/IntroductionCore.stories.mdx":1017};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=1016},1017:function(e,t,r){"use strict";r.r(t),r.d(t,"__page",(function(){return l}));r(0);var n=r(112),a=r(595),o=r(601);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}const s={};function c({components:e,...t}){return Object(n.b)("wrapper",i({},s,t,{components:e,mdxType:"MDXLayout"}),Object(n.b)(o.a,{title:"Core/Introduction",mdxType:"Meta"}))}c.isMDXComponent=!0;const l=()=>{throw new Error("Docs-only story")};l.parameters={docsOnly:!0};const u={title:"Core/Introduction",includeStories:["__page"]},p={};u.parameters=u.parameters||{},u.parameters.docs={...u.parameters.docs||{},page:()=>Object(n.b)(a.a,{mdxStoryNameToKey:p,mdxComponentAnnotations:u},Object(n.b)(c,null))},t.default=u},1056:function(e,t,r){var n={"./components/MapLibreMap/MapLibreMap.stories.js":1057,"./components/MlComponentTemplate/MlComponentTemplate.stories.js":1106,"./components/MlCreatePdfButton/MlCreatePdfButton.stories.js":1095,"./components/MlFeatureEditor/MlFeatureEditor.stories.js":1091,"./components/MlFillExtrusionLayer/MlFillExtrusionLayer.stories.js":1107,"./components/MlFollowGps/MlFollowGps.stories.js":1066,"./components/MlGPXViewer/MlGPXViewer.stories.js":1067,"./components/MlGeoJsonLayer/MlGeoJsonLayer.stories.js":1071,"./components/MlImageMarkerLayer/MlImageMarkerLayer.stories.js":1108,"./components/MlLayer/MlLayer.stories.js":1072,"./components/MlLayerMagnify/MlLayerMagnify.stories.js":1109,"./components/MlLayerSwipe/MlLayerSwipe.stories.js":1110,"./components/MlLayerSwitcher/MlLayerSwitcher.stories.js":1096,"./components/MlMarker/MlMarker.stories.js":1084,"./components/MlNavigationCompass/MlNavigationCompass.stories.js":1085,"./components/MlNavigationTools/MlNavigationTools.stories.js":1111,"./components/MlOsmLayer/MlOsmLayer.stories.js":1112,"./components/MlScaleReference/MlScaleReference.stories.js":1113,"./components/MlShareMapState/MlShareMapState.stories.js":1114,"./components/MlSpatialElevationProfile/MlSpatialElevationProfile.stories.js":1115,"./components/MlThreeJsLayer/MlThreeJsLayer.stories.js":1097,"./components/MlUseMapDebugger/MlUseMapDebugger.stories.js":1116,"./components/MlVectorTileLayer/MlVectorTileLayer.stories.js":1117,"./components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.stories.js":1118,"./components/MlWmsLayer/MlWmsLayer.stories.js":1086,"./components/MlWmsLoader/MlWmsLoader.stories.js":1098,"./hooks/useMapState.stories.js":1089};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=1056},1057:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(143)),o=r(34),i=r(1),s={title:"Core/MapLibreMap",component:a.a,argTypes:{options:{control:{type:"object"}}}};t.default=s;var c=function(e){return Object(i.jsx)(o.a,{children:Object(i.jsx)(a.a,{options:e.options})})}.bind({});c.args={options:{style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[8.607,53.1409349],maxBounds:[[1.40625,43.452919],[17.797852,55.973798]]}},c.parameters={},c.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <MapComponentsProvider>\n    <MapLibreMap options={args.options} />\n  </MapComponentsProvider>\n)"}},c.parameters)},1058:function(e,t,r){},1066:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(254)),o=r(40),i=r(1),s={title:"MapComponents/MlFollowGps",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlFollowGps />"}},c.parameters)},1067:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(251)),o=r(40),i=r(322),s=r(1),c={title:"MapComponents/MlGPXViewer",component:a.a,argTypes:{options:{control:{type:"object"}}},decorators:o.a};t.default=c;var l=function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(i.a,{children:Object(s.jsx)(a.a,{})})})}.bind({});l.parameters={},l.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <>\n    <GeoJsonProvider>\n      <MlGPXViewer />\n    </GeoJsonProvider>\n  </>\n)"}},l.parameters)},1071:function(e,t,r){"use strict";r.r(t),r.d(t,"Linestring",(function(){return g})),r.d(t,"Polygon",(function(){return h})),r.d(t,"DefaultPaintOverrides",(function(){return y}));var n=r(16),a=r(5),o=r(0),i=r(120),s=r(40),c=r(34),l=r(611),u=r(612),p=r(327),d=r(1);console.log(p);var f={title:"MapComponents/MlGeoJsonLayer",component:i.a,argTypes:{url:{},layer:{}},decorators:s.a};t.default=f;var m=function(e){return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(i.a,Object(a.a)({},e))})},g=function(e){var t=Object(o.useContext)(c.b),r=Object(o.useState)(l),a=Object(n.a)(r,2),s=a[0],p=a[1],f=Object(o.useRef)(!1);return Object(o.useEffect)((function(){t.getMap()&&!f.current&&(f.current=!0,t.getMap().setCenter({lng:7.137609868988648,lat:50.74746799549129}),t.getMap().setZoom(9.5),setTimeout((function(){p(u)}),4e3))}),[s,t]),Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(i.a,{type:"line",geojson:s,transitionTime:2e3})})}.bind({});g.parameters={},g.args={};var h=m.bind({});h.parameters={},h.args={geojson:p};var y=m.bind({});y.parameters={},y.args={defaultPaintOverrides:{fill:{"fill-color":"blue"},circle:{"circle-color":"red"},line:{"line-color":"orange"}},geojson:p},g.parameters=Object(a.a)({storySource:{source:'(props) => {\n  const mapContext = useContext(MapContext);\n  const [geojson, setGeojson] = useState(sample_geojson_1);\n  const initializedRef = useRef(false);\n\n  useEffect(() => {\n    if (!mapContext.getMap() || initializedRef.current) return;\n\n    initializedRef.current = true;\n    mapContext.getMap().setCenter({ lng: 7.137609868988648, lat: 50.74746799549129 });\n    mapContext.getMap().setZoom(9.5);\n\n    setTimeout(() => {\n      setGeojson(sample_geojson_2);\n    }, 4000);\n  }, [geojson, mapContext]);\n\n  return (\n    <>\n      <MlGeoJsonLayer type="line" geojson={geojson} transitionTime={2000} />\n    </>\n  );\n}'}},g.parameters),h.parameters=Object(a.a)({storySource:{source:"(props) => {\n  return (\n    <>\n      <MlGeoJsonLayer {...props} />\n    </>\n  );\n}"}},h.parameters),y.parameters=Object(a.a)({storySource:{source:"(props) => {\n  return (\n    <>\n      <MlGeoJsonLayer {...props} />\n    </>\n  );\n}"}},y.parameters)},1072:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(145)),o=r(40),i=r(1),s={title:"MapComponents/MlLayer",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlLayer />"}},c.parameters)},1073:function(e,t,r){},1074:function(e,t,r){},1078:function(e,t,r){},1084:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(252)),o=r(40),i=r(1),s={title:"MapComponents/MlMarker",component:a.a,decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,Object(n.a)({},e))}.bind({});c.args={content:"WhereGroup",lng:7.0851268,lat:50.73884,mapId:"map_1"},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlMarker {...args}/>"}},c.parameters)},1085:function(e,t,r){"use strict";r.r(t),r.d(t,"Standard",(function(){return l})),r.d(t,"StyleExample",(function(){return u}));var n=r(5),a=(r(0),r(253)),o=r(40),i=r(1),s={title:"MapComponents/MlNavigationCompass",component:a.a,decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,Object(n.a)({},e))},l=c.bind({});l.args={style:{transform:"scale(4)",left:"50%",marginLeft:"-100px",top:"50%",marginTop:"-100px"}};var u=c.bind({});u.args={style:{transform:"scale(4)",left:"50%",marginLeft:"-100px",top:"50%",marginTop:"-100px"},backgroundStyle:{border:"12px solid #adad44",background:"radial-gradient(#417741, #111)"},needleStyle:{":hover svg path:nth-of-type(1)":{fill:"#eded66"},":hover svg path:nth-of-type(2)":{fill:"#252f1b"},"svg path:nth-of-type(1)":{fill:"#adad44"},"svg path:nth-of-type(2)":{fill:"#1a1d15"}},rotateRightStyle:{"svg:hover path":{fill:"#ededb1"}},rotateLeftStyle:{"svg:hover path":{fill:"#ededb1"}}},l.parameters=Object(n.a)({storySource:{source:"(props) => <MlNavigationCompass {...props} />"}},l.parameters),u.parameters=Object(n.a)({storySource:{source:"(props) => <MlNavigationCompass {...props} />"}},u.parameters)},1086:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return d}));var n=r(5),a=r(16),o=r(0),i=r(111),s=r(86),c=r(1130),l=r(206),u=(r(1087),r(1)),p={title:"MapComponents/MlWmsLayer",component:i.a,argTypes:{url:{},layer:{}},decorators:l.a};t.default=p;var d=function(e){var t=Object(o.useState)(!0),r=Object(a.a)(t,2),l=r[0],p=r[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(s.a,{children:Object(u.jsx)(c.a,{color:"primary",variant:l?"contained":"outlined",onClick:function(){return p(!l)},children:"WMS"})}),Object(u.jsx)(i.a,Object(n.a)({visible:l},e))]})}.bind({});d.parameters={},d.args={mapId:"map_2",url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"}},d.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const [showLayer, setShowLayer] = useState(true);\n\n  return (\n    <>\n      <TopToolbar>\n        <Button\n          color="primary"\n          variant={showLayer ? "contained" : "outlined"}\n          onClick={() => setShowLayer(!showLayer)}\n        >\n          WMS\n        </Button>\n      </TopToolbar>\n      <MlWmsLayer visible={showLayer} {...props} />\n    </>\n  );\n}'}},d.parameters)},1087:function(e,t,r){},1089:function(e,t,r){"use strict";r.r(t),r.d(t,"ViewportOnly",(function(){return u})),r.d(t,"IncludeBaseLayers",(function(){return p})),r.d(t,"MatchLayerIdString",(function(){return d})),r.d(t,"MatchLayerIdRegexp",(function(){return f})),r.d(t,"NonBaseLayersOnly",(function(){return m}));var n=r(5),a=r(0),o=r(80),i=r(40),s=r(1),c={title:"Hooks/UseMapState",component:o.a,argTypes:{},decorators:i.a};t.default=c;var l=function(e){var t=Object(o.a)(Object(n.a)({},e));return Object(a.useEffect)((function(){}),[t.layers]),Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("div",{style:{position:"fixed",zIndex:1e4,display:"flex",flexWrap:"wrap",top:0,left:0,right:0,bottom:0,maxHeight:"100VH",backgroundColor:"rgba(80,80,80,.8)",padding:"50px",fontSize:"20px",color:"#51ff09",overflow:"hidden",pointerEvents:"none"},children:Object(s.jsx)("pre",{children:JSON.stringify(t,null,"  ")})})})},u=l.bind({});u.parameters={},u.args={mapId:"map_1",watch:{viewport:!0,layers:!1,sources:!1}};var p=l.bind({});p.parameters={},p.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0}};var d=l.bind({});d.parameters={},d.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0,matchLayerIds:"water"}};var f=l.bind({});f.parameters={},f.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0,matchLayerIds:/water/}};var m=l.bind({});m.parameters={},m.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}},u.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},u.parameters),p.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},p.parameters),d.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},d.parameters),f.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},f.parameters),m.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},m.parameters)},1091:function(e,t,r){"use strict";r.r(t),r.d(t,"EditPolygon",(function(){return he})),r.d(t,"EditPoint",(function(){return ye})),r.d(t,"EditLineString",(function(){return be})),r.d(t,"DrawPolygon",(function(){return ve})),r.d(t,"DrawPoint",(function(){return je})),r.d(t,"DrawLineString",(function(){return Oe}));var n=r(5),a=r(0),o=r(16),i=(r(1058),r(1059),r(419)),s=r.n(i),c="mapbox-gl-draw_boxselect",l="add",u="move",p="pointer",d="none",f="polygon",m="Feature",g="Polygon",h="LineString",y="Point",b="Multi",v="MultiPoint",j="MultiLineString",O="MultiPolygon",x="draw.create",S="draw.update",M="draw.combine",C="draw.uncombine",L="move",w="change_coordinates",I="feature",E="midpoint",T="vertex",_="true",R="false";function A(e){return function(t){var r=t.featureTarget;return!!r&&(!!r.properties&&r.properties.meta===e)}}function P(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===_&&e.featureTarget.properties.meta===I))}function k(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===R&&e.featureTarget.properties.meta===I))}function H(e){return void 0===e.featureTarget}function F(e){var t=e.featureTarget;return!!t&&(!!t.properties&&t.properties.meta===T)}function N(e){return!!e.originalEvent&&!0===e.originalEvent.shiftKey}var U={enable:function(e){setTimeout((function(){e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()}),0)},disable:function(e){setTimeout((function(){e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()}),0)}};var B=function(e,t){return!!e.lngLat&&(e.lngLat.lng===t[0]&&e.lngLat.lat===t[1])},G=function(e,t,r,n){return{type:m,properties:{meta:T,parent:e,coord_path:r,active:n?_:R},geometry:{type:y,coordinates:t}}},D={onSetup:function(){console.log("Change mode: custom polygon");var e=this.newFeature({type:m,properties:{},geometry:{type:g,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),U.disable(this),this.updateUIClasses({mouse:l}),this.activateUIButton(f),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&B(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode("custom_select",{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:l}),e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),this.map.fire(x,{features:[e.polygon.toGeoJSON()]})},clickOnVertex:function(e){return this.changeMode("custom_select",{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),F(t)&&this.updateUIClasses({mouse:p})}};D.onTap=D.onClick=function(e,t){return F(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},D.onKeyUp=function(e,t){!function(e){return 27===e.keyCode}(t)?function(e){return 13===e.keyCode}(t)&&this.changeMode("custom_select",{featureIds:[e.polygon.id]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select"))},D.onStop=function(e){this.updateUIClasses({mouse:d}),U.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.polygon.id)&&(e.polygon.removeCoordinate("0.".concat(e.currentVertexPosition)),e.polygon.isValid()?this.map.fire(x,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select",{},{silent:!0})))},D.toDisplayFeatures=function(e,t,r){var n=t.properties.id===e.polygon.id;if(t.properties.active=n?_:R,!n)return r(t);if(0!==t.geometry.coordinates.length){var a=t.geometry.coordinates[0].length;if(!(a<3)){if(t.properties.meta=I,r(G(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),a>3){var o=t.geometry.coordinates[0].length-3;r(G(e.polygon.id,t.geometry.coordinates[0][o],"0.".concat(o),!1))}if(a<=4){var i=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:m,properties:t.properties,geometry:{coordinates:i,type:h}}),3===a)return}return r(t)}}},D.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select")};var z=D,q=r(605),V=r.n(q);var W=function(e,t){var r=t.getBoundingClientRect();return new V.a(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))},K=function(e,t,r){var n=t.geometry.coordinates,a=r.geometry.coordinates;if(n[1]>85||n[1]<-85||a[1]>85||a[1]<-85)return null;var o={lng:(n[0]+a[0])/2,lat:(n[1]+a[1])/2};return{type:m,properties:{meta:E,parent:e,lng:o.lng,lat:o.lat,coord_path:r.properties.coord_path},geometry:{type:y,coordinates:[o.lng,o.lat]}}};var J=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.geometry,o=a.type,i=a.coordinates,s=t.properties&&t.properties.id,c=[];function l(e,t){var n="",a=null;e.forEach((function(e,o){var i=null!=t?"".concat(t,".").concat(o):String(o),l=G(s,e,i,u(i));if(r.midpoints&&a){var p=K(s,a,l);p&&c.push(p)}a=l;var d=JSON.stringify(e);n!==d&&c.push(l),0===o&&(n=d)}))}function u(e){return!!r.selectedPaths&&-1!==r.selectedPaths.indexOf(e)}function p(){var n=o.replace(b,"");i.forEach((function(a,o){var i={type:m,properties:t.properties,geometry:{type:n,coordinates:a}};c=c.concat(e(i,r,o))}))}return o===y?c.push(G(s,i,n,u(n))):o===g?i.forEach((function(e,t){l(e,null!==n?"".concat(n,".").concat(t):String(t))})):o===h?l(i,n):0===o.indexOf(b)&&p(),c};function Y(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(var t=0,r=e.length;t<r;t++)this.add(e[t]),void 0!==e[t]&&("string"==typeof e[t]?this._items[e[t]]=t:this._nums[e[t]]=t)}Y.prototype.add=function(e){return this.has(e)||(this._length++,"string"==typeof e?this._items[e]=this._length:this._nums[e]=this._length),this},Y.prototype.delete=function(e){return!1===this.has(e)||(this._length--,delete this._items[e],delete this._nums[e]),this},Y.prototype.has=function(e){return("string"==typeof e||"number"==typeof e)&&(void 0!==this._items[e]||void 0!==this._nums[e])},Y.prototype.values=function(){var e=this,t=[];return Object.keys(this._items).forEach((function(r){t.push({k:r,v:e._items[r]})})),Object.keys(this._nums).forEach((function(r){t.push({k:JSON.parse(r),v:e._nums[r]})})),t.sort((function(e,t){return e.v-t.v})).map((function(e){return e.k}))},Y.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var X=Y,Z=r(606),Q=r.n(Z),$=function(e,t){var r=-90,n=90,a=-90,o=90,i=270,s=-270;e.forEach((function(e){var t=Q()(e),c=t[1],l=t[3],u=t[0],p=t[2];c>r&&(r=c),l<n&&(n=l),l>a&&(a=l),c<o&&(o=c),u<i&&(i=u),p>s&&(s=p)}));var c=t;return r+c.lat>85&&(c.lat=85-r),a+c.lat>90&&(c.lat=90-a),n+c.lat<-85&&(c.lat=-85-n),o+c.lat<-90&&(c.lat=-90-o),i+c.lng<=-270&&(c.lng+=360*Math.ceil(Math.abs(c.lng)/360)),s+c.lng>=270&&(c.lng-=360*Math.ceil(Math.abs(c.lng)/360)),c},ee=function(e,t){var r=$(e.map((function(e){return e.toGeoJSON()})),t);e.forEach((function(e){var t,n=e.getCoordinates(),a=function(e){var t={lng:e[0]+r.lng,lat:e[1]+r.lat};return[t.lng,t.lat]},o=function(e){return e.map((function(e){return a(e)}))};e.type===y?t=a(n):e.type===h||e.type===v?t=n.map(a):e.type===g||e.type===j?t=n.map(o):e.type===O&&(t=n.map((function(e){return e.map((function(e){return o(e)}))}))),e.incomingCoords(t)}))},te={onSetup:function(e){var t=this;console.log("Change mode: custom select");var r={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(r.initiallySelectedFeatureIds.filter((function(e){return void 0!==t.getFeature(e)}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),r},fireUpdate:function(){this.map.fire(S,{action:L,features:this.getSelected().map((function(e){return e.toGeoJSON()}))})},fireActionable:function(){var e=this,t=this.getSelected(),r=t.filter((function(t){return e.isInstanceOf("MultiFeature",t)})),n=!1;if(t.length>1){n=!0;var a=t[0].type.replace("Multi","");t.forEach((function(e){e.type.replace("Multi","")!==a&&(n=!1)}))}var o=r.length>0,i=t.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:o,trash:i})},getUniqueIds:function(e){return e.length?e.map((function(e){return e.properties.id})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.add(t),e}),new X).values():[]},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){U.enable(this)},onMouseMove:function(e){return this.stopExtendedInteractions(e)},onMouseOut:function(e){if(e.dragMoving)return this.fireUpdate()}};te.onTap=te.onClick=function(e,t){return H(t)?this.clickAnywhere(e,t):A(T)(t)?this.clickOnVertex(e,t):function(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&e.featureTarget.properties.meta===I)}(t)?this.clickOnFeature(e,t):void 0},te.clickAnywhere=function(e){var t=this,r=this.getSelectedIds();r.length&&(this.clearSelectedFeatures(),r.forEach((function(e){return t.doRender(e)}))),U.enable(this),this.stopExtendedInteractions(e)},te.clickOnVertex=function(e,t){this.changeMode("custom_direct_select",{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:u})},te.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},te.clickOnFeature=function(e,t){var r=this;U.disable(this),this.stopExtendedInteractions(e);var n=N(t),a=this.getSelectedIds(),o=t.featureTarget.properties.id,i=this.isSelected(o);if(!n&&i&&this.getFeature(o).type!==y)return this.changeMode("custom_direct_select",{featureId:o});i&&n?(this.deselect(o),this.updateUIClasses({mouse:p}),1===a.length&&U.enable(this)):!i&&n?(this.select(o),this.updateUIClasses({mouse:u})):i||n||(a.forEach((function(e){return r.doRender(e)})),this.setSelected(o),this.updateUIClasses({mouse:u})),this.doRender(o)},te.onMouseDown=function(e,t){return P(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&function(e){return!!e.originalEvent&&(!!e.originalEvent.shiftKey&&0===e.originalEvent.button)}(t)?this.startBoxSelect(e,t):void 0},te.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=W(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},te.onTouchStart=function(e,t){if(P(t))return this.startOnActiveFeature(e,t)},te.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},te.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:l}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(c),this.map.getContainer().appendChild(e.boxSelectElement));var r=W(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),a=Math.max(e.boxSelectStartLocation.x,r.x),o=Math.min(e.boxSelectStartLocation.y,r.y),i=Math.max(e.boxSelectStartLocation.y,r.y),s="translate(".concat(n,"px, ").concat(o,"px)");e.boxSelectElement.style.transform=s,e.boxSelectElement.style.WebkitTransform=s,e.boxSelectElement.style.width="".concat(a-n,"px"),e.boxSelectElement.style.height="".concat(i-o,"px")},te.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};ee(this.getSelected(),r),e.dragMoveLocation=t.lngLat},te.onMouseUp=function(e,t){var r=this;if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){var n=[e.boxSelectStartLocation,W(t.originalEvent,this.map.getContainer())],a=this.featuresAt(null,n,"click"),o=this.getUniqueIds(a).filter((function(e){return!r.isSelected(e)}));o.length&&(this.select(o),o.forEach((function(e){return r.doRender(e)})),this.updateUIClasses({mouse:u}))}this.stopExtendedInteractions(e)},te.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?_:R,r(t),this.fireActionable(),t.properties.active===_&&t.geometry.type!==y&&J(t).forEach(r)},te.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},te.onCombineFeatures=function(){var e=this.getSelected();if(!(0===e.length||e.length<2)){for(var t=[],r=[],n=e[0].type.replace("Multi",""),a=0;a<e.length;a++){var o=e[a];if(o.type.replace("Multi","")!==n)return;o.type.includes("Multi")?o.getCoordinates().forEach((function(e){t.push(e)})):t.push(o.getCoordinates()),r.push(o.toGeoJSON())}if(r.length>1){var i=this.newFeature({type:m,properties:r[0].properties,geometry:{type:"Multi".concat(n),coordinates:t}});this.addFeature(i),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([i.id]),this.map.fire(M,{createdFeatures:[i.toGeoJSON()],deletedFeatures:r})}this.fireActionable()}},te.onUncombineFeatures=function(){var e=this,t=this.getSelected();if(0!==t.length){for(var r=[],n=[],a=function(a){var o=t[a];e.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach((function(t){e.addFeature(t),t.properties=o.properties,r.push(t.toGeoJSON()),e.select([t.id])})),e.deleteFeature(o.id,{silent:!0}),n.push(o.toGeoJSON()))},o=0;o<t.length;o++)a(o);r.length>1&&this.map.fire(C,{createdFeatures:r,deletedFeatures:n}),this.fireActionable()}};var re=te,ne={getMatchingVertices:function(e,t,r,n){for(var a=[],o=e[0].toFixed(5),i=e[1].toFixed(5),s=0;s<r.length;s++)if(r[s].id!==t)for(var c=0;c<r[s].geometry.coordinates.length;c++)for(var l=0;l<r[s].geometry.coordinates[c].length;l++)o===r[s].geometry.coordinates[c][l][0].toFixed(5)&&i===r[s].geometry.coordinates[c][l][1].toFixed(5)&&a.push({featureId:r[s].id,coord_path:c+"."+l,lng:r[s].geometry.coordinates[c][l][0],lat:r[s].geometry.coordinates[c][l][1]});return a},getDrawInstance:function(e){for(var t=e._controls.length-1;t>=0;t--)if(e._controls[t].options&&"custom_select"===e._controls[t].options.defaultMode)return e._controls[t];return null}},ae=A(T),oe=A(E),ie={fireUpdate:function(){this.map.fire(S,{action:w,features:this.getSelected().map((function(e){return e.toGeoJSON()}))})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);N(t)||-1!==n?N(t)&&-1===n&&e.selectedCoordPaths.push(r.coord_path):e.selectedCoordPaths=[r.coord_path];var a=ne.getDrawInstance(this.map).getAll(),o=ne.getMatchingVertices(t.featureTarget._geometry.coordinates,t.featureTarget.properties.parent,a.features,this.map);e.groupMove_vertices=o;for(var i=0;i<e.groupMove_vertices.length;i++)e.groupMove_vertices[i].feature=this.getFeature(e.groupMove_vertices[i].featureId);var s=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(s)},onMidpoint:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]},pathsToCoordinates:function(e,t){return t.map((function(t){return{feature_id:e,coord_path:t}}))},onFeature:function(e,t){0===e.selectedCoordPaths.length?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,r){ee(this.getSelected(),r),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,r){for(var n=e.selectedCoordPaths.map((function(t){return e.feature.getCoordinate(t)})),a=n.map((function(e){return{type:m,properties:{},geometry:{type:y,coordinates:e}}})),o=$(a,r),i=0;i<n.length;i++){var s=n[i];e.feature.updateCoordinate(e.selectedCoordPaths[i],s[0]+o.lng,s[1]+o.lat);for(var c=0;c<e.groupMove_vertices.length;c++){var l=e.groupMove_vertices[c].coord_path.split(".");if(void 0!==l[0]&&void 0!==l[1]&&void 0!==e.groupMove_vertices[c].feature.coordinates[l[0]]&&void 0!==e.groupMove_vertices[c].feature.coordinates[l[0]][l[1]]){var u=e.groupMove_vertices[c].feature.coordinates[l[0]][l[1]];e.groupMove_vertices[c].feature.updateCoordinate(e.groupMove_vertices[c].coord_path,u[0]+o.lng,u[1]+o.lat)}}}},clickNoTarget:function(){this.changeMode("custom_select")},clickInactive:function(){this.changeMode("custom_select")},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){var t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===y)throw new TypeError("direct_select mode doesn't handle point features");var n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[],groupMove_vertices:e.groupMove_vertices?e.groupMove_vertices:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),U.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){U.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,r){e.featureId===t.properties.id?(t.properties.active=_,r(t),J(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=R,r(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort((function(e,t){return t.localeCompare(e,"en",{numeric:!0})})).forEach((function(t){return e.feature.removeCoordinate(t)})),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode("custom_select",{}))},onMouseMove:function(e,t){var r=P(t),n=ae(t),a=0===e.selectedCoordPaths.length;r&&a||n&&!a?this.updateUIClasses({mouse:u}):this.updateUIClasses({mouse:d}),this.stopDragging(e)},onMouseOut:function(e){e.dragMoving&&this.fireUpdate()}};ie.onTouchStart=ie.onMouseDown=function(e,t){return ae(t)?this.onVertex(e,t):P(t)?this.onFeature(e,t):oe(t)?this.onMidpoint(e,t):void 0},ie.onDrag=function(e,t){if(!0===e.canDragMove){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat}},ie.onClick=function(e,t){return H(t)?this.clickNoTarget(e,t):P(t)?this.clickActiveFeature(e,t):k(t)?this.clickInactive(e,t):void this.stopDragging(e)},ie.onTap=function(e,t){return H(t)?this.clickNoTarget(e,t):P(t)?this.clickActiveFeature(e,t):k(t)?this.clickInactive(e,t):void 0},ie.onTouchEnd=ie.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var se=ie,ce=r(215),le=r(34),ue=r(1);function pe(e){var t=Object(a.useRef)(null),r=Object(a.useRef)(null),n=Object(a.useContext)(le.b),i=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlFeatureEditor-")+Object(ce.a)()),c=Object(a.useRef)(e.onChange),l=Object(a.useState)(!1),u=Object(o.a)(l,2),p=u[0],d=u[1],f=Object(a.useState)(!1),m=Object(o.a)(f,2),g=m[0],h=m[1],y=Object(a.useState)(!1),b=Object(o.a)(y,2),v=b[0],j=b[1],O=function(e){console.log("MlFeatureEditor mode change to "+e.mode)},x=function(){j(Math.random())};return Object(a.useEffect)((function(){var e=i.current;return function(){t.current&&(t.current.cleanup(e),t.current=null)}}),[]),Object(a.useEffect)((function(){n.mapExists(e.mapId)&&n.getMap(e.mapId).style&&!p&&(t.current=n.getMap(e.mapId),d(!0),t.current&&t.current.style&&t.current.getSource("mapbox-gl-draw-cold")&&r.current&&void 0!==r.current.remove&&r.current.remove(),r.current=new s.a({displayControlsDefault:!1,defaultMode:e.mode||"custom_select",modes:Object.assign({custom_polygon:z,custom_select:re,custom_direct_select:se},s.a.modes)}),t.current.on("draw.modechange",O,i.current),t.current.addControl(r.current,"top-left",i.current),t.current.on("mouseup",x,i.current),h(!0))}),[n.map,n,e,p]),Object(a.useEffect)((function(){r.current&&e.geojson&&e.geojson.geometry&&e.geojson.geometry.coordinates&&r.current.set({type:"FeatureCollection",features:[e.geojson]})}),[e.geojson,g]),Object(a.useEffect)((function(){if(r.current&&v){var e=r.current.getAll();"function"==typeof c.current&&c.current(e.features)}}),[v]),Object(a.useEffect)((function(){e.mode&&r.current&&r.current.changeMode(e.mode)}),[e.mode]),Object(ue.jsx)(ue.Fragment,{})}pe.__docgenInfo={description:"",methods:[],displayName:"MlFeatureEditor"};var de=pe;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFeatureEditor/MlFeatureEditor.js"]={name:"MlFeatureEditor",docgenInfo:pe.__docgenInfo,path:"src/components/MlFeatureEditor/MlFeatureEditor.js"});var fe=r(40),me={title:"MapComponents/MlFeatureEditor",component:de,argTypes:{},decorators:fe.a},ge=(t.default=me,function(e){return Object(ue.jsx)(de,Object(n.a)({debug:!0,onChange:function(e){console.log(e)}},e))}),he=ge.bind({});he.args={mode:"custom_select",geojson:{type:"Feature",properties:{},geometry:{coordinates:[[[7.0904979943736635,50.73948334574527],[7.087554458473562,50.73827346433987],[7.093562913197076,50.73723639825727],[7.096294028980594,50.7387727842636],[7.0904979943736635,50.73948334574527]]],type:"Polygon"}}};var ye=ge.bind({});ye.args={mode:"custom_select",geojson:{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[7.0904979943736635,50.73948334574527]}}};var be=ge.bind({});be.args={mode:"simple_select",geojson:{type:"Feature",properties:{},geometry:{coordinates:[[7.0904979943736635,50.73948334574527],[7.087554458473562,50.73827346433987],[7.093562913197076,50.73723639825727],[7.096294028980594,50.7387727842636]],type:"LineString"}}};var ve=ge.bind({});ve.args={mode:"custom_polygon"};var je=ge.bind({});je.args={mode:"draw_point"};var Oe=ge.bind({});Oe.args={mode:"draw_line_string"},he.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},he.parameters),ye.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},ye.parameters),be.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},be.parameters),ve.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},ve.parameters),je.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},je.parameters),Oe.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},Oe.parameters)},1095:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return S}));var n=r(5),a=r(0),o=r(34),i=r(55),s=r(157),c=r.n(s),l=r(603),u={street:["footway","street","road","street_name","residential","path","pedestrian","road_reference","road_reference_intl","square","place"],number:["house_number","street_number"],place:["city","village","hamlet","locality","croft","neighbourhood","suburb","city_district","district","quarter","borough","city_block","residential","commercial","industrial","houses","subdivision","allotments","postal_city","town","municipality","local_administrative_area"],zip:["postcode","partial_postcode"],state:["state","province","state_code"]},p=function(e){var t=[];for(var r in u)u[r].some((function(r){return!!e.hasOwnProperty(r)&&(t.push(e[r]),!0)}));return t.join(", ")},d=function(e){return 25.4,96/25.4*e+"px"},f=function(e,t,r){r(!0);var n=window.devicePixelRatio,a=document.createElement("div");a.className="hidden-map",document.body.appendChild(a);var o=document.createElement("div");o.style.width=d(210),o.style.height=d(297),a.appendChild(o);var s=new c.a.Map({container:o,center:e.getCenter(),zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1}),u=e.getStyle(),f=function(e){var t=u.sources[e];Object.keys(t).forEach((function(e){t[e]||delete t[e]}))};for(var m in u.sources)f(m);s.setStyle(u),s.once("idle",(function(){var e,o=new l.a({orientation:"p",unit:"mm",compress:!0});Object.defineProperty(window,"devicePixelRatio",{get:function(){return 3.125}});var c=(t?p(t.address):"").split(","),u=[];u.length&&c.forEach((function(e){var t=e.match(/.{1,34}/g);u.push.apply(u,Object(i.a)(t))})),o.addImage(s.getCanvas().toDataURL("image/png"),"png",0,0,210,297,null,"FAST"),o.setFillColor("white"),o.rect(138,287,297,10,"F"),o.setFontSize(10),o.text("Datenquelle: © OpenStreetMap-Mitwirkende",140,o.internal.pageSize.height-3),o.setFillColor("white");var d=3.25*u.length+3+3+6.5+4+1;o.rect(2.5,2,66.5,d,"F"),o.setFontSize(10),o.text("Karten PDF:",6,5.5),o.rect(6,7,60,3.25*u.length+4+1),o.setFontSize(10),u.forEach((function(e,t){o.text(e.trim(),8,10+3.5*t+2)})),o.addImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKgAAACxCAMAAABnTAbVAAAC8VBMVEUAAAD/AACAAACqAFW/AECZMzOqK1W2JEm/IECqHDmzGk25F0aqFUCxJzu2JEmqIkSvIEC0HjyqHEeuG0OzGkC2GD2uI0axIUO1IECtHz2xHUWzHEKtG0CwGj6zIkS1IUKyHz60HkSvHUKxHECzHD6uG0OxIUGzIECuHz6wHkOyHkG0HUCwHD6xHEOzIUGvIECxHz6zH0KvHkGxHUCyHT+vHEKwHEGyIECzHz+wH0KxHkGzHkCwHT+xHUKyHEGvIECxHz+yH0KzHkGwHkCxHj+zHUKwHUGxHECyHz+wH0GxH0GyHkCwHj+xHUGyHUGzHUCwHz+xH0GyH0GwHkCxHj+yHkGwHUCxHUCyHT+wH0GxH0CxHkCyHj+wHkGxHkCyHUCwHT+xH0GyH0CwH0CxHj+yHkGwHkCxHUCxHT+yHUGwH0CxH0CyHj+wHkGxHkCyHkCwHT+xHUGxH0CyH0CxHz+xHkGyHkCwHkCxHj+yHUGwHUCxH0CwHkGxHkCxHkCyHj+xHUGxHUCyH0CwHz+xHkGyHkCwHkCxHj+xHkGwHUCxHUCxHz+yH0GxHkCyHj+wHkGxHUCxHUCwHz+xH0GxHkCyHkCxHj+xHkGyHkCxHUCxHT+yH0GwHkCxHkCxHj+wHkGxHkCxHkCyHT+xH0GxH0CyHkCxHj+xHkGxHkCwHkCxHT+xHUCwH0CxHkCxHj+yHkCxHkCxHkCyHj+xHUCxH0CxHkCwHj+xHkCxHkCwHkCxHj+xHkCyHUCxH0CxHj+xHkCxHkCxHkCxHj+wHkCxHUCxH0CyHj+xHkCxHkCyHkCxHj+xHkCxHUCxHz+xHkCwHkCxHkCxHj+yHkCxHkCxHkCxHkCxHkCxHkCxHj+xHkCwHkCxHT+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xH0CxHkCxHkCyHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkD///9g21WfAAAA+XRSTlMAAQIDBAUGBwgJCgsMDQ4PEBESExQVFhcYGRobHB0eHyEiIyQlJicoKSorLC0uLzAxMjM0NTY3ODk6Ozw9Pj9AQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpbXF1eX2BhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ent8fn+AgYKDhIWGh4iJiouMjY6PkZKTlJWWl5iZmpucnZ6foKGio6SlpqeoqaqrrK2ur7CxsrO0tba3uLm6u7y9vr/AwcLDxMXGx8jJysvMzc/Q0dLT1NXW19ja29zd3uDh4uPk5ebn6Onq6+zt7u/w8fLz9PX29/j5+vv8/f7v1AMKAAAAAWJLR0T61W0GSgAACWZJREFUGBnVwXlAVHUCB/DvmxkuD0QswFo3TcwzS0p01RVMpUytLKxMSVNpLUsLj7VDo7btsNTssrTMdAtWNjNbkyzF3EotwrXMI7XwAAxE5Jz5/rcaMMx782Z452/p84GV2na+ZmRqasrwxE4OtFRhI/+29SS9qn/86PGUKLQ4CW+X0p/n+xeTnGhB4v/NgIpXj3aihZhRyaCOPNYRwrW+KwkKmWxWTVYfiBRy49qzxW0hN5FaeLLiIUrv5UUkl0Au9iy1qXk1BgJIIzZ7eMG1kHuBmpVMkWCz0LQC1itzQkb6hTpsiYOdQmcfZ6M8yPWmLoWDYBsp9SCbZENuDPWpmgKbJO+mr9WQm0y95sEO8Zso9z7k7qJuj8JyzofPUeFjyA2nfvfDYl23089eyPWkfrXDYCXXI1X0Vy5BxllC/U50hHU676aqbpDLogEfoEFUR5g0qoTqJkJuAo0YjQZPpcIMab6bAayBXMgxGrDfiXrhBVnRMOyiTxhQkQtyGTTidjS4quZIEgzqfYRBjIFc2Pc0YCcaLWbdXyUY8acSBrMBCgPqqJ+nExpEniL/FQn9hpczKHdPKCyiAfeh0SMkf+wDvSbWsBlroCCtpX6volFkOcmzqdBntofN8QyGQkQudcuF12qe554DPWZRg70hUAjNoV6fwyuFv1nuhGYT3dRiDpRCVlCnHHiFlfM3m9tCo5trqUlFX/hJO0ddFqJJLut9HQ1NrquiRoc7wM/V31GPa9DkGTbIvwga9C+nZrlO+Al9opqabYWPqWy0NwbNuvQEdXgJKuI/oEaVfeFjFL32xaEZYV+yQeWBbVlZq15f9sp7W/YcrmYAS6AmOY9aeCbA13Vssv8SBPcazzuaPS/5Yvhy9bhtYfZxqlgiQU3SFg+bUzUJMtfTR0EUgpnK2s/n9oQ6qe+cT85R6SUnVPVYXsag9iVCLo2+dkQgsKv3zI9FUBGpuR7KbY6CulZ3bqplICfmhUHhWcpsdCGgi6FB16dOUeaHeATSbtyKI/Tn2TEtAn7yKLdSgkmt55ygr9M3I4ies9fkV7PJwXVTO0HFxbVUWAjTWj10kr7eikRQIb3vSJ8//5l5aSN7RyGAJ6nkuQXmRS1108eRZJgUeZp+yvvAAoP20od7VRxMeZEqDkXDAiFPuumjLCMExo3yUM2nLljhhhL6+iHVAYO6nqK6TFii05eU2ZfmhBHdf2YA7mRYIiybcnvTwqDbgJMM6Gh7WML5JhVOPvNH6CLNqmYQ62ENaSmVatbfFArNEvIoV7Phvmti2rXukrJgazXPmw6LLKa/4uUDHdAi/h8eylQtjoNX1H355JlOsIb0PtUUrhgTgeAcoza5KfddD8hIN37LjbBI+BdUV/HJI4NCEIBr2LKjVNrcFkquhypvh0UuOsCAzm5bktYnBHLRQx/d9Cv9veeCir550bBI3yoGVXv40xWZGdNT09LTH12yZmcR1X0VDlVtR8Aqc2mBXzrCdo7PaN44CHBZKc36CELMpUk1XSBE6EGa8xYEmUBT3L0giLSLZnwIYW6iGbdCGMdhGlcaAXHm07g3IVCHczRsHER6l0bVRkGk22jUTgjVpooGPQuxttCg8RDrARp0OcTqRWPKJYjlqqQh+RBtDw1ZD9FW0pDnIdqDNCQDoo2iIVMgWiINGQvRLqchwyBaFA35M0STamjEIAh3mkYMhnClNOJ6CHeGRqRCuCoakQ7RImhIJkSLoyFvQbSraMhWiDaWhhyFaDNpiKcdBFtOYwZCsG00ZjrEkoppzGsQqzsNyodY99CgukgI9TaNSoZIUiGNWgSREmjYfyDSszSsrj3EcRyjceMgTgpNWAlx1tGEYhdEiaygGddBlIdoyisQJKKQphx3QYxZNGk0hAj7mSblQIiZNKs2DgJEn6RpcyDACpr3kwu2S3TTAnfAbq58WmEP7PYYgzq1fdXf56anT5/ycOayNZ8WMaChsNeQWgZy4NXJie0hFzciY2MF1WyDrWJ/oaritfdchgAiRr18jP5ugI0cW6jCnZsWgaAcwzd6qPCdA/Z5mv4Ozr8EGvR4pZpyE2CbSR4qHU53QaP4LA99FbaDTW6po8L+iU7oMHg3fS2DPYZVUe50uhP6uBbWsom7P+xw7RnKrYuFfgMPsUl+KKw39FfKHEqBIW3Xs8lSWC61ijKrW8Egx1I2uQ0We8BNX1WzYMIsNxuVd4eVnIspc6gfTJnkZqP/RsM6l26nTG4UTHqAXl+1gVWGn6DMhnCYlkmvz8JhidDFHsqsdMICb9BrUxtY4M97KbdMghXCvqFXwWUwq+NaKjwHi3Qto1dhf5gSOruMCu9IsMqdbFI11wnDwmcepdLmEFhnHX18PQDGtM44Tj+72sBCl5yhD88/+0G/K18sor/CWFhqDuV2psfCq/UMNCdm9rdUU5cMa4V8TwVP/uszRicmJAyZ9m5ZJfCXpBAE4Lx2wWc1VLcQVhvHIN4DxrM0J2NwBBRikmdmlzCgrQ5YzbGfgaUA0k6eV1OQ8/y9qSMHJQy96e4HH389r5hBFcXBelMZ0DEngEQPdZsCG4T9zECewgUrqdcOCXZYyACqL8UFHYqoT21f2OJyD9WtQr1p1Oc52GQ3VXl6oZ6URz1OtYFNHqaqj9AovoI6LIBd/kBVQ+E1m9qVRMI2P1LFDjRx5FGzx2GfN+nPMxA+OpVQo7L2sM9k+suGzHhq9AJs1Jl+arpBbhW1uRJ2KqXSMii0LqAWu2Crb6hQGgOlrr9Sgxmw1ftUSIe/MR42q7I9bPU05bZLUPEEm5UDe02jTGU3qJHWsjn3wl7jKbMA6iK+YjO6wF430te3IQgg9hCDOgCbJdNH+RUIqMtxBvMybDaAPiYhiH5lDOJW2Kwfm7yBoJIqGFhX2CyJXgURCG74OQZS4YDNxrJR6RVozohKBrAHdpvEBjUj0LyUCqpbDbvdzwaTocWQUqqaB7stYr1MaJNQRDV3wG7v8DdrJGjU7SBVXA+7fcELPgyFZh2+oL/+sJmjjOd9HAYdWuXQzxWwWS+e92EodJEWeagQA5tNJ7khFHrdUk65cNgsh8wOhX4991GmFewVVs7nHTAiYil9tYO9Uuruh1F3n2GTONjr6dEwrnMevfrBXrEwwzGvig3GomXrvoP1HkQLJ6WV8II30OJ1XO0huQu/AwN3k5Vh+B1wpP3EIfhdCE2fhv+X/wF/AO+L9vuzfwAAAABJRU5ErkJggg==","png",5,12+3*u.length+4,3,3,null,"FAST"),o.setFontSize(10),o.text("wheregroup.com",40,12+3.25*u.length+4+1),o.setProperties({title:"Map export",subject:"Map export",creator:"WhereGroup GmbH",author:"(c)WhereGroup GmbH, (c)OpenStreetMap"}),o.save("Map.pdf"),s.remove(),null===(e=a.parentNode)||void 0===e||e.removeChild(a),Object.defineProperty(window,"devicePixelRatio",{get:function(){return n}}),r(!1)}))},m=r(604),g=r.n(m),h=r(1130),y=r(1),b=function(e){var t=Object(a.useContext)(o.b),r=Object(a.useRef)(!1),n=Object(a.useRef)(void 0);return Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,n.current=t.getMap(e.mapId))}),[t.mapIds,t,e.mapId]),Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(h.a,{color:"primary",variant:"contained",onClick:function(){f(n.current,null,(function(){}))},children:Object(y.jsx)(g.a,{})})})};b.defaultProps={mapId:void 0},b.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).\n\n@component",methods:[],displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var v=b;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlCreatePdfButton/MlCreatePdfButton.js"]={name:"MlCreatePdfButton",docgenInfo:b.__docgenInfo,path:"src/components/MlCreatePdfButton/MlCreatePdfButton.js"});var j=r(86),O=r(40),x={title:"MapComponents/MlCreatePdfButton",component:v,argTypes:{options:{control:{type:"object"}}},decorators:O.a},S=(t.default=x,function(e){return Object(y.jsx)(j.a,{children:Object(y.jsx)(v,{})})}.bind({}));S.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlCreatePdfButton />\n  </TopToolbar>\n)"}},S.parameters)},1096:function(e,t,r){"use strict";r.r(t),r.d(t,"BackgroundSwitcher",(function(){return P}));var n=r(5),a=r(0),o=r(111),i=r(16),s=(r(1075),r(1076),r(1077),r(1078),r(1202)),c=r(1207),l=r(1208),u=r(1195),p=r(639),d=r(213),f=r(163),m=r(1194),g=r(1206),h=r(613),y=r.n(h),b=r(1),v=function(e){var t=Object(a.useState)("loading"),r=Object(i.a)(t,2),o=r[0],s=r[1];Object(a.useEffect)((function(){e.src?fetch(e.src).then((function(e){var t=e.ok;s(t?"ready":"error")})).catch((function(e){console.error(e),s("error")})):s("error")}),[e.src]);var c={width:"100%",height:"100%",border:2,borderRadius:"8px",textAlign:"center",display:"flex"},l=function(){return Object(b.jsx)(m.a,{className:e.className,sx:Object(n.a)(Object(n.a)({},c),e.style),children:Object(b.jsx)(g.a,{})})},u=function(){return Object(b.jsx)("img",{className:e.className,style:Object(n.a)(Object(n.a)({},c),e.style),src:e.src,alt:e.alt||""})},p=function(){return Object(b.jsx)(m.a,{className:e.className,sx:Object(n.a)({boxStyle:c},e.style),children:Object(b.jsx)(y.a,{sx:{display:"block",margin:"auto"}})})};return Object(b.jsx)(b.Fragment,{children:function(e){switch(e){case"ready":return Object(b.jsx)(u,{});case"error":return Object(b.jsx)(p,{});default:return Object(b.jsx)(l,{})}}(o)})};v.__docgenInfo={description:"",methods:[],displayName:"ImageLoader"};var j=v;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/ImageLoader.js"]={name:"ImageLoader",docgenInfo:v.__docgenInfo,path:"src/ui_components/ImageLoader.js"});var O,x=r(80),S=function(e){var t,r=Object(x.a)({mapId:e.mapId,watch:{viewport:!1,layers:!0,sources:!1},filter:{matchLayerIds:e.layerId}}).layers,n=Object(f.a)(O||(O=Object(d.a)(["\n    & img:hover {\n    }\n  "])));return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(m.a,{className:n,sx:{width:"40px",height:"53px",justifyContent:"center",py:.25,px:"1rem",cursor:"pointer"},onClick:function(){var t;null==e||null===(t=e.handleLayerBoxClick)||void 0===t||t.call(e,e.layerId)},children:[Object(b.jsx)(j,{style:{border:"2px solid "+(null!=r&&null!==(t=r[0])&&void 0!==t&&t.visible?"#64c864":"#fd720f"),borderRadius:"8px",height:"40px",width:"40px"},src:e.thumbnail}),Object(b.jsx)("div",{className:"mllayerswitcher-layer-text",style:{textAlign:"center",color:"rgb(112, 117, 122)",fontFamily:"Roboto, Arial",width:"40px",fontSize:"0.60rem"},children:e.label})]},e.layerId)})};S.__docgenInfo={description:"@component",methods:[],displayName:"LayerBox"};var M=S;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerSwitcher/components/LayerBox.js"]={name:"LayerBox",docgenInfo:S.__docgenInfo,path:"src/components/MlLayerSwitcher/components/LayerBox.js"});var C=r(1134),L=r(126),w=function(e){var t,r,n,o,d=Object(L.a)({mapId:e.mapId}),f=!(null===(t=e.baseSourceConfig)||void 0===t||null===(r=t.layers)||void 0===r||!r.length),m=!(null===(n=e.detailLayerConfig)||void 0===n||null===(o=n.layers)||void 0===o||!o.length),g=Object(a.useState)([]),h=Object(i.a)(g,2),y=h[0],v=h[1],j=Object(a.useState)([]),O=Object(i.a)(j,2),x=O[0],S=O[1],w=Object(s.a)().t;Object(a.useEffect)((function(){if(d.map){var t=function(e,t){var r=I(e.layerId),n=0===t?"visible":"none";r.forEach((function(e){e&&T(e,n)}))};e.baseSourceConfig.layers.forEach((function(e,r){return t(e,r)})),e.detailLayerConfig.layers.forEach((function(e,r){return t(e,r)}))}}),[d.map]),Object(a.useEffect)((function(){var t,r;if(null!==(t=d.map)&&void 0!==t&&null!==(r=t.style)&&void 0!==r&&r._layers){var n=[],a=[];e.baseSourceConfig.layers.forEach((function(e){I(e.layerId).forEach((function(e){var t,r=null===(t=d.map)||void 0===t?void 0:t.getLayoutProperty(e,"visibility");-1!==d.map.baseLayers.indexOf(e)&&(e="styleBase"),-1===n.indexOf(e)&&"visible"===r&&n.push(e)}))})),e.detailLayerConfig.layers.forEach((function(e){var t,r=e.layerId,n=null===(t=d.map)||void 0===t?void 0:t.getLayoutProperty(r,"visibility");-1===a.indexOf(r)&&"visible"===n&&a.push(r)})),v(n),S(a)}}),[d.layers]);var I=function(e){return"styleBase"===e?null==d?void 0:d.map.baseLayers:[e]},E=function(t){var r,n=I(t),a="visible"===(null==d||null===(r=d.map.getLayer(n[0]))||void 0===r?void 0:r.getLayoutProperty("visibility"))?"none":"visible";e.baseSourceConfig.layers.forEach((function(e,r){var n=I(e.layerId),o="none";e.layerId===t&&(o=a),"none"===a&&0===r&&(o="visible"),n.forEach((function(e){e&&T(e,o)}))}))},T=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";null===(t=d.map)||void 0===t||t.setLayoutProperty(e,"visibility",r)};return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(c.a,{sx:{zIndex:101,position:"absolute",minWidth:"200px"},children:[Object(b.jsxs)(l.a,{children:[f&&Object(b.jsxs)(u.a,{sx:{minHeight:"150px"},children:[Object(b.jsx)(p.a,{variant:"h6",children:w(e.baseSourceConfig.label||"Background Data")}),Object(b.jsx)(C.a,{}),Object(b.jsx)(u.a,{sx:{display:"flex",paddingTop:"1rem"},children:e.baseSourceConfig.layers.map((function(t){var r=t.src,n=t.label,a=t.layerId;return Object(b.jsx)(M,{mapId:e.mapId,activeLayers:y,label:w(n),layerId:a,thumbnail:r,handleLayerBoxClick:function(){E(a)}},a)}))})]}),m&&Object(b.jsxs)(u.a,{sx:{minHeight:"150px"},children:[Object(b.jsx)(p.a,{variant:"h6",children:w("Layers")}),Object(b.jsx)(C.a,{}),Object(b.jsx)(u.a,{sx:{display:"flex",paddingTop:"1rem"},children:e.detailLayerConfig.layers.map((function(t){var r=t.src,n=t.label,a=t.layerId;return Object(b.jsx)(M,{mapId:e.mapId,activeLayers:x,label:w(n),layerId:a,thumbnail:r,handleLayerBoxClick:function(){!function(t){var r,n=e.detailLayerConfig.layers.find((function(e){return e.layerId===t}));n.linkedTo&&E(n.linkedTo);var a="visible"===(null==d||null===(r=d.map.getLayer(t))||void 0===r?void 0:r.getLayoutProperty("visibility"))?"none":"visible";T(t,a)}(a)}},a)}))})]})]})," "]})})};w.__docgenInfo={description:"@component",methods:[],displayName:"MlLayerSwitcher",props:{baseSourceConfig:{type:{name:"shape",value:{label:{name:"string",required:!1},layers:{name:"arrayOf",value:{name:"shape",value:{layerId:{name:"string",required:!0},src:{name:"string",required:!1},label:{name:"string",required:!0}}},required:!1}}},required:!1,description:""},detailLayerConfig:{type:{name:"shape",value:{label:{name:"string",required:!1},layers:{name:"arrayOf",value:{name:"shape",value:{layerId:{name:"string",required:!0},src:{name:"string",required:!1},label:{name:"string",required:!0},linkedTo:{name:"string",required:!1}}},required:!1}}},required:!1,description:""},mapId:{type:{name:"string"},required:!1,description:""}}};var I=w;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerSwitcher/MlLayerSwitcher.js"]={name:"MlLayerSwitcher",docgenInfo:w.__docgenInfo,path:"src/components/MlLayerSwitcher/MlLayerSwitcher.js"});var E=r(120),T=r(40),_=r(617),R=r(618),A={title:"MapComponents/MlLayerSwitcher",component:I,argTypes:{url:{},layer:{}},decorators:T.a},P=(t.default=A,function(e){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(o.a,{url:e.url,urlParameters:{layers:e.layer},sourceOptions:e.sourceOptions,layerId:"historic",visible:e.layerVisible}),Object(b.jsx)(o.a,{url:e.url2,urlParameters:{layers:e.layer2},sourceOptions:e.sourceOptions,layerId:e.layer2,visible:e.layer2Visible}),Object(b.jsx)(E.a,{type:"line",layout:{visibility:e.geojsonLayerVisible?"visible":"none"},geojson:_,layerId:"geojson1"}),Object(b.jsx)(E.a,{type:"line",layout:{visibility:e.geojson2LayerVisible?"visible":"none"},geojson:R,layerId:"geojson2"}),Object(b.jsx)(I,{baseSourceConfig:{active:e.baseSourcesActive,layers:e.layers},detailLayerConfig:e.detailLayerConfig}),";"]})}.bind({}));P.parameters={},P.args={url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",layer:"nw_uraufnahme_rw",layerVisible:!0,url2:"https://www.wms.nrw.de/geobasis/wms_nw_dop",layer2:"WMS_NW_DOP",layer2Visible:!1,geojsonLayerVisible:!0,geojson2LayerVisible:!0,sourceOptions:{minzoom:13,maxzoom:20},baseSourcesActive:!0,layers:[{label:"Historic",layerId:"historic",src:"assets/historic.png"},{label:"Straßenkarte",layerId:"styleBase",src:"assets/osm.png"},{label:"DOP",layerId:"WMS_NW_DOP",src:"assets/dop.png"}],detailLayerConfig:{layers:[{label:"GeoJson 1",layerId:"geojson1",src:"assets/historic.png",active:!0}]}},P.parameters=Object(n.a)({storySource:{source:'(args) => {\n  return (\n    <>\n      <MlWmsLayer\n        url={args.url}\n        urlParameters={{ layers: args.layer }}\n        sourceOptions={args.sourceOptions}\n        layerId="historic"\n        visible={args.layerVisible}\n      />\n      <MlWmsLayer\n        url={args.url2}\n        urlParameters={{ layers: args.layer2 }}\n        sourceOptions={args.sourceOptions}\n        layerId={args.layer2}\n        visible={args.layer2Visible}\n      />\n      <MlGeoJsonLayer\n        type="line"\n        layout={{ visibility: args.geojsonLayerVisible ? "visible" : "none" }}\n        geojson={sample_geojson_1}\n        layerId="geojson1"\n      />\n      <MlGeoJsonLayer\n        type="line"\n        layout={{ visibility: args.geojson2LayerVisible ? "visible" : "none" }}\n        geojson={sample_geojson_2}\n        layerId="geojson2"\n      />\n      <MlLayerSwitcher\n        baseSourceConfig={{\n          active: args.baseSourcesActive,\n          layers: args.layers,\n        }}\n        detailLayerConfig={args.detailLayerConfig}\n      />\n      ;\n    </>\n  );\n}'}},P.parameters)},1097:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return x}));var n=r(5),a=r(0),o=r.n(a),i=r(86),s=r(16),c=r(34),l=r(1130),u=r(157),p=r.n(u),d=r(7),f=function(){function e(e){d.B.call(this,e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new o(e)})),this.register((function(e){return new s(e)})),this.register((function(e){return new c(e)})),this.register((function(e){return new i(e)})),this.register((function(e){return new n(e)})),this.register((function(e){return new l(e)}))}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(d.B.prototype),{constructor:e,load:function(e,t,r,n){var a,o=this;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:d.C.extractUrlBase(e),this.manager.itemStart(e);var i=function(t){n?n(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},s=new d.l(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{o.parse(r,a,(function(r){t(r),o.manager.itemEnd(e)}),i)}catch(e){i(e)}}),r,i)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,n,o){var i,s={},c={};if("string"==typeof e)i=e;else if(d.C.decodeText(new Uint8Array(e,0,4))===u){try{s[r.KHR_BINARY_GLTF]=new m(e)}catch(e){return void(o&&o(e))}i=s[r.KHR_BINARY_GLTF].content}else i=d.C.decodeText(new Uint8Array(e));var l=JSON.parse(i);if(void 0===l.asset||l.asset.version[0]<2)o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var p=new z(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(var f=0;f<this.pluginCallbacks.length;f++){var y=this.pluginCallbacks[f](p);c[y.name]=y,s[y.name]=!0}if(l.extensionsUsed)for(f=0;f<l.extensionsUsed.length;++f){var j=l.extensionsUsed[f],O=l.extensionsRequired||[];switch(j){case r.KHR_MATERIALS_UNLIT:s[j]=new a;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[j]=new b;break;case r.KHR_DRACO_MESH_COMPRESSION:s[j]=new g(l,this.dracoLoader);break;case r.KHR_TEXTURE_TRANSFORM:s[j]=new h;break;case r.KHR_MESH_QUANTIZATION:s[j]=new v;break;default:O.indexOf(j)>=0&&void 0===c[j]&&console.warn('THREE.GLTFLoader: Unknown extension "'+j+'".')}}p.setExtensions(s),p.setPlugins(c),p.parse(n,o)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function n(e){this.parser=e,this.name=r.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function a(){this.name=r.KHR_MATERIALS_UNLIT}function o(e){this.parser=e,this.name=r.KHR_MATERIALS_CLEARCOAT}function i(e){this.parser=e,this.name=r.KHR_MATERIALS_TRANSMISSION}function s(e){this.parser=e,this.name=r.KHR_TEXTURE_BASISU}function c(e){this.parser=e,this.name=r.EXT_TEXTURE_WEBP,this.isSupported=null}function l(e){this.name=r.EXT_MESHOPT_COMPRESSION,this.parser=e}n.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,n=t.length;r<n;r++){var a=t[r];a.extensions&&a.extensions[this.name]&&void 0!==a.extensions[this.name].light&&e._addNodeRef(this.cache,a.extensions[this.name].light)}},n.prototype._loadLight=function(e){var t=this.parser,r="light:"+e,n=t.cache.get(r);if(n)return n;var a,o=t.json,i=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],s=new d.i(16777215);void 0!==i.color&&s.fromArray(i.color);var c=void 0!==i.range?i.range:0;switch(i.type){case"directional":(a=new d.j(s)).target.position.set(0,0,-1),a.add(a.target);break;case"point":(a=new d.S(s)).distance=c;break;case"spot":(a=new d.db(s)).distance=c,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,a.angle=i.spot.outerConeAngle,a.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return a.position.set(0,0,0),a.decay=2,void 0!==i.intensity&&(a.intensity=i.intensity),a.name=t.createUniqueName(i.name||"light_"+e),n=Promise.resolve(a),t.cache.add(r,n),n},n.prototype.createNodeAttachment=function(e){var t=this,r=this.parser,n=r.json.nodes[e],a=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then((function(e){return r._getNodeRef(t.cache,a,e)}))},a.prototype.getMaterialType=function(){return d.H},a.prototype.extendParams=function(e,t,r){var n=[];e.color=new d.i(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var o=a.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==a.baseColorTexture&&n.push(r.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(n)},o.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.I:null},o.prototype.extendMaterialParams=function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var a=[],o=n.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&a.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&a.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(a.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var i=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new d.ib(i,-i)}return Promise.all(a)},i.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.I:null},i.prototype.extendMaterialParams=function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var a=[],o=n.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&a.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(a)},s.prototype.loadTexture=function(e){var t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;var a=n.extensions[this.name],o=r.images[a.source],i=t.options.ktx2Loader;if(!i){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o,i)},c.prototype.loadTexture=function(e){var t=this.name,r=this.parser,n=r.json,a=n.textures[e];if(!a.extensions||!a.extensions[t])return null;var o=a.extensions[t],i=n.images[o.source],s=r.textureLoader;if(i.uri){var c=r.options.manager.getHandler(i.uri);null!==c&&(s=c)}return this.detectSupport().then((function(a){if(a)return r.loadTextureImage(e,i,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))},c.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported},l.prototype.loadBufferView=function(e){var t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){var n=r.extensions[this.name],a=this.parser.getDependency("buffer",n.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([a,o.ready]).then((function(e){var t=n.byteOffset||0,r=n.byteLength||0,a=n.count,i=n.byteStride,s=new ArrayBuffer(a*i),c=new Uint8Array(e[0],t,r);return o.decodeGltfBuffer(new Uint8Array(s),a,i,c,n.mode,n.filter),s}))}return null};var u="glTF",p=1313821514,f=5130562;function m(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:d.C.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==u)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-12,a=new DataView(e,12),o=0;o<n;){var i=a.getUint32(o,!0);o+=4;var s=a.getUint32(o,!0);if(o+=4,s===p){var c=new Uint8Array(e,12+o,i);this.content=d.C.decodeText(c)}else if(s===f){var l=12+o;this.body=e.slice(l,l+i)}o+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function g(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function h(){this.name=r.KHR_TEXTURE_TRANSFORM}function y(e){d.J.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),a=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),i={specular:{value:(new d.i).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=i,this.onBeforeCompile=function(e){for(var s in i)e.uniforms[s]=i[s];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",n).replace("#include <metalnessmap_fragment>",a).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return i.specular.value},set:function(e){i.specular.value=e}},specularMap:{get:function(){return i.specularMap.value},set:function(e){i.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return i.glossiness.value},set:function(e){i.glossiness.value=e}},glossinessMap:{get:function(){return i.glossinessMap.value},set:function(e){i.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function b(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return y},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new d.i(1,1,1),e.opacity=1;var a=[];if(Array.isArray(n.diffuseFactor)){var o=n.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==n.diffuseTexture&&a.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new d.i(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new d.i(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var i=n.specularGlossinessTexture;a.push(r.assignTexture(e,"glossinessMap",i)),a.push(r.assignTexture(e,"specularMap",i))}return Promise.all(a)},createMaterial:function(e){var t=new y(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=d.eb,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function v(){this.name=r.KHR_MESH_QUANTIZATION}function j(e,t,r,n){d.r.call(this,e,t,r,n)}g.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,a=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},s={},c={},l=void 0;for(var u in o)l=R[u]||u.toLowerCase(),i[l]=o[u];for(u in e.attributes)if(l=R[u]||u.toLowerCase(),void 0!==o[u]){var p=r.accessors[e.attributes[u]],d=I[p.componentType];c[l]=d,s[l]=!0===p.normalized}return t.getDependency("bufferView",a).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],a=s[r];void 0!==a&&(n.normalized=a)}t(e)}),i,c)}))}))},h.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},y.prototype=Object.create(d.J.prototype),y.prototype.constructor=y,y.prototype.copy=function(e){return d.J.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},j.prototype=Object.create(d.r.prototype),j.prototype.constructor=j,j.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n*3+n,o=0;o!==n;o++)t[o]=r[a+o];return t},j.prototype.beforeStart_=j.prototype.copySampleValue_,j.prototype.afterEnd_=j.prototype.copySampleValue_,j.prototype.interpolate_=function(e,t,r,n){for(var a=this.resultBuffer,o=this.sampleValues,i=this.valueSize,s=2*i,c=3*i,l=n-t,u=(r-t)/l,p=u*u,d=p*u,f=e*c,m=f-c,g=-2*d+3*p,h=d-p,y=1-g,b=h-p+u,v=0;v!==i;v++){var j=o[m+v+i],O=o[m+v+s]*l,x=o[f+v+i],S=o[f+v]*l;a[v]=y*j+b*O+g*x+h*S}return a};var O=0,x=1,S=2,M=3,C=4,L=5,w=6,I={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},E={9728:d.L,9729:d.y,9984:d.N,9985:d.A,9986:d.M,9987:d.z},T={33071:d.h,33648:d.K,10497:d.Y},_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},R={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},A={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},P={CUBICSPLINE:void 0,LINEAR:d.t,STEP:d.s},k="OPAQUE",H="MASK",F="BLEND";function N(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function U(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function B(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function G(e,t){e.updateMorphTargets();var r,n=void 0;if(void 0!==t.weights)for(r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length)for(e.morphTargetDictionary={},r=0,n=a.length;r<n;r++)e.morphTargetDictionary[a[r]]=r;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function D(e){for(var t="",r=Object.keys(e).sort(),n=0,a=r.length;n<a;n++)t+=r[n]+":"+e[r[n]]+";";return t}function z(e,r){this.json=e||{},this.extensions={},this.plugins={},this.options=r||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new d.o(this.options.manager):this.textureLoader=new d.fb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.l(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function q(e,t,r){var n=t.attributes,a=[];function o(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var i in n){var s=R[i]||i.toLowerCase();s in e.attributes||a.push(o(n[i],s))}if(void 0!==t.indices&&!e.index){var c=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));a.push(c)}return B(e,t),function(e,t,r){var n,a,o=t.attributes,i=new d.c,s=void 0;if(void 0!==o.POSITION)if(a=(n=r.json.accessors[o.POSITION]).min,s=n.max,void 0!==a&&void 0!==s){i.set(new d.jb(a[0],a[1],a[2]),new d.jb(s[0],s[1],s[2]));var c=t.targets;if(void 0!==c){for(var l=new d.jb,u=new d.jb,p=0,f=c.length;p<f;p++){var m=c[p];void 0!==m.POSITION&&(a=(n=r.json.accessors[m.POSITION]).min,s=n.max,void 0!==a&&void 0!==s?(u.setX(Math.max(Math.abs(a[0]),Math.abs(s[0]))),u.setY(Math.max(Math.abs(a[1]),Math.abs(s[1]))),u.setZ(Math.max(Math.abs(a[2]),Math.abs(s[2]))),l.max(u)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."))}i.expandByVector(l)}e.boundingBox=i;var g=new d.cb;i.getCenter(g.center),g.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=g}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}(e,t,r),Promise.all(a).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,a=!1,o=void 0,i=0,s=t.length;i<s&&(void 0!==(o=t[i]).POSITION&&(n=!0),void 0!==o.NORMAL&&(a=!0),!n||!a);i++);if(!n&&!a)return Promise.resolve(e);var c=[],l=[];for(i=0,s=t.length;i<s;i++){o=t[i];var u=void 0;n&&(u=void 0!==o.POSITION?r.getDependency("accessor",o.POSITION):e.attributes.position,c.push(u)),a&&(u=void 0!==o.NORMAL?r.getDependency("accessor",o.NORMAL):e.attributes.normal,l.push(u))}return Promise.all([Promise.all(c),Promise.all(l)]).then((function(t){var r=t[0],o=t[1];return n&&(e.morphAttributes.position=r),a&&(e.morphAttributes.normal=o),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function V(e,t){var r=e.getIndex(),n=void 0;if(null===r){var a=[],o=e.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(n=0;n<o.count;n++)a.push(n);e.setIndex(a),r=e.getIndex()}var i=r.count-2,s=[];if(t===d.gb)for(n=1;n<=i;n++)s.push(r.getX(0)),s.push(r.getX(n)),s.push(r.getX(n+1));else for(n=0;n<i;n++)n%2==0?(s.push(r.getX(n)),s.push(r.getX(n+1)),s.push(r.getX(n+2))):(s.push(r.getX(n+2)),s.push(r.getX(n+1)),s.push(r.getX(n)));s.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c}return z.prototype.setExtensions=function(e){this.extensions=e},z.prototype.setPlugins=function(e){this.plugins=e},z.prototype.parse=function(e,t){var r=this,n=this.json,a=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){var o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};U(a,o,n),B(o,n),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(o)}))).then((function(){e(o)}))})).catch(t)},z.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n=0,a=t.length;n<a;n++)for(var o=t[n].joints,i=0,s=o.length;i<s;i++)e[o[i]].isBone=!0;for(var c=0,l=e.length;c<l;c++){var u=e[c];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(r[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}},z.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},z.prototype._getNodeRef=function(e,t,r){if(e.refs[t]<=1)return r;var n=r.clone();return n.name+="_instance_"+e.uses[t]++,n},z.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var n=e(t[r]);if(n)return n}},z.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],n=0;n<t.length;n++){var a=e(t[n]);a&&r.push(a)}return r},z.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},z.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},z.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var a=this.options;return new Promise((function(e,r){n.load(N(t.uri,a.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},z.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},z.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var a=[];return void 0!==n.bufferView?a.push(this.getDependency("bufferView",n.bufferView)):a.push(null),void 0!==n.sparse&&(a.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(a).then((function(e){var a,o,i=e[0],s=_[n.type],c=I[n.componentType],l=c.BYTES_PER_ELEMENT,u=l*s,p=n.byteOffset||0,f=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,m=!0===n.normalized;if(f&&f!==u){var g=Math.floor(p/f),h="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+g+":"+n.count,y=t.cache.get(h);y||(a=new c(i,g*f,n.count*f/l),y=new d.p(a,f/l),t.cache.add(h,y)),o=new d.q(y,s,p%f/l,m)}else a=null===i?new c(n.count*s):new c(i,p,n.count*s),o=new d.d(a,s,m);if(void 0!==n.sparse){var b=_.SCALAR,v=I[n.sparse.indices.componentType],j=n.sparse.indices.byteOffset||0,O=n.sparse.values.byteOffset||0,x=new v(e[1],j,n.sparse.count*b),S=new c(e[2],O,n.sparse.count*s);null!==i&&(o=new d.d(o.array.slice(),o.itemSize,o.normalized));for(var M=0,C=x.length;M<C;M++){var L=x[M];if(o.setX(L,S[M*s]),s>=2&&o.setY(L,S[M*s+1]),s>=3&&o.setZ(L,S[M*s+2]),s>=4&&o.setW(L,S[M*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o}))},z.prototype.loadTexture=function(e){var t=this.json,r=this.options,n=t.textures[e],a=t.images[n.source],o=this.textureLoader;if(a.uri){var i=r.manager.getHandler(a.uri);null!==i&&(o=i)}return this.loadTextureImage(e,a,o)},z.prototype.loadTextureImage=function(e,t,r){var n=this,a=this.json,o=this.options,i=a.textures[e],s=this.URL||this.webkitURL,c=t.uri,l=!1,u=!0;if("image/jpeg"===t.mimeType&&(u=!1),void 0!==t.bufferView)c=n.getDependency("bufferView",t.bufferView).then((function(e){if("image/png"===t.mimeType){var r=new DataView(e,25,1).getUint8(0,!1);u=6===r||4===r||3===r}l=!0;var n=new Blob([e],{type:t.mimeType});return c=s.createObjectURL(n)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(c).then((function(e){return new Promise((function(t,n){var a=t;!0===r.isImageBitmapLoader&&(a=function(e){t(new d.g(e))}),r.load(N(e,o.path),a,void 0,n)}))})).then((function(t){!0===l&&s.revokeObjectURL(c),t.flipY=!1,i.name&&(t.name=i.name),u||(t.format=d.X);var r=(a.samplers||{})[i.sampler]||{};return t.magFilter=E[r.magFilter]||d.y,t.minFilter=E[r.minFilter]||d.z,t.wrapS=T[r.wrapS]||d.Y,t.wrapT=T[r.wrapT]||d.Y,n.associations.set(t,{type:"textures",index:e}),t}))},z.prototype.assignTexture=function(e,t,n){var a=this;return this.getDependency("texture",n.index).then((function(o){if(void 0===n.texCoord||0===n.texCoord||"aoMap"===t&&1===n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),a.extensions[r.KHR_TEXTURE_TRANSFORM]){var i=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(i){var s=a.associations.get(o);o=a.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(o,i),a.associations.set(o,s)}}e[t]=o}))},z.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,n=void 0!==t.attributes.tangent,a=void 0!==t.attributes.color,o=void 0===t.attributes.normal,i=!0===e.isSkinnedMesh,s=Object.keys(t.morphAttributes).length>0,c=s&&void 0!==t.morphAttributes.normal,l=void 0;if(e.isPoints){l="PointsMaterial:"+r.uuid;var u=this.cache.get(l);u||(u=new d.U,d.D.prototype.copy.call(u,r),u.color.copy(r.color),u.map=r.map,u.sizeAttenuation=!1,this.cache.add(l,u)),r=u}else if(e.isLine){l="LineBasicMaterial:"+r.uuid;var p=this.cache.get(l);p||(p=new d.v,d.D.prototype.copy.call(p,r),p.color.copy(r.color),this.cache.add(l,p)),r=p}if(n||a||o||i||s){l="ClonedMaterial:"+r.uuid+":",r.isGLTFSpecularGlossinessMaterial&&(l+="specular-glossiness:"),i&&(l+="skinning:"),n&&(l+="vertex-tangents:"),a&&(l+="vertex-colors:"),o&&(l+="flat-shading:"),s&&(l+="morph-targets:"),c&&(l+="morph-normals:");var f=this.cache.get(l);f||(f=r.clone(),i&&(f.skinning=!0),a&&(f.vertexColors=!0),o&&(f.flatShading=!0),s&&(f.morphTargets=!0),c&&(f.morphNormals=!0),n&&(f.vertexTangents=!0,f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(l,f),this.associations.set(f,this.associations.get(r))),r=f}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=r},z.prototype.getMaterialType=function(){return d.J},z.prototype.loadMaterial=function(e){var t,n=this,a=this.json,o=this.extensions,i=a.materials[e],s={},c=i.extensions||{},l=[];if(c[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(),l.push(u.extendParams(s,i,n))}else if(c[r.KHR_MATERIALS_UNLIT]){var p=o[r.KHR_MATERIALS_UNLIT];t=p.getMaterialType(),l.push(p.extendParams(s,i,n))}else{var f=i.pbrMetallicRoughness||{};if(s.color=new d.i(1,1,1),s.opacity=1,Array.isArray(f.baseColorFactor)){var m=f.baseColorFactor;s.color.fromArray(m),s.opacity=m[3]}void 0!==f.baseColorTexture&&l.push(n.assignTexture(s,"map",f.baseColorTexture)),s.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,s.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(l.push(n.assignTexture(s,"metalnessMap",f.metallicRoughnessTexture)),l.push(n.assignTexture(s,"roughnessMap",f.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),l.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)}))))}!0===i.doubleSided&&(s.side=d.k);var g=i.alphaMode||k;return g===F?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,g===H&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==d.H&&(l.push(n.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new d.ib(1,-1),void 0!==i.normalTexture.scale&&s.normalScale.set(i.normalTexture.scale,-i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==d.H&&(l.push(n.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==d.H&&(s.emissive=(new d.i).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==d.H&&l.push(n.assignTexture(s,"emissiveMap",i.emissiveTexture)),Promise.all(l).then((function(){var a;return a=t===y?o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),i.name&&(a.name=i.name),a.map&&(a.map.encoding=d.mb),a.emissiveMap&&(a.emissiveMap.encoding=d.mb),B(a,i),n.associations.set(a,{type:"materials",index:e}),i.extensions&&U(o,a,i),a}))},z.prototype.createUniqueName=function(e){for(var t=d.V.sanitizeNodeName(e||""),r=t,n=1;this.nodeNamesUsed[r];++n)r=t+"_"+n;return this.nodeNamesUsed[r]=!0,r},z.prototype.loadGeometries=function(e){var t=this,n=this.extensions,a=this.primitiveCache;function o(e){return n[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return q(r,e,t)}))}for(var i,s,c=[],l=0,u=e.length;l<u;l++){var p,f=e[l],m=(s=void 0,(s=(i=f).extensions&&i.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+D(s.attributes):i.indices+":"+D(i.attributes)+":"+i.mode),g=a[m];if(g)c.push(g.promise);else p=f.extensions&&f.extensions[r.KHR_DRACO_MESH_COMPRESSION]?o(f):q(new d.e,f,t),a[m]={primitive:f,promise:p},c.push(p)}return Promise.all(c)},z.prototype.loadMesh=function(e){for(var t,r=this,n=this.json,a=this.extensions,o=n.meshes[e],i=o.primitives,s=[],c=0,l=i.length;c<l;c++){var u=void 0===i[c].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new d.J({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.m})),t.DefaultMaterial):this.getDependency("material",i[c].material);s.push(u)}return s.push(r.loadGeometries(i)),Promise.all(s).then((function(t){var n=t.slice(0,t.length-1),s=t[t.length-1],c=[],u=void 0;for(u=0,l=s.length;u<l;u++){var p,f=s[u],m=i[u],g=n[u];if(m.mode===C||m.mode===L||m.mode===w||void 0===m.mode)!0!==(p=!0===o.isSkinnedMesh?new d.bb(f,g):new d.G(f,g)).isSkinnedMesh||p.geometry.attributes.skinWeight.normalized||p.normalizeSkinWeights(),m.mode===L?p.geometry=V(p.geometry,d.hb):m.mode===w&&(p.geometry=V(p.geometry,d.gb));else if(m.mode===x)p=new d.x(f,g);else if(m.mode===M)p=new d.u(f,g);else if(m.mode===S)p=new d.w(f,g);else{if(m.mode!==O)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);p=new d.T(f,g)}Object.keys(p.geometry.morphAttributes).length>0&&G(p,o),p.name=r.createUniqueName(o.name||"mesh_"+e),B(p,o),m.extensions&&U(a,p,m),r.assignFinalMaterial(p),c.push(p)}if(1===c.length)return c[0];var h=new d.n;for(u=0,l=c.length;u<l;u++)h.add(c[u]);return h}))},z.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new d.R(d.E.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new d.Q(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),B(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},z.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},z.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],a=[],o=[],i=[],s=0,c=t.channels.length;s<c;s++){var l=t.channels[s],u=t.samplers[l.sampler],p=l.target,f=void 0!==p.node?p.node:p.id,m=void 0!==t.parameters?t.parameters[u.input]:u.input,g=void 0!==t.parameters?t.parameters[u.output]:u.output;r.push(this.getDependency("node",f)),n.push(this.getDependency("accessor",m)),a.push(this.getDependency("accessor",g)),o.push(u),i.push(p)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(a),Promise.all(o),Promise.all(i)]).then((function(r){for(var n=r[0],a=r[1],o=r[2],i=r[3],s=r[4],c=[],l=0,u=n.length;l<u;l++){var p=n[l],f=a[l],m=o[l],g=i[l],h=s[l];if(void 0!==p){var y;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,A[h.path]){case A.weights:y=d.O;break;case A.rotation:y=d.W;break;case A.position:case A.scale:default:y=d.kb}var b=p.name?p.name:p.uuid,v=void 0!==g.interpolation?P[g.interpolation]:d.t,O=[];A[h.path]===A.weights?p.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&O.push(e.name?e.name:e.uuid)})):O.push(b);var x,S=m.array,M=void 0;if(m.normalized){var C;if(S.constructor===Int8Array)C=1/127;else if(S.constructor===Uint8Array)C=1/255;else if(S.constructor===Int16Array)C=1/32767;else{if(S.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");C=1/65535}var L=new Float32Array(S.length);for(x=0,M=S.length;x<M;x++)L[x]=S[x]*C;S=L}for(x=0,M=O.length;x<M;x++){var w=new y(O[x]+"."+A[h.path],f.array,S,v);"CUBICSPLINE"===g.interpolation&&(w.createInterpolant=function(e){return new j(this.times,this.values,this.getValueSize()/3,e)},w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(w)}}}var I=t.name?t.name:"animation_"+e;return new d.a(I,void 0,c)}))},z.prototype.loadNode=function(e){var t,r=this.json,n=this.extensions,a=this,o=r.nodes[e],i=o.name?a.createUniqueName(o.name):"";return(t=[],void 0!==o.mesh&&t.push(a.getDependency("mesh",o.mesh).then((function(e){var t=a._getNodeRef(a.meshCache,o.mesh,e);return void 0!==o.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=o.weights.length;t<r;t++)e.morphTargetInfluences[t]=o.weights[t]})),t}))),void 0!==o.camera&&t.push(a.getDependency("camera",o.camera).then((function(e){return a._getNodeRef(a.cameraCache,o.camera,e)}))),a._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)).then((function(t){var r;if((r=!0===o.isBone?new d.b:t.length>1?new d.n:1===t.length?t[0]:new d.P)!==t[0])for(var s=0,c=t.length;s<c;s++)r.add(t[s]);if(o.name&&(r.userData.name=o.name,r.name=i),B(r,o),o.extensions&&U(n,r,o),void 0!==o.matrix){var l=new d.F;l.fromArray(o.matrix),r.applyMatrix4(l)}else void 0!==o.translation&&r.position.fromArray(o.translation),void 0!==o.rotation&&r.quaternion.fromArray(o.rotation),void 0!==o.scale&&r.scale.fromArray(o.scale);return a.associations.set(r,{type:"nodes",index:e}),r}))},z.prototype.loadScene=function(){function e(t,r,n,a){var o=n.nodes[t];return a.getDependency("node",t).then((function(e){return void 0===o.skin?e:a.getDependency("skin",o.skin).then((function(e){for(var r=[],n=0,o=(t=e).joints.length;n<o;n++)r.push(a.getDependency("node",t.joints[n]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var n=[],a=[],o=0,i=r.length;o<i;o++){var s=r[o];if(s){n.push(s);var c=new d.F;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*o),a.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new d.ab(n,a),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var i=[];if(o.children)for(var s=o.children,c=0,l=s.length;c<l;c++){var u=s[c];i.push(e(u,t,n,a))}return Promise.all(i)}))}return function(t){var r=this.json,n=this.extensions,a=this.json.scenes[t],o=new d.n;a.name&&(o.name=this.createUniqueName(a.name)),B(o,a),a.extensions&&U(n,o,a);for(var i=a.nodes||[],s=[],c=0,l=i.length;c<l;c++)s.push(e(i[c],o,r,this));return Promise.all(s).then((function(){return o}))}}(),e}(),m=r(1),g=function(e){var t=Object(a.useContext)(c.b),r=Object(a.useState)(!0),n=Object(s.a)(r,2),o=n[0],i=n[1],u=Object(a.useRef)(!0),g=Object(a.useRef)(!1),h=Object(a.useRef)(null),y=Object(a.useRef)(e.init),b=function(){h.current&&h.current.style&&(h.current.getLayer("3d-model")&&h.current.removeLayer("3d-model"),h.current=null)};return Object(a.useEffect)((function(){return"function"==typeof y.current&&y.current(),b}),[]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!g.current){g.current=!0,h.current=t.getMap(e.mapId),h.current.setCenter([7.099771581806502,50.73395746209983]),h.current.setZoom(15),h.current.setPitch(45);var r=[Math.PI/2,90,0],n=p.a.MercatorCoordinate.fromLngLat([7.099771581806502,50.73395746209983],0),a={translateX:n.x+8e-7,translateY:n.y+18e-7,translateZ:n.z,rotateX:r[0],rotateY:r[1],rotateZ:r[2],scale:n.meterInMercatorCoordinateUnits()+3e-8},o={id:"3d-model",type:"custom",renderingMode:"3d",onAdd:function(t,r){this.camera=new d.f,this.scene=new d.Z;var n=new d.j(16777215);n.position.set(0,-70,100).normalize(),this.scene.add(n);var a=new d.j(16777215);a.position.set(0,70,100).normalize(),this.scene.add(a),(new f).load("assets/3D/godzilla_simple.glb",function(t){this.scene.add(t.scene),"function"==typeof e.onDone&&e.onDone()}.bind(this)),this.map=t,this.renderer=new d.lb({canvas:t.getCanvas(),context:r,antialias:!0}),this.renderer.autoClear=!1},render:function(e,t){var r=(new d.F).makeRotationAxis(new d.jb(1,0,0),a.rotateX),n=(new d.F).makeRotationAxis(new d.jb(0,1,0),a.rotateY),o=(new d.F).makeRotationAxis(new d.jb(0,0,1),a.rotateZ),i=(new d.F).fromArray(t),s=(new d.F).makeTranslation(a.translateX,a.translateY,a.translateZ).scale(new d.jb(a.scale,-a.scale,a.scale)).multiply(r).multiply(n).multiply(o);this.camera.projectionMatrix=i.multiply(s),this.renderer.resetState(),this.renderer.render(this.scene,this.camera),this.map.triggerRepaint()}};h.current.addLayer(o),h.current.getLayer("3d-model")&&h.current.setLayoutProperty("3d-model","visibility","visible")}}),[t.mapIds,t,e]),Object(a.useEffect)((function(){h.current&&h.current.getLayer("3d-model")&&(o?h.current.setLayoutProperty("3d-model","visibility","visible"):h.current.setLayoutProperty("3d-model","visibility","none"))}),[o,t]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(l.a,{color:"primary",variant:o?"contained":"outlined",onClick:function(){i(!o),u.current=!o},children:"3D"})})};g.__docgenInfo={description:"Renders obj or gltf 3D Models on the MapLibreMap referenced by props.mapId\n\n@component",methods:[],displayName:"MlThreeJsLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},init:{type:{name:"func"},required:!1,description:"function that gets called when initialized"},onDone:{type:{name:"func"},required:!1,description:"function that gets called when models are loaded"}}};var h=g;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlThreeJsLayer/MlThreeJsLayer.js"]={name:"MlThreeJsLayer",docgenInfo:g.__docgenInfo,path:"src/components/MlThreeJsLayer/MlThreeJsLayer.js"});var y=r(40),b=o.a.createContext({}),v=b.Provider,j=function(e){var t=e.children,r=Object(a.useContext)(c.b),n=Object(a.useState)(!1),o=Object(s.a)(n,2),i=o[0],l=o[1],u=Object(a.useState)(!1),p=Object(s.a)(u,2),d=p[0],f=p[1],g=Object(a.useState)(!0),h=Object(s.a)(g,2),y=h[0],b=h[1],j=Object(a.useState)(!1),O=Object(s.a)(j,2),x=O[0],S=O[1],M=Object(a.useRef)({}),C=Object(a.useState)(0),L=Object(s.a)(C,2),w=L[0],I=L[1],E=function(e){return function(){M.current[e]=!0,I(Math.random())}},T=function(){setTimeout((function(){S(!0),setTimeout((function(){b(!1)}),1700)}),900)};Object(a.useEffect)((function(){if(r.map&&!i){for(var e in M.current)if(!M.current[e])return;T()}}),[w,i,r]),Object(a.useEffect)((function(){for(var e=0,t=r.mapIds.length;e<t;e++)if(-1===Object.keys(M.current).indexOf(r.mapIds[e])){var n=r.mapIds[e]+"";r.getMap(n)&&(M.current[n]=!1,r.getMap(n).on("idle",E(n)))}}),[r,r.mapIds]),Object(a.useEffect)((function(){d&&T()}),[d]);var _={setControlled:l,controlled:i,visible:y,fadeoutAnimation:x,setLoadingDone:f};return Object(m.jsx)(v,{value:_,children:t})};j.__docgenInfo={description:"",methods:[],displayName:"LoadingOverlayProvider",props:{children:{type:{name:"node"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/LoadingOverlayContext.js"]={name:"LoadingOverlayProvider",docgenInfo:j.__docgenInfo,path:"src/ui_components/LoadingOverlayContext.js"});var O={title:"MapComponents/MlThreeJsLayer",component:h,argTypes:{options:{control:{type:"object"}}},decorators:y.a},x=(t.default=O,function(e){var t=Object(a.useContext)(b);return Object(m.jsx)(i.a,{children:Object(m.jsx)(h,{init:function(){var e;return null==t||null===(e=t.setControlled)||void 0===e?void 0:e.call(t,!0)},onDone:function(){return setTimeout((function(){var e;return null==t||null===(e=t.setLoadingDone)||void 0===e?void 0:e.call(t,!0)}),1200)}})})}.bind({}));x.parameters={},x.parameters=Object(n.a)({storySource:{source:"(args) => {\n  const loadingOverlayContext = useContext(LoadingOverlayContext);\n\n  return (\n    <TopToolbar>\n      <MlThreeJsLayer\n        init={() => loadingOverlayContext?.setControlled?.(true)}\n        onDone={() =>\n          setTimeout(() => loadingOverlayContext?.setLoadingDone?.(true), 1200)\n        }\n      />\n    </TopToolbar>\n  );\n}"}},x.parameters)},1098:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return z}));var n=r(5),a=r(16),o=r(0),i=r(55),s=r(34),c=r(215),l=r(111),u=r(252),p=r(145),d=r(623),f=r.n(d);function m(e){var t=Object(o.useState)(void 0),r=Object(a.a)(t,2),i=r[0],s=r[1],c=Object(o.useState)(e.url),l=Object(a.a)(c,2),u=l[0],p=l[1],d=Object(o.useState)(""),m=Object(a.a)(d,2),g=m[0],h=m[1],y=Object(o.useState)(void 0),b=Object(a.a)(y,2),v=b[0],j=b[1],O=Object(o.useState)(void 0),x=Object(a.a)(O,2),S=x[0],M=x[1],C=function(){s(void 0),j(void 0),h("")};return Object(o.useEffect)((function(){var t;if(C(),M(void 0),u){var r,a=u;-1!==u.indexOf("?")&&(a=(r=u.split("?"))[0]);var o=new URLSearchParams(null===(t=r)||void 0===t?void 0:t[1]),i=Object(n.a)(Object(n.a)({},Object.fromEntries(o)),e.urlParameters),s=new URLSearchParams(i),c=decodeURIComponent(s.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(a+"?"+c).then((function(e){if(e.ok)return e.text();throw Error(e.statusText+" ("+e.status+" - "+e.type+")")})).then((function(e){j(new f.a(e).toJSON())})).catch((function(e){C(),console.log(e),M(e.message)}))}}),[u,e.urlParameters]),Object(o.useEffect)((function(){var e,t,r,n,a,o,i;null!=v&&v.Service&&(h(v.Service.OnlineResource),s(null===(e=v.Capability)||void 0===e||null===(t=e.Request)||void 0===t||null===(r=t.GetFeatureInfo)||void 0===r||null===(n=r.DCPType)||void 0===n||null===(a=n[0])||void 0===a||null===(o=a.HTTP)||void 0===o||null===(i=o.Get)||void 0===i?void 0:i.OnlineResource))}),[v]),{capabilities:v,getFeatureInfoUrl:i,wmsUrl:g,error:S,setUrl:p}}m.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"getCapabilities"}};var g=m,h=r(624),y=r.n(h),b=r(625),v=r.n(b),j=r(1135),O=r(1127),x=r(1136),S=r(638),M=r(1),C=2*Math.PI*6378137/2,L=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},n=e.lng,a=e.lat,o=n*C/180,i=Math.log(Math.tan((90+a)*Math.PI/360))/(Math.PI/180);return i=i*C/180,r.enable&&(o=Number(o.toFixed(r.decimal)),i=Number(i.toFixed(r.decimal))),[o,i]},w=function(e){var t,r,d,f,m,h,b=Object(o.useContext)(s.b),C=g({url:void 0,urlParameters:e.urlParameters}),w=C.capabilities,I=C.error,E=C.setUrl,T=C.getFeatureInfoUrl,_=C.wmsUrl,R=Object(o.useRef)(!1),A=Object(o.useRef)(void 0),P=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlWmsLoader-")+Object(c.a)()),k=Object(o.useState)([]),H=Object(a.a)(k,2),F=H[0],N=H[1],U=Object(o.useState)(void 0),B=Object(a.a)(U,2),G=B[0],D=B[1],z=Object(o.useState)(void 0),q=Object(a.a)(z,2),V=q[0],W=q[1];Object(o.useEffect)((function(){var e=P.current;return function(){A.current&&(A.current.cleanup(e),A.current=void 0),R.current=!1}}),[]),Object(o.useEffect)((function(){R.current&&E(e.url)}),[e.url]);var K=Object(o.useCallback)((function(t){var r,a,o,i,s;D(void 0),W(void 0);var c,l=A.current.getBounds(),u=L(l._sw),p=L(l._ne),d={REQUEST:"GetFeatureInfo",BBOX:[u[0],u[1],p[0],p[1]].join(","),SERVICE:"WMS",INFO_FORMAT:-1!==(null==w||null===(r=w.Capability)||void 0===r||null===(a=r.Request)||void 0===a?void 0:a.GetFeatureInfo.Format.indexOf("text/html"))?"text/html":"text/plain",FEATURE_COUNT:"10",LAYERS:F.map((function(e,t){return e.visible&&e.queryable?e.Name:void 0})).filter((function(e){return e})),QUERY_LAYERS:F.map((function(e,t){return e.visible&&e.queryable?e.Name:void 0})).filter((function(e){return e})),WIDTH:A.current._container.clientWidth,HEIGHT:A.current._container.clientHeight,srs:"EPSG:3857",CRS:"EPSG:3857",version:"1.3.0",X:t.point.x,Y:t.point.y,I:t.point.x,J:t.point.y,buffer:"50"},f=T;-1!==(null===(o=f)||void 0===o||null===(i=o.indexOf)||void 0===i?void 0:i.call(o,"?"))&&(f=(c=e.url.split("?"))[0]);var m=new URLSearchParams(null===(s=c)||void 0===s?void 0:s[1]),g=Object(n.a)(Object(n.a)({},Object.fromEntries(m)),d),h=new URLSearchParams(g);fetch(e.url+"?"+h.toString()).then((function(e){if(!e.ok)throw new Error("FeatureInfo could not be fetched");return e.text()})).then((function(e){D(t.lngLat),W(e)})).catch((function(e){return console.log(e)}))}),[w,T]);return Object(o.useEffect)((function(){if(A.current){var e=K;return A.current.on("click",e,P.current),function(){var t,r;null===(t=A.current)||void 0===t||null===(r=t.off)||void 0===r||r.call(t,"click",e)}}}),[T]),Object(o.useEffect)((function(){var e,t,r,n,a,o,i,s;null!=w&&w.Service&&(-1===(null==w||null===(e=w.Capability)||void 0===e||null===(t=e.Layer)||void 0===t||null===(r=t.SRS)||void 0===r||null===(n=r.indexOf)||void 0===n?void 0:n.call(r,"EPSG:3857"))?console.log("MlWmsLoader ("+w.Service.Title+"): No WGS 84/Pseudo-Mercator support"):(console.log("MlWmsLoader ("+w.Service.Title+"): WGS 84/Pseudo-Mercator supported"),N(null==w||null===(a=w.Capability)||void 0===a||null===(o=a.Layer)||void 0===o?void 0:o.Layer.map((function(e,t){var r,n,a;return 0===t&&((s=e.LatLonBoundingBox)||(s=e.EX_GeographicBoundingBox)),e.visible=!((null==w||null===(r=w.Capability)||void 0===r||null===(n=r.Layer)||void 0===n||null===(a=n.Layer)||void 0===a?void 0:a.length)>2)||t>1,e}))),A.current&&(null===(i=s)||void 0===i?void 0:i.length)>3&&A.current.fitBounds([[s[0],s[1]],[s[2],s[3]]])))}),[w]),Object(o.useEffect)((function(){var t;null!=b&&null!==(t=b.mapExists)&&void 0!==t&&t.call(b,e.mapId)&&!R.current&&(R.current=!0,A.current=b.getMap(e.mapId),console.log("set url "+e.url),E(e.url))}),[b.mapIds,b,e.mapId,e.url]),Object(M.jsxs)(M.Fragment,{children:[I&&Object(M.jsx)("p",{children:I}),Object(M.jsx)("h3",{children:null==w||null===(t=w.Service)||void 0===t?void 0:t.Title},"title"),console.log(P.current),null==w||null===(r=w.Capability)||void 0===r||null===(d=r.Layer)||void 0===d?void 0:d.Layer.map((function(e,t){return Object(M.jsx)(p.a,Object(n.a)({layerId:"Order-"+P.current+"-"+t},t>0?{insertBeforeLayer:"Order-"+P.current+"-"+(t-1)}:void 0),P.current+"-"+t)})),Object(M.jsx)(j.a,{dense:!0,children:_&&(null==F||null===(f=F.map)||void 0===f?void 0:f.call(F,(function(t,r){return null!=t&&t.Name?Object(M.jsxs)(O.a,{secondaryAction:Object(M.jsx)(S.a,{edge:"end","aria-label":"toggle visibility",onClick:function(){var e=Object(i.a)(F);e[r].visible=!e[r].visible,N(Object(i.a)(e))},children:F[r].visible?Object(M.jsx)(y.a,{}):Object(M.jsx)(v.a,{})}),children:[Object(M.jsx)(x.a,{primary:null==t?void 0:t.Title,secondary:null==t?void 0:t.Abstract}),Object(M.jsx)(l.a,{url:_,urlParameters:Object(n.a)(Object(n.a)({},e.wmsUrlParameters),{},{layers:null==t?void 0:t.Name}),visible:F[r].visible,insertBeforeLayer:"Order-"+P.current+"-"+r},(null==t?void 0:t.Name)+r)]},t.Name+r):Object(M.jsx)(M.Fragment,{})})))},"layers"),Object(M.jsx)("p",{style:{fontSize:".7em"},children:null==w||null===(m=w.Capability)||void 0===m||null===(h=m.Layer)||void 0===h?void 0:h.Abstract},"description"),G&&Object(M.jsx)(u.a,Object(n.a)(Object(n.a)({},G),{},{content:V}))]})};w.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"getCapabilities"},wmsUrlParameters:{TRANSPARENT:"TRUE"}},w.__docgenInfo={description:"Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is\noffered by the WMS.\n\nTODO: EaseTo the extend offered by the WMS in a zoom level that is supported\n\n@component",methods:[],displayName:"MlWmsLoader",props:{url:{defaultValue:{value:'""',computed:!1},type:{name:"string"},required:!1,description:"WMS URL"},urlParameters:{defaultValue:{value:'{\n  SERVICE: "WMS",\n  VERSION: "1.3.0",\n  REQUEST: "getCapabilities",\n}',computed:!1},type:{name:"object"},required:!1,description:"URL parameters that will be used in the getCapabilities request"},wmsUrlParameters:{defaultValue:{value:'{\n  TRANSPARENT: "TRUE",\n}',computed:!1},type:{name:"object"},required:!1,description:"URL parameters that will be added when requesting WMS capabilities"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},layerUrlParameters:{type:{name:"object"},required:!1,description:"URL parameters that will be added when requesting tiles"}}};var I=w;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsLoader/MlWmsLoader.js"]={name:"MlWmsLoader",docgenInfo:w.__docgenInfo,path:"src/components/MlWmsLoader/MlWmsLoader.js"});var E=r(1196),T=r(40),_=r(10),R=r(1198),A=r(1129),P=r(633),k=r.n(P),H=r(632),F=r.n(H),N=r(1125),U=Object(R.a)((function(e){return{drawer:{flexGrow:1,zIndex:105,position:"absolute",top:0,left:0,bottom:0,backgroundColor:"#fafafa",display:"flex",flexDirection:"column",alignItems:"stretch",alignContent:"stretch"},drawerPaper:{position:"initial !important",boxSizing:"border-box",padding:"40px",visibility:"visible !important",zIndex:"initial !important"},drawerHeader:{alignContent:"flex-start",display:"flex"},drawerContent:{}}})),B=Object(_.a)("div")((function(e){e.theme;return{display:"flex",alignItems:"center"}}));function G(e){var t=U(),r=Object(N.a)("(max-width:900px)"),i=Object(o.useState)(!0),s=Object(a.a)(i,2),c=s[0],l=s[1];return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(S.a,{onClick:function(){l(!0)},style:{zIndex:101,position:"relative",padding:"20px"},children:Object(M.jsx)(F.a,{})}),Object(M.jsxs)(A.a,{transitionDuration:0,className:t.drawer,variant:"persistent",anchor:"left",open:c,classes:{paper:t.drawerPaper},sx:Object(n.a)(Object(n.a)(Object(n.a)({},e.sx),{maxWidth:r?"90vw":"20vw"}),c?{}:{left:r?"-90vw":"-20vw"}),children:[Object(M.jsx)(B,{className:t.drawerHeader,children:Object(M.jsx)(S.a,{onClick:function(){l(!1)},children:Object(M.jsx)(k.a,{style:{}})})}),Object(M.jsx)("div",{style:{maxWidth:"100%"},children:e.children})]})]})}G.__docgenInfo={description:"",methods:[],displayName:"Sidebar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/Sidebar.js"]={name:"Sidebar",docgenInfo:G.__docgenInfo,path:"src/ui_components/Sidebar.js"});var D={title:"MapComponents/MlWmsLoader",component:I,argTypes:{url:{},layer:{}},decorators:T.a},z=(t.default=D,function(e){var t=Object(o.useState)(e.url),r=Object(a.a)(t,2),i=r[0],s=r[1];return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(G,{sx:{wordBreak:"break-word"},children:[Object(M.jsx)(E.a,{label:"WMS Url",variant:"standard",value:i,onChange:function(e){return s(e.target.value)}}),Object(M.jsx)(I,Object(n.a)(Object(n.a)({},e),{},{url:i}))]})})}.bind({}));z.parameters={},z.args={url:"https://www.wms.nrw.de/wms/kitas"},z.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const [url, setUrl] = useState(props.url);\n\n  return (\n    <>\n      <Sidebar sx={{ wordBreak: "break-word" }}>\n        <TextField\n          label="WMS Url"\n          variant="standard"\n          value={url}\n          onChange={(ev) => setUrl(ev.target.value)}\n        />\n        <MlWmsLoader {...props} url={url} />\n      </Sidebar>\n    </>\n  );\n}'}},z.parameters)},1105:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"parameters",(function(){return i}));var a=r(1203),o=r(12),i=(r(0),r(34),r(143),r(1014),{docs:{inlineStories:!1},actions:{argTypesRegex:"^on[A-Z].*"}});function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.keys(n).forEach((function(e){var t=n[e];switch(e){case"args":case"argTypes":return o.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(t));case"decorators":return t.forEach((function(e){return Object(a.d)(e,!1)}));case"loaders":return t.forEach((function(e){return Object(a.e)(e,!1)}));case"parameters":return Object(a.f)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t),!1);case"argTypesEnhancers":return t.forEach((function(e){return Object(a.b)(e)}));case"argsEnhancers":return t.forEach((function(e){return Object(a.c)(e)}));case"render":return Object(a.g)(t);case"globals":case"globalTypes":var r={};return r[e]=t,Object(a.f)(r,!1);case"decorateStory":case"renderToDOM":return null;default:return console.log(e+" was not supported :( !")}}))},1106:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return f}));var n=r(5),a=r(0),o=r(3),i=r.n(o),s=r(126),c=r(1),l=function(e){var t=Object(s.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(a.useRef)(!1);return Object(a.useEffect)((function(){t.mapIsReady&&!r.current&&(r.current=!0,t.map.setCenter([7.132122000552613,50.716405378037706]))}),[t.map,t.mapIsReady,e.mapId]),Object(c.jsx)(c.Fragment,{})};l.defaultProps={mapId:void 0},l.propTypes={mapId:i.a.string},l.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlComponentTemplate",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var u=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlComponentTemplate/MlComponentTemplate.js"]={name:"MlComponentTemplate",docgenInfo:l.__docgenInfo,path:"src/components/MlComponentTemplate/MlComponentTemplate.js"});var p=r(40),d={title:"MapComponents/MlComponentTemplate",component:u,argTypes:{url:{},layer:{}},decorators:p.a},f=(t.default=d,function(e){return Object(c.jsx)(u,{})}.bind({}));f.parameters={},f.args={},f.parameters=Object(n.a)({storySource:{source:"(args) => <MlComponentTemplate />"}},f.parameters)},1107:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(5),a=r(0),o=r(86),i=r(16),s=r(34),c=r(215),l=r(1130),u=r(1),p=function(e){var t=Object(a.useContext)(s.b),r=Object(a.useRef)(null),o=Object(a.useState)(!0),p=Object(i.a)(o,2),d=p[0],f=p[1],m=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlFillExtrusionLayer-")+Object(c.a)()),g=Object(a.useRef)(!1),h=Object(a.useRef)(e.layerId||"MlFillExtrusionLayer-"+Object(c.a)());return Object(a.useEffect)((function(){var e=m.current;return function(){r.current&&(r.current.cleanup(e),r.current=void 0),g.current=!1}}),[]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!g.current){g.current=!0,r.current=t.getMap(e.mapId);var a=void 0;t.map.getLayer("waterway-name")&&(a="waterway-name"),t.map.getLayer("poi_label")&&(a="poi_label"),t.map.addLayer({id:h.current,type:"fill-extrusion",source:e.sourceId||"openmaptiles","source-layer":e.sourceLayer||"building",minzoom:e.minZoom||14,paint:Object(n.a)({},e.paint)},e.insertBeforeLayer||a,m.current)}}),[t,e.insertBeforeLayer,e.mapId,e.minZoom,e.paint,e.sourceId,e.sourceLayer]),Object(a.useEffect)((function(){g.current&&r.current.setLayoutProperty(h.current,"visibility",d?"visible":"none")}),[d,t]),Object(u.jsx)(l.a,{color:"primary",variant:d?"contained":"outlined",onClick:function(){return f(!d)},children:"Composite"})};p.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}},p.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId\n\n@Component",methods:[],displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},paint:{defaultValue:{value:'{\n  "fill-extrusion-color": "hsl(196, 61%, 83%)",\n  "fill-extrusion-height": {\n    property: "render_height",\n    type: "identity",\n  },\n  "fill-extrusion-base": {\n    property: "render_min_height",\n    type: "identity",\n  },\n  "fill-extrusion-opacity": 1,\n}',computed:!1},type:{name:"object"},required:!1,description:"Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All\navailable properties are documented in the MapLibreGl documentation\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion"},layerId:{type:{name:"string"},required:!1,description:"Id of the layer that will be added by this component"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},sourceId:{type:{name:"string"},required:!1,description:"Source id of a vector tile source containing the geometries to use for this fill-extrusion\nlayer.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer"},sourceLayer:{type:{name:"string"},required:!1,description:"Layer id from a vector tile source containing the geometries to use for this fill-extrusion\nlayer.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer"},minZoom:{type:{name:"number"},required:!1,description:"This layer will be hidde for zoom levels lower than defined on this property\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}};var d=p;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFillExtrusionLayer/MlFillExtrusionLayer.js"]={name:"MlFillExtrusionLayer",docgenInfo:p.__docgenInfo,path:"src/components/MlFillExtrusionLayer/MlFillExtrusionLayer.js"});var f=r(40),m={title:"MapComponents/MlFillExtrusionLayer",component:d,argTypes:{options:{control:{type:"object"}}},decorators:f.a},g=(t.default=m,function(e){return Object(u.jsx)(o.a,{children:Object(u.jsx)(d,{})})}.bind({}));g.parameters={},g.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlFillExtrusionLayer />\n  </TopToolbar>\n)"}},g.parameters)},1108:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(250)),o=r(40),i=r.p+"static/media/wg-marker.bf3eeb2d.png",s=r(1),c={title:"MapComponents/MlImageMarkerLayer",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a},l=(t.default=c,function(e){return Object(s.jsx)(a.a,{options:{type:"symbol",source:{type:"geojson",data:{type:"Feature",properties:{id:"test"},geometry:{type:"Point",coordinates:[7.0847929969609424,50.73855193187643]}}},layout:{"icon-allow-overlap":!0,"icon-size":.14,"icon-offset":[0,-180]}},imgSrc:i})}.bind({}));l.parameters={},l.args={},l.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <MlImageMarkerLayer\n    options={{\n      type: "symbol",\n      source: {\n        type: "geojson",\n        data: {\n          type: "Feature",\n          properties: {\n            id: "test",\n          },\n          geometry: {\n            type: "Point",\n            coordinates: [7.0847929969609424, 50.73855193187643],\n          },\n        },\n      },\n      layout: {\n        "icon-allow-overlap": true,\n        "icon-size": 0.14,\n        "icon-offset": [0, -180],\n      },\n    }}\n    imgSrc={wgMarker}\n  />\n)'}},l.parameters)},1109:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(5),a=r(0),o=r(16),i=r(323),s=r.n(i),c=(r(1073),r(34)),l=r(1),u=function(e){var t=Object(a.useContext)(c.b),r=Object(a.useRef)(!1),n=Object(a.useRef)(null),i=Object(a.useState)(50),u=Object(o.a)(i,2),p=u[0],d=u[1],f=Object(a.useRef)(50),m=Object(a.useState)(50),g=Object(o.a)(m,2),h=g[0],y=g[1],b=Object(a.useRef)(50),v=Object(a.useRef)(e.magnifierRadius),j=Object(a.useState)(v.current),O=Object(o.a)(j,2),x=O[0],S=O[1],M=Object(a.useCallback)((function(){return!(!e.map1Id||!e.map2Id)&&!(!t.getMap(e.map1Id)||!t.getMap(e.map2Id))}),[e,t]),C=Object(a.useRef)((function(){M()&&L({clientX:f.current,clientY:b.current})}));Object(a.useEffect)((function(){window.addEventListener("resize",C.current);var e=C.current;return function(){window.removeEventListener("resize",e),n.current&&n.current()}}),[]);var L=Object(a.useCallback)((function(r){if(M()){var n=t.maps[e.map1Id].getCanvas().getBoundingClientRect(),a=r.clientX||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientX:0),o=r.clientY||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientY:0);a-=n.x,o-=n.y;var i=(a/n.width*100).toFixed(2),s=(o/n.height*100).toFixed(2);f.current===i&&b.current===s||(d(i),f.current=i,y(s),b.current=s,t.maps[e.map2Id].getContainer().style.clipPath="circle(".concat(v.current,"px at ")+f.current*n.width/100+"px "+b.current*n.height/100+"px)")}}),[t,M,e]);Object(a.useEffect)((function(){M()&&!r.current&&(r.current=!0,n.current=s()(t.getMap(e.map1Id).map,t.getMap(e.map2Id).map),t.maps[e.map1Id].getCanvas().clientWidth>t.maps[e.map1Id].getCanvas().clientHeight&&2*v.current>t.maps[e.map1Id].getCanvas().clientHeight&&(v.current=Math.floor(t.maps[e.map1Id].getCanvas().clientHeight/2),S(v.current)),t.maps[e.map1Id].getCanvas().clientHeight>t.maps[e.map1Id].getCanvas().clientWidth&&2*v.current>t.maps[e.map1Id].getCanvas().clientWidth&&(v.current=Math.floor(t.maps[e.map1Id].getCanvas().clientWidth/2),S(v.current)),L({clientX:t.maps[e.map1Id].getCanvas().clientWidth/2,clientY:t.maps[e.map1Id].getCanvas().clientHeight/2}))}),[t.mapIds,t,M,e,L]);var w=function(e){e.touches?(document.addEventListener("touchmove",L),document.addEventListener("touchend",I)):(document.addEventListener("mousemove",L),document.addEventListener("mouseup",E))},I=function e(){document.removeEventListener("touchmove",L),document.removeEventListener("touchend",e)},E=function e(){document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",e)};return Object(l.jsx)("div",{style:{position:"absolute",left:p+"%",top:h+"%",borderRadius:"50%",width:2*x+1+"px",height:2*x+1+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:-1*x-1+"px",marginTop:-1*x-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none"},onTouchStart:w,onMouseDown:w,onWheel:function(e){var r=new WheelEvent(e.type,e);t.map.getCanvas().dispatchEvent(r)}})};u.defaultProps={magnifierRadius:200},u.__docgenInfo={description:'Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals\nthe map and can be dragged around on top of the MapLibreMap referenced by props.map1Id\n\n@component',methods:[],displayName:"MlLayerMagnify",props:{magnifierRadius:{defaultValue:{value:"200",computed:!1},type:{name:"number"},required:!1,description:'Size of the "magnifier"-circle'},map1Id:{type:{name:"string"},required:!1,description:"Id of the first MapLibre instance"},map2Id:{type:{name:"string"},required:!1,description:"Id of the second MapLibre instance"}}};var p=u;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerMagnify/MlLayerMagnify.js"]={name:"MlLayerMagnify",docgenInfo:u.__docgenInfo,path:"src/components/MlLayerMagnify/MlLayerMagnify.js"});var d=r(111),f=r(206),m={title:"MapComponents/MlLayerMagnify",component:p,argTypes:{url:{},layer:{}},decorators:f.a},g=(t.default=m,function(e){return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(d.a,{url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"},sourceOptions:{minzoom:13,maxzoom:20},mapId:e.wmsLayerMapId}),Object(l.jsx)(p,{map1Id:"map_1",map2Id:"map_2",magnifierRadius:e.magnifierRadius})]})}.bind({}));g.parameters={},g.args={wmsLayerMapId:"map_2",magnifierRadius:200},g.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <>\n    <MlWmsLayer\n      url="https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme"\n      urlParameters={{\n        layers: "nw_uraufnahme_rw",\n      }}\n      sourceOptions={{\n        minzoom: 13,\n        maxzoom: 20,\n      }}\n      mapId={args.wmsLayerMapId}\n    />\n    <MlLayerMagnify map1Id="map_1" map2Id="map_2" magnifierRadius={args.magnifierRadius} />\n  </>\n)'}},g.parameters)},111:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(34),i=r(3),s=r.n(i),c=r(215),l=r(1),u={visible:!0,urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",width:256,height:256,styles:""},attribution:"",sourceOptions:{minZoom:0,maxZoom:20},layerOptions:{minZoom:0,maxZoom:20}},p=function(e){var t=Object(a.useContext)(o.b),r=Object(a.useRef)(e.layerId||"MlWmsLayer-"+Object(c.a)()),i=Object(a.useRef)(null),s=Object(a.useRef)(!1),p=Object(a.useRef)(e.layerId||r.current);return Object(a.useEffect)((function(){var e=r.current;return function(){i.current&&(i.current.cleanup(e),i.current=null),s.current=!1}}),[]),Object(a.useEffect)((function(){var a;if(t.mapExists(e.mapId)&&!s.current&&(i.current=t.getMap(e.mapId),i.current)){var o;s.current=!0;var c=e.url;-1!==e.url.indexOf("?")&&(c=(o=e.url.split("?"))[0]);var l=new URLSearchParams(null===(a=o)||void 0===a?void 0:a[1]),d=Object(n.a)(Object(n.a)(Object(n.a)({},u.urlParameters),Object.fromEntries(l)),e.urlParameters),f=new URLSearchParams(d),m=decodeURIComponent(f.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");i.current.addSource(p.current,Object(n.a)({type:"raster",tiles:[c+"?"+m],tileSize:d.width,attribution:e.attribution},e.sourceOptions),r.current),i.current.addLayer(Object(n.a)({id:p.current,type:"raster",source:r.current},e.layerOptions),e.insertBeforeLayer,r.current),e.visible||i.current.setLayoutProperty(r.current,"visibility","none")}}),[t.mapIds,t,e]),Object(a.useEffect)((function(){i.current&&s.current&&(e.visible?i.current.setLayoutProperty(r.current,"visibility","visible"):i.current.setLayoutProperty(r.current,"visibility","none"))}),[e.visible]),Object(l.jsx)(l.Fragment,{})};p.defaultProps=Object(n.a)({},u),p.propTypes={url:s.a.string.isRequired,urlParameters:s.a.shape({layers:s.a.string.isRequired,bbox:s.a.string,format:s.a.string,service:s.a.string,version:s.a.string,request:s.a.string,srs:s.a.string,width:s.a.number,height:s.a.number}),mapId:s.a.string,attribution:s.a.string,layerOptions:s.a.object,sourceOptions:s.a.object,insertBeforeLayer:s.a.string,visible:s.a.bool},p.__docgenInfo={description:'Adds a WMS raster source & layer to the maplibre-gl instance\n\n@param {object} props\n@param {object} props.urlParameters URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object\n@param {string} props.url WMS URL\n@param {bool} props.visible Sets layer "visibility" property to "visible" if true or "none" if false\n@param {string} props.attribution MapLibre attribution shown in the bottom right of the map, if this layer is visible\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n@param {object} props.sourceOptions Object that is passed to the MapLibre.addSource call as config option parameter\n@param {object} props.layerOptions Object that is passed to the MapLibre.addLayer call as config option parameter\n@param {string} props.insertBeforeLayer Id of an existing layer in the mapLibre instance to help specify the layer order\n                                           This layer will be visually beneath the layer with the "insertBeforeLayer" id\n\n@component',methods:[],displayName:"MlWmsLayer",props:{visible:{defaultValue:{value:"true",computed:!1},type:{name:"bool"},required:!1,description:'Sets layer "visibility" property to "visible" if true or "none" if false'},urlParameters:{defaultValue:{value:'{\n  bbox: "{bbox-epsg-3857}",\n  format: "image/png",\n  service: "WMS",\n  version: "1.1.1",\n  request: "GetMap",\n  srs: "EPSG:3857",\n  width: 256,\n  height: 256,\n  styles: "",\n}',computed:!1},type:{name:"shape",value:{layers:{name:"string",required:!0},bbox:{name:"string",required:!1},format:{name:"string",required:!1},service:{name:"string",required:!1},version:{name:"string",required:!1},request:{name:"string",required:!1},srs:{name:"string",required:!1},width:{name:"number",required:!1},height:{name:"number",required:!1}}},required:!1,description:"URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object."},attribution:{defaultValue:{value:'""',computed:!1},type:{name:"string"},required:!1,description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible"},sourceOptions:{defaultValue:{value:"{\n  minZoom: 0,\n  maxZoom: 20,\n}",computed:!1},type:{name:"object"},required:!1,description:"Object that is passed to the MapLibre.addSource call as config option parameter"},layerOptions:{defaultValue:{value:"{\n  minZoom: 0,\n  maxZoom: 20,\n}",computed:!1},type:{name:"object"},required:!1,description:"Object that is passed to the MapLibre.addLayer call as config option parameter"},url:{type:{name:"string"},required:!0,description:"WMS URL"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'Id of an existing layer in the mapLibre instance to help specify the layer order\nThis layer will be visually beneath the layer with the "insertBeforeLayer" id.'}}},t.a=p,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsLayer/MlWmsLayer.js"]={name:"MlWmsLayer",docgenInfo:p.__docgenInfo,path:"src/components/MlWmsLayer/MlWmsLayer.js"})},1110:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(5),a=r(0),o=r(16),i=r(323),s=r.n(i),c=(r(1074),r(34)),l=r(1),u=function(e){var t=Object(a.useContext)(c.b),r=Object(a.useRef)(!1),n=Object(a.useState)(50),i=Object(o.a)(n,2),u=i[0],p=i[1],d=Object(a.useRef)(50),f=Object(a.useRef)(null),m=Object(a.useCallback)((function(){return!(!e.map1Id||!e.map2Id)&&!(!t.getMap(e.map1Id)||!t.getMap(e.map2Id))}),[t,e.map1Id,e.map2Id]),g=function(){f.current&&f.current()},h=Object(a.useCallback)((function(r){if(m()){var n=t.maps[e.map1Id].getCanvas().getBoundingClientRect(),a=r.clientX||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientX:0),o=((a-=n.x)/n.width*100).toFixed(2);if(d.current!==o){p(o),d.current=o;var i="rect(0, "+d.current*n.width/100+"px, 999em, 0)";t.maps[e.map2Id].getContainer().style.clip=i}}}),[t,m,e.map1Id,e.map2Id]);Object(a.useEffect)((function(){return g}),[]),Object(a.useEffect)((function(){m()&&!r.current&&(r.current=!0,f.current=s()(t.getMap(e.map1Id).map,t.getMap(e.map2Id).map),h({clientX:t.maps[e.map1Id].getCanvas().clientWidth/2}))}),[t.mapIds,t,e,h,m]);var y=function(e){e.touches?(document.addEventListener("touchmove",h),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",h),document.addEventListener("mouseup",v))},b=function e(){document.removeEventListener("touchmove",h),document.removeEventListener("touchend",e)},v=function e(){document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",e)};return Object(l.jsx)("div",{style:{position:"absolute",left:u+"%",top:"50%",borderRadius:"50%",width:"100px",height:"100px",background:"#0066ff",border:"3px solid #eaebf1",cursor:"pointer",zIndex:"110",marginLeft:"-50px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none"},onTouchStart:y,onMouseDown:y})};u.__docgenInfo={description:"MlLayerSwipe returns a Button that will add a standard OSM tile layer to the maplibre-gl instance, that you can move like a curtain.\n\n@component",methods:[],displayName:"MlLayerSwipe",props:{map1Id:{type:{name:"string"},required:!1,description:"Id of the first MapLibre instance."},map2Id:{type:{name:"string"},required:!1,description:"Id of the second MapLibre instance."}}};var p=u;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerSwipe/MlLayerSwipe.js"]={name:"MlLayerSwipe",docgenInfo:u.__docgenInfo,path:"src/components/MlLayerSwipe/MlLayerSwipe.js"});var d=r(111),f=r(206),m={title:"MapComponents/MlLayerSwipe",name:"MlLayerSwipe",component:p,argTypes:{url:{},layer:{}},decorators:f.a},g=(t.default=m,function(e){return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(d.a,{url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"},sourceOptions:{minzoom:13,maxzoom:20},mapId:"map_2"}),Object(l.jsx)(p,{map1Id:"map_1",map2Id:"map_2"})]})}.bind({}));g.parameters={},g.args={},g.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <>\n    <MlWmsLayer\n      url="https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme"\n      urlParameters={{\n        layers: "nw_uraufnahme_rw",\n      }}\n      sourceOptions={{\n        minzoom: 13,\n        maxzoom: 20,\n      }}\n      mapId="map_2"\n    />\n    <MlLayerSwipe map1Id="map_1" map2Id="map_2" />\n  </>\n)'}},g.parameters)},1111:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return L}));var n=r(5),a=r(0),o=r(316),i=r(16),s=r(34),c=r(1130),l=r(1205),u=r(620),p=r.n(u),d=r(621),f=r.n(d),m=r(619),g=r.n(m),h=r(215),y=r(253),b=r(254),v=r(1125),j=r(1),O=["color"],x=function(e){var t=Object(a.useContext)(s.b),r=Object(a.useRef)(!1),u=Object(a.useRef)(void 0),d=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlComponentTemplate-")+Object(h.a)()),m=Object(a.useState)(0),x=Object(i.a)(m,2),S=x[0],M=x[1],C=Object(a.useState)(!1),L=Object(i.a)(C,2),w=L[0],I=L[1],E=Object(v.a)("(max-width:900px)"),T={minWidth:"20px",minHeight:"20px",width:E?"50px":"30px",height:E?"50px":"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,fontSize:E?"1.5em":"1.2em",":hover":{backgroundColor:"#515151"},color:"#ececec"};Object(a.useEffect)((function(){var e=d.current;return function(){u.current&&(u.current.cleanup(e),u.current=void 0),r.current=!1}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,u.current=t.getMap(e.mapId),u.current.on("pitchend",(function(){M(u.current.getPitch())}),d.current),M(u.current.getPitch()))}),[t.mapIds,t,e.mapId]);var _,R=function(e){u.current.setCenter([e.coords.longitude,e.coords.latitude])},A=function(){console.log("Access of user location denied"),I(!0)};return Object(j.jsxs)("div",{style:{zIndex:501,position:"absolute",right:E?"15px":"5px",bottom:E?"40px":"20px",display:"flex",flexDirection:"column"},children:[Object(j.jsx)(y.a,{style:{width:"31px",position:"relative",height:E?"55px":"45px",marginLeft:E?"3px":"-5px",transform:E?"scale(1.6)":"scale(1)"},backgroundStyle:{boxShadow:"0px 0px 18px rgba(0,0,0,.5)"}}),Object(j.jsx)(c.a,{sx:Object(n.a)(Object(n.a)({},T),{},{fontWeight:600}),onClick:function(){if(u.current){var e=60;0!==u.current.getPitch()&&(e=0),u.current.easeTo({pitch:e})}},children:S?"2D":"3D"}),Object(j.jsx)(c.a,{sx:T,onClick:function(){navigator.geolocation.getCurrentPosition(R,A)},disabled:w,children:Object(j.jsx)(g.a,{sx:{fontSize:E?"1.5em":"1.2em"}})}),Object(j.jsx)(b.a,{style:Object(n.a)({},(_=T,Object(o.a)(_,O)))}),Object(j.jsxs)(l.a,{orientation:"vertical",sx:{width:"50px",border:"none",Button:{minWidth:"20px !important",border:"none",padding:0},"Button:hover":{border:"none"}},children:[Object(j.jsx)(c.a,{sx:Object(n.a)(Object(n.a)({},T),{},{color:"#ececec"}),onClick:function(){u.current&&u.current.transform._zoom+.5<=u.current.transform._maxZoom&&u.current.easeTo({zoom:u.current.transform._zoom+.5})},children:Object(j.jsx)(p.a,{sx:{fontSize:E?"1.5em":"1.2em"}})}),Object(j.jsx)(c.a,{sx:Object(n.a)(Object(n.a)({},T),{},{color:"#ececec"}),onClick:function(){u.current&&u.current.transform._zoom-.5>=u.current.transform._minZoom&&u.current.easeTo({zoom:u.current.transform._zoom-.5})},children:Object(j.jsx)(f.a,{sx:{fontSize:E?"1.5em":"1.2em"}})})]})]})};x.__docgenInfo={description:"",methods:[],displayName:"MlNavigationTools"};var S=x;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlNavigationTools/MlNavigationTools.js"]={name:"MlNavigationTools",docgenInfo:x.__docgenInfo,path:"src/components/MlNavigationTools/MlNavigationTools.js"});var M=r(40),C={title:"MapComponents/MlNavigationTools",component:S,argTypes:{url:{},layer:{}},decorators:M.a},L=(t.default=C,function(e){return Object(j.jsx)(S,{})}.bind({}));L.parameters={},L.args={},L.parameters=Object(n.a)({storySource:{source:"(args) => <MlNavigationTools />"}},L.parameters)},1112:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(5),a=r(0),o=r(16),i=r(34),s=r(215),c=r(1130),l=r(1),u=function(e){var t=Object(a.useContext)(i.b),r=Object(a.useRef)(void 0),u=Object(a.useState)(!0),p=Object(o.a)(u,2),d=p[0],f=p[1],m=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-")+Object(s.a)()),g=Object(a.useRef)(!1),h=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-source-")+Object(s.a)()),y=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-layer-")+Object(s.a)());return Object(a.useEffect)((function(){var e=m.current;return function(){r.current&&(r.current.cleanup(e),r.current=null)}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!g.current&&(g.current=!0,r.current=t.getMap(e.mapId),r.current.addSource(h.current,Object(n.a)({type:"raster",tileSize:256},e.sourceOptions),m.current),r.current.addLayer(Object(n.a)({id:y.current,type:"raster",source:h.current,minzoom:0,maxzoom:22},e.layerOptions),e.insertBeforeLayer,m.current))}),[t.mapIds,e,t]),Object(a.useEffect)((function(){r.current&&(d?r.current.setLayoutProperty(y.current,"visibility","visible"):r.current.setLayoutProperty(y.current,"visibility","none"))}),[d]),Object(l.jsx)(c.a,{color:"primary",variant:d?"contained":"outlined",onClick:function(){return f(!d)},children:"OSM"})};u.__docgenInfo={description:"Adds a standard OSM tile layer to the maplibre-gl instancereference by\nprops.mapId\n\n@component",methods:[],displayName:"MlOsmLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},sourceOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation."},layerOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addLayer call see MapLibre layer options documentation."},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}};var p=u;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlOsmLayer/MlOsmLayer.js"]={name:"MlOsmLayer",docgenInfo:u.__docgenInfo,path:"src/components/MlOsmLayer/MlOsmLayer.js"});var d=r(86),f=r(40),m={title:"MapComponents/MlOsmLayer",component:p,argTypes:{options:{control:{type:"object"}}},decorators:f.a},g=(t.default=m,function(e){return Object(l.jsx)(d.a,{children:Object(l.jsx)(p,Object(n.a)({},e))})}.bind({}));g.args={sourceOptions:{tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg"],attribution:'Map tiles by <a target="_top" rel="noopener" href="http://stamen.com">Stamen Design</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a target="_top" rel="noopener" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'},layerOptions:{}},g.parameters=Object(n.a)({storySource:{source:"(props) => (\n  <TopToolbar>\n    <MlOsmLayer {...props} />\n  </TopToolbar>\n)"}},g.parameters)},1113:function(e,t,r){"use strict";r.r(t),r.d(t,"Toolbar",(function(){return h})),r.d(t,"Overlay",(function(){return y}));var n=r(5),a=r(0),o=r(16),i=r(34),s=r(215),c=r(1),l=function(e){var t=Object(a.useContext)(i.b),r=Object(a.useRef)(void 0),n=Object(a.useRef)(!1),l=Object(a.useRef)(0),u=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlScaleReference-")+Object(s.a)()),p=Object(a.useState)(0),d=Object(o.a)(p,2),f=d[0],m=d[1],g=Object(a.useState)(""),h=Object(o.a)(g,2),y=h[0],b=h[1];Object(a.useEffect)((function(){var e=u.current;return function(){r.current&&(r.current.cleanup(e),r.current=void 0)}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!n.current&&(n.current=!0,r.current=t.getMap(e.mapId),r.current.on("move",v.current,u.current),v.current())}),[t.mapIds,t,e.mapId]);var v=Object(a.useRef)((function(){if(r.current.map.getZoom()!==l.current){l.current=r.current.map.getZoom();var t=e.maxWidth||100,n=r.current._container.clientHeight/2,a=r.current.unproject([0,n]),o=r.current.unproject([t,n]),i=a.distanceTo(o);if("imperial"===e.unit){var s=3.2808*i;if(s>5280)j(t,s/5280,r.current._getUIString("ScaleControl.Miles"));else j(t,s,r.current._getUIString("ScaleControl.Feet"))}else if("nautical"===e.unit){j(t,i/1852,r.current._getUIString("ScaleControl.NauticalMiles"))}else i>=1e3?j(t,i/1e3,r.current._getUIString("ScaleControl.Kilometers")):j(t,i,r.current._getUIString("ScaleControl.Meters"))}})),j=function(e,t,r){var n=O(t);m(e*(n/t)),b(n+"&nbsp;"+r)},O=function(e){var t=Math.pow(10,"".concat(Math.floor(e)).length-1),r=e/t;return t*(r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r))};return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:f+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:y}})})};l.__docgenInfo={description:"",methods:[],displayName:"MlScaleReference"};var u=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlScaleReference/MlScaleReference.js"]={name:"MlScaleReference",docgenInfo:l.__docgenInfo,path:"src/components/MlScaleReference/MlScaleReference.js"});var p=r(86),d=r(40),f=r(1125),m={title:"MapComponents/MlScaleReference",component:u,argTypes:{url:{},layer:{}},decorators:d.a},g=(t.default=m,function(e){var t=Object(f.a)("(max-width:900px)");return Object(c.jsxs)(c.Fragment,{children:["toolbar"===e.show&&Object(c.jsx)(p.a,{children:Object(c.jsx)(u,Object(n.a)({},e))}),"overlay"===e.show&&Object(c.jsx)("div",{style:{position:"absolute",zIndex:1e5,bottom:t?"40px":"20px",right:"20px"},children:Object(c.jsx)(u,Object(n.a)({},e))})]})}),h=g.bind({});h.args={show:"toolbar"};var y=g.bind({});y.args={show:"overlay"},h.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mediaIsMobile = useMediaQuery("(max-width:900px)");\n  return(\n    <>\n      {props.show === "toolbar" && (\n        <TopToolbar>\n          <MlScaleReference {...props} />\n        </TopToolbar>\n      )}\n      {props.show === "overlay" && (\n        <div\n          style={{\n            position: "absolute",\n            zIndex: 100000,\n            bottom: mediaIsMobile ? "40px" : "20px",\n            right: "20px",\n          }}\n        >\n          <MlScaleReference {...props} />\n        </div>\n      )}\n    </>\n  );\n}'}},h.parameters),y.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mediaIsMobile = useMediaQuery("(max-width:900px)");\n  return(\n    <>\n      {props.show === "toolbar" && (\n        <TopToolbar>\n          <MlScaleReference {...props} />\n        </TopToolbar>\n      )}\n      {props.show === "overlay" && (\n        <div\n          style={{\n            position: "absolute",\n            zIndex: 100000,\n            bottom: mediaIsMobile ? "40px" : "20px",\n            right: "20px",\n          }}\n        >\n          <MlScaleReference {...props} />\n        </div>\n      )}\n    </>\n  );\n}'}},y.parameters)},1114:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return y}));var n=r(5),a=r(16),o=r(0),i=r(3),s=r.n(i),c=r(34),l=r(215),u=r(80),p=r(1),d=function(e){var t=Object(o.useContext)(c.b),r=Object(o.useRef)(!1),i=Object(o.useRef)(void 0),s=Object(o.useState)(void 0),d=Object(a.a)(s,2),f=d[0],m=d[1],g=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlShareMapState-")+Object(l.a)()),h=Object(o.useState)(!0),y=Object(a.a)(h,2),b=y[0],v=y[1],j=Object(u.a)({watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}}),O=Object(o.useRef)({});Object(o.useEffect)((function(){var e=g.current;return function(){i.current&&(i.current.cleanup(e),i.current=void 0),r.current=!1}}),[]),Object(o.useEffect)((function(){if(t.mapExists(e.mapId)&&!r.current){r.current=!0,i.current=t.getMap(e.mapId),m(i.current);var n=x();n.lat&&n.lng&&(O.current.lat=n.lat,O.current.lng=n.lng,O.current.zoom=n.zoom,i.current.setZoom(O.current.zoom))}}),[t.mapIds,t,e.mapId,e.active]),Object(o.useEffect)((function(){if(f&&j.layers&&b){var e=x();if(e.layers)for(var t in e.layers)i.current.getLayer(e.layers[t].id).visibility=e.layers[t].visible?"visible":"none",i.current.getLayer(e.layers[t].id).type=e.layers[t].type}}),[j.layers,e.mapId,e.active]),Object(o.useEffect)((function(){f&&j.layers&&(e.active?(v(!1),f.on("moveend",(function(){var e=[];for(var t in j.layers)e.push(new URLSearchParams({id:j.layers[t].id,type:j.layers[t].type,visible:j.layers[t].visible}));S();var r=new URLSearchParams(Object(n.a)(Object(n.a)(Object(n.a)({},x()),O.current),{},{layers:e})),a=new URLSearchParams(window.location.search);r.toString()!==a.toString()&&window.history.pushState(Object(n.a)({},O.current),document.title,"?"+r.toString())}),g.current)):f.cleanup(g.current))}),[e.active,f]);var x=function(){var e=Object.fromEntries(new URLSearchParams(window.location.search));if(-1!==window.location.search.indexOf("layers")){var t=window.location.search.substring(window.location.search.indexOf("layers"));t=t.substring(0,-1!==t.indexOf("&")?t.indexOf("&"):t.length),e=Object.fromEntries(new URLSearchParams(window.location.search.replace(t,"")));var r=t.substring(7);for(var n in r=(r=(r=(r=r.replaceAll("%3D","=")).replaceAll("%26","&")).replaceAll("%2C",",")).indexOf(",")?r.split(","):[r]){var a=r[n].split("&");for(var o in r[n]={},a)r[n][a[o].split("=")[0]]=a[o].split("=")[1]}e.layers=r}return e},S=function(){O.current.lat=i.current.getCenter().lat,O.current.lng=i.current.getCenter().lng,O.current.zoom=i.current.getZoom()};return window.onpopstate=function(e){e.state&&e.state.lng&&e.state.lat&&e.state.zoom&&i.current.easeTo({zoom:e.state.zoom,center:[e.state.lng,e.state.lat]})},Object(p.jsx)(p.Fragment,{})};d.defaultProps={mapId:void 0},d.propTypes={mapId:s.a.string},d.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlShareMapState",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var f=d;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlShareMapState/MlShareMapState.js"]={name:"MlShareMapState",docgenInfo:d.__docgenInfo,path:"src/components/MlShareMapState/MlShareMapState.js"});var m=r(40),g=r(145),h={title:"MapComponents/MlShareMapState",component:f,argTypes:{},decorators:m.a},y=(t.default=h,function(e){var t=Object(o.useState)(!1),r=Object(a.a)(t,2),n=r[0],i=r[1],s=Object(o.useState)(!0),c=Object(a.a)(s,2),l=c[0],u=c[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("button",{style:{zIndex:"1000",position:"absolute"},onClick:function(){return i(!n)},children:["watch map state ",n?1:0]}),Object(p.jsxs)("button",{style:{zIndex:"1000",position:"absolute"},onClick:function(){return u(!l)},children:["visibility ",l?1:0]}),Object(p.jsx)(f,{active:n}),Object(p.jsx)(g.a,{layerId:"MlLayer-testLayer",options:{layout:{visibility:l?"visible":"none"}}}),Object(p.jsx)(g.a,{layerId:"MlLayer-testLayer2",options:{layout:{visibility:l?"visible":"none"}}}),Object(p.jsx)(g.a,{layerId:"MlLayer-testLayer3",options:{layout:{visibility:l?"visible":"none"}}})]})}.bind({}));y.parameters={},y.args={},y.parameters=Object(n.a)({storySource:{source:'(args) => {\n  const [watchState, setWatchState] = useState(false);\n  const [testLayerVisible, setTestLayerVisible] = useState(true);\n\n  return (\n    <>\n      <button\n        style={{ zIndex: "1000", position: "absolute" }}\n        onClick={() => setWatchState(!watchState)}\n      >\n        watch map state {watchState ? 1 : 0}\n      </button>\n      <button\n        style={{ zIndex: "1000", position: "absolute" }}\n        onClick={() => setTestLayerVisible(!testLayerVisible)}\n      >\n        visibility {testLayerVisible ? 1 : 0}\n      </button>\n      <MlShareMapState active={watchState} />\n      <MlLayer\n        layerId={"MlLayer-testLayer"}\n        options={{ layout: { visibility: testLayerVisible ? "visible" : "none" } }}\n      />\n      <MlLayer\n        layerId={"MlLayer-testLayer2"}\n        options={{ layout: { visibility: testLayerVisible ? "visible" : "none" } }}\n      />\n      <MlLayer\n        layerId={"MlLayer-testLayer3"}\n        options={{ layout: { visibility: testLayerVisible ? "visible" : "none" } }}\n      />\n    </>\n  );\n}'}},y.parameters)},1115:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return M}));var n=r(5),a=r(0),o=r(55),i=r(34),s=r(205),c=r(421),l=r(58),u=r(215),p=r(3),d=r.n(p),f=r(1),m=function(e){var t=Object(a.useContext)(i.b),r=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlSpatialElevationProfile-")+Object(u.a)()),n=Object(a.useRef)(null),p=Object(a.useRef)(!1),d=Object(a.useContext)(s.b),m=Object(a.useRef)("elevationprofile-"+Object(u.a)()),g=Object(a.useRef)("elevationprofile-layer-"+Object(u.a)()),h=Object(a.useCallback)((function(t,r,n,a,o){var i=Object(c.a)([[t,r],[a,o]]),s=Object(l.lineOffset)(i,5,{units:"meters"}),u=s.geometry.coordinates[0][0],p=s.geometry.coordinates[0][1],d=s.geometry.coordinates[1][0],f=s.geometry.coordinates[1][1];return Object(c.b)([[[t,r],[a,o],[d,f],[u,p],[t,r]]],{height:n*e.elevationFactor})}),[e.elevationFactor]);return Object(a.useEffect)((function(){var e=r.current;return function(){n.current&&(n.current.cleanup(e),n.current=null)}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!p.current&&(p.current=!0,n.current=t.getMap(e.mapId),n.current.addSource(m.current,{type:"geojson",data:d.data},r.current),n.current.addLayer({id:g.current,source:m.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"]}},e.insertBeforeLayer,r.current))}),[t.mapIds,e.insertBeforeLayer,e.mapId,d,t]),Object(a.useEffect)((function(){var t;if(n.current&&n.current.getLayer(g.current)){var r=d.data;if(r&&r.features){var a=r.features.find((function(e){return"LineString"===e.geometry.type}));if(a&&a.geometry){var i=a.geometry.coordinates.map((function(e,t){return e[2]})),s=Math.min.apply(Math,Object(o.a)(i)),c=Math.max.apply(Math,Object(o.a)(i))-s;c=0===c?1:c,n.current.setPaintProperty(g.current,"fill-extrusion-color",["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",c*e.elevationFactor,"rgb(255,0,0)"]);var u=function(e,t,r){return e*(1-r)+t*r},p=[];a.geometry.coordinates.forEach((function(e,t){if(a.geometry.coordinates[t+1]){var r=~~(1e3*Object(l.distance)([e[0],e[1]],[a.geometry.coordinates[t+1][0],a.geometry.coordinates[t+1][1]],{units:"kilometers"})/10);r=r<1?1:r;for(var n=0;n<r;n++){var o=u(a.geometry.coordinates[t][0],a.geometry.coordinates[t+1][0],n/r),i=u(a.geometry.coordinates[t][1],a.geometry.coordinates[t+1][1],n/r),c=u(a.geometry.coordinates[t][2]-s,a.geometry.coordinates[t+1][2]-s,n/r),d=u(a.geometry.coordinates[t][0],a.geometry.coordinates[t+1][0],(n+1)/r),f=u(a.geometry.coordinates[t][1],a.geometry.coordinates[t+1][1],(n+1)/r),m=h(o,i,c,d,f);p.push(m)}}}));var f=d.getEmptyFeatureCollection();f.features=p,null===(t=n.current.getSource(m.current))||void 0===t||t.setData(f)}}}}),[d.data,h,d,e.elevationFactor,t]),Object(f.jsx)(f.Fragment,{})};m.defaultProps={elevationFactor:1},m.propTypes={mapId:d.a.string,idPrefix:d.a.string,elevationFactor:d.a.number,insertBeforeLayer:d.a.string},m.__docgenInfo={description:"MlSpatialElevationProfile returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n\n@component",methods:[],displayName:"MlSpatialElevationProfile",props:{elevationFactor:{defaultValue:{value:"1",computed:!1},type:{name:"number"},required:!1,description:"Number describes the factor of the height of the elevation"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}};var g=m;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js"]={name:"MlSpatialElevationProfile",docgenInfo:m.__docgenInfo,path:"src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js"});var h=r(251),y=r(40),b=r(322),v=r(622),j=r.n(v),O=r(638),x=r(1125),S={title:"MapComponents/MlSpatialElevationProfile",component:g,argTypes:{options:{control:{type:"object"}}},decorators:y.a},M=(t.default=S,function(e){var t=Object(x.a)("(max-width:900px)");return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(O.a,{style:{position:"absolute",right:"5px",bottom:t?"145px":"125px",backgroundColor:"rgba(255,255,255,1)",zIndex:1e3},title:"Download sample-data",size:"large",href:"assets/sample.gpx",target:"blank",children:Object(f.jsx)(j.a,{})}),Object(f.jsxs)(b.a,{children:[Object(f.jsx)(h.a,{}),Object(f.jsx)(g,{})]})]})}.bind({}));M.parameters={},M.parameters=Object(n.a)({storySource:{source:'(args) => {\n\n  const mediaIsMobile = useMediaQuery("(max-width:900px)");\n\n  return(\n  <>\n    <IconButton\n      style={{\n        position: "absolute",\n        right: "5px",\n        bottom: mediaIsMobile ? "145px" : "125px",\n        backgroundColor: "rgba(255,255,255,1)",\n\n        zIndex: 1000,\n      }}\n      title="Download sample-data"\n      size="large"\n      href="assets/sample.gpx"\n      target="blank"\n    >\n      <FileDownloadIcon />\n    </IconButton>\n    <GeoJsonProvider>\n      <MlGPXViewer />\n      <MlSpatialElevationProfile />\n    </GeoJsonProvider>\n  </>\n);\n}'}},M.parameters)},1116:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return p}));var n=r(5),a=r(0),o=r(80),i=r(1),s=function(e){var t=Object(o.a)({mapId:e.mapId,watch:Object(n.a)({layers:!0,sources:!1,viewport:!1},e.watch),filter:Object(n.a)({},e.filter)}),r=Object(a.useRef)(0);return r.current=r.current+1,Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{style:{overflow:"hidden",width:"100px",height:"20px"},children:["Render: ",r.current,Object(i.jsx)("br",{}),Object(i.jsx)("pre",{children:JSON.stringify(t,null," ")})]})})};s.defaultProps={mapId:void 0},s.__docgenInfo={description:"Renders a collapsable top-drawer containing live map debug information\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlUseMapDebugger",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var c=s;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlUseMapDebugger/MlUseMapDebugger.js"]={name:"MlUseMapDebugger",docgenInfo:s.__docgenInfo,path:"src/components/MlUseMapDebugger/MlUseMapDebugger.js"});var l=r(40),u={title:"MapComponents/MlUseMapDebugger",component:c,argTypes:{url:{},layer:{}},decorators:l.a},p=(t.default=u,function(e){return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(c,Object(n.a)({},e))})}.bind({}));p.parameters={},p.args={mapId:"map_1"},p.parameters=Object(n.a)({storySource:{source:"(props) => {\n  return (\n    <>\n      <MlUseMapDebugger {...props} />\n    </>\n  );\n}"}},p.parameters)},1117:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return m}));var n=r(5),a=r(0),o=r(34),i=r(3),s=r.n(i),c=r(1),l=function(e){var t=Object(a.useContext)(o.b),r="vector-tile-layer-",i="vector-tile-source-",s=Object(a.useRef)((new Date).getTime()),l=Object(a.useRef)({}),u=Object(a.useRef)({}),p=Object(a.useRef)(!1),d=Object(a.useRef)(null),f=function(){if(d.current&&d.current.style){for(var e in l.current)d.current.getLayer(l.current[e])&&d.current.removeLayer(l.current[e]);d.current.getSource(i+s.current)&&d.current.removeSource(i+s.current)}};return Object(a.useEffect)((function(){return f}),[]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!p.current)for(var a in p.current=!0,d.current=t.getMap(e.mapId),d.current.addSource(i+s.current,{type:"vector",tiles:[e.url],tileSize:512,attribution:""}),e.layers){var o=r+"_"+a+"_"+s.current;l.current[a]=o,d.current.addLayer(Object(n.a)({id:o,source:i+s.current,type:"line",minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2}},e.layers[a])),u.current[a]=JSON.stringify(e.layers[a].paint)}}),[t.mapIds,e,t]),Object(a.useEffect)((function(){if(d.current)for(var r in e.layers)if(d.current.getLayer(l.current[r])){var n=JSON.stringify(e.layers[r].paint);if(n!==u.current[r])for(var a in e.layers[r].paint)t.getMap(e.mapId).setPaintProperty(l.current[r],a,e.layers[r].paint[a]);u.current[r]=n}}),[e.layers,e,t]),Object(a.useEffect)((function(){d.current&&(e.visible?d.current.setLayoutProperty(r+s.current,"visibility","visible"):d.current.setLayoutProperty(r+s.current,"visibility","none"))}),[e.visible]),Object(c.jsx)(c.Fragment,{})};l.propTypes={mapId:s.a.string,sourceOptions:s.a.object,layers:s.a.object,url:s.a.string},l.__docgenInfo={description:"Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by\nprops.mapId\n\n@component",methods:[],displayName:"MlVectorTileLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},sourceOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation."},layers:{type:{name:"object"},required:!1,description:"Object that hold layers"},url:{type:{name:"string"},required:!1,description:"String of the URL of a wms layer"}}};var u=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlVectorTileLayer/MlVectorTileLayer.js"]={name:"MlVectorTileLayer",docgenInfo:l.__docgenInfo,path:"src/components/MlVectorTileLayer/MlVectorTileLayer.js"});var p=r(86),d=r(40),f={title:"MapComponents/MlVectorTileLayer",component:u,argTypes:{url:{},layer:{}},decorators:d.a},m=(t.default=f,function(e){return Object(c.jsx)(p.a,{children:Object(c.jsx)(u,Object(n.a)({},e))})}.bind({}));m.parameters={},m.args={mapId:"map_1",url:"https://wms.wheregroup.com/tileserver/tile/tileserver.php?/europe-0-14/index.json?/europe-0-14/{z}/{x}/{y}.pbf",layers:{landuseLine:{"source-layer":"landuse",layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":2,"line-color":"#ff0000"}}},sourceOptions:{minzoom:0,maxzoom:20}},m.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlVectorTileLayer {...args} />\n  </TopToolbar>\n)"}},m.parameters)},1118:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return m}));var n=r(5),a=r(0),o=r(3),i=r.n(o),s=r(34),c=r(215),l=r(1),u=function(e){var t=Object(a.useContext)(s.b),r=Object(a.useRef)(!1),n=Object(a.useRef)(void 0),o=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlWmsFeatureInfoPopup-")+Object(c.a)());return Object(a.useEffect)((function(){var e=o.current;return function(){n.current&&(n.current.cleanup(e),n.current=void 0),r.current=!1}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,n.current=t.getMap(e.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))}),[t.mapIds,t,e.mapId]),Object(l.jsx)(l.Fragment,{})};u.defaultProps={mapId:void 0},u.propTypes={mapId:i.a.string},u.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var p=u;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.js"]={name:"MlWmsFeatureInfoPopup",docgenInfo:u.__docgenInfo,path:"src/components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.js"});var d=r(40),f={title:"MapComponents/MlWmsFeatureInfoPopup",component:p,argTypes:{url:{},layer:{}},decorators:d.a},m=(t.default=f,function(e){return Object(l.jsx)(p,{})}.bind({}));m.parameters={},m.args={},m.parameters=Object(n.a)({storySource:{source:"(args) => <MlWmsFeatureInfoPopup />"}},m.parameters)},120:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(3),i=r.n(o),s=r(58),c=r(126),l=r(55),u=function(e,t,r,n,a,o,i,c,u,p,d){var f=[],m=[],g=[],h=[];r.current=[];var y=o.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},b=e,v=b,j=y,O=!1;if(void 0===v.geometry&&void 0!==j.geometry&&j.geometry.coordinates.length>1)v=s.lineString(j.geometry.coordinates.slice(0,2));else if(void 0===j.geometry&&void 0!==v.geometry&&v.geometry.coordinates.length>1)j=s.lineString(v.geometry.coordinates.slice(0,2));else if(void 0===j.geometry&&void 0===v.geometry)return;if(v.geometry.coordinates.length<j.geometry.coordinates.length&&(v=y,j=b,O=!0),v&&j)for(var x=0,S=v.geometry.coordinates.length;x<S;x++)void 0!==j.geometry.coordinates[x]&&v.geometry.coordinates[x][0]===j.geometry.coordinates[x][0]&&v.geometry.coordinates[x][1]===j.geometry.coordinates[x][1]?r.current.push(v.geometry.coordinates[x]):(void 0!==v.geometry.coordinates[x]&&m.push(v.geometry.coordinates[x]),void 0!==j.geometry.coordinates[x]&&f.push(j.geometry.coordinates[x]));if(O?(g=f,h=m):(g=m,h=f),!(g.length<2&&h<2)){var M=t.transitionTime/i,C=h.length>1?Math.round(s.length(s.lineString(h))):0,L=g.length>1?Math.round(s.length(s.lineString(g))):0,w=L+C,I=C/w,E=Math.round(M*I),T=Math.round(C/E*100)/100,_=L/w,R=Math.round(M*_),A=Math.round(L/R*100)/100;n.current=[];var P=C;P<=0&&(P=.1);var k={},H={};if(h.length>1){for(k=(H=s.lineChunk(s.lineString(h),T)).features[1],x=0;x<E;x++){if(n.current.push(k),void 0===H.features[x]){n.current.push(k);break}k=s.lineString([].concat(Object(l.a)(k.geometry.coordinates),Object(l.a)(H.features[x].geometry.coordinates)))}n.current.reverse()}if(g.length>1)for(P=0,k=(H=s.lineChunk(s.lineString(g),A)).features[1],x=0;x<R;x++){if(n.current.push(k),void 0===H.features[x]){n.current.push(k);break}k=s.lineString([].concat(Object(l.a)(k.geometry.coordinates),Object(l.a)(H.features[x].geometry.coordinates)))}n.current.push(t.geojson),c.current=1,a.current=!0,d.current=setTimeout((function(){return function e(t,r,n,a,o,i,c,u,p){var d=arguments;if(void 0!==n.getSource(r)&&a.current){if(void 0!==o.current[c.current]){var f,m=c.current+1===o.current.length?t.geojson:s.lineString([].concat(Object(l.a)(i.current),Object(l.a)(o.current[c.current].geometry.coordinates)));if(null==n||null===(f=n.getSource)||void 0===f||!f.call(n,r))return;n.getSource(r).setData(m),"function"==typeof t.onTransitionFrame&&t.onTransitionFrame(m),c.current++,a.current&&c.current<o.current.length?p.current=setTimeout((function(){return e.apply(void 0,Object(l.a)(d))}),u):("function"==typeof t.onTransitionEnd&&t.onTransitionEnd(t.geojson),a.current=!1)}}else p.current=setTimeout((function(){return e.apply(void 0,Object(l.a)(d))}),u)}(t,p,u,a,n,r,c,i,d)}),i)}},p=function(e,t){switch(e){case"fill":return null!=t&&t.fill?t.fill:{"fill-color":"rgba(10,240,256,0.6)"};case"line":return null!=t&&t.line?t.line:{"line-color":"rgb(100,200,100)","line-width":5};case"circle":default:return null!=t&&t.circle?t.circle:{"circle-color":"#44aaaa","circle-stroke-color":"#fff","circle-stroke-width":2}}},d={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},f=function e(t){var r;return"Feature"===(null==t?void 0:t.type)?null!=d&&d[null==t||null===(r=t.geometry)||void 0===r?void 0:r.type]?d[t.geometry.type]:"circle":"FeatureCollection"===(null==t?void 0:t.type)?t.features.length?e(t.features[0]):"circle":void 0},m=r(1),g=["circle","fill","line"],h=function(e){var t=Object(c.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(a.useRef)(!1),o=Object(a.useRef)(e.layerId||"MlGeoJsonLayer-"+t.componentId),i=Object(a.useRef)(void 0),l=Object(a.useRef)(null),d=Object(a.useRef)(!1),h=Object(a.useRef)(void 0),y=Object(a.useRef)(!1),b=Object(a.useRef)([]),v=Object(a.useRef)([]);Object(a.useEffect)((function(){return function(){h.current&&clearTimeout(h.current)}}),[]),Object(a.useEffect)((function(){if(t.map&&r.current)for(var n in e.layout)t.map.setLayoutProperty(o.current,n,e.layout[n])}),[e.layout,t.map,e.mapId]),Object(a.useEffect)((function(){if(t.map&&r.current){var n=e.paint||p(i.current,e.defaultPaintOverrides);for(var a in n)t.map.setPaintProperty(o.current,a,n[a])}}),[e.paint,t.map,e.mapId,e.defaultPaintOverrides]);var j=Object(a.useCallback)((function(r){u(r,e,v,b,d,l,50,y,t.map,o.current,h)}),[e,t.map]);Object(a.useEffect)((function(){var n;null!=t&&null!==(n=t.map)&&void 0!==n&&n.getSource(o.current)&&r.current&&(void 0!==e.transitionTime&&"line"===e.type&&l.current?(d.current=!1,y.current=!1,b.current=[],v.current=[],j(e.geojson)):t.map.getSource(o.current).setData(e.geojson),l.current=e.geojson)}),[e.geojson,e.mapId,t.map,e.type,j,e.transitionTime]);var O=Object(a.useCallback)((function(){var r=e.geojson;"line"===e.type&&void 0!==e.transitionTime&&e.transitionTime&&void 0!==e.geojson.geometry&&(r=s.lineChunk(e.geojson,.01).features[0]);i.current=e.type||f(e.geojson),t.map.addLayer(Object(n.a)({id:o.current,source:{type:"geojson",data:r},type:i.current,paint:e.paint||p(i.current,e.defaultPaintOverrides),layout:e.layout||{}},e.options),e.insertBeforeLayer,t.componentId),void 0!==e.onHover&&t.map.on("mousemove",t.componentId,e.onHover,t.componentId),void 0!==e.onClick&&t.map.on("click",t.componentId,e.onClick,t.componentId),void 0!==e.onLeave&&t.map.on("mouseleave",t.componentId,e.onLeave,t.componentId),"line"===e.type&&void 0!==e.transitionTime&&void 0!==e.geojson.geometry&&(j(e.geojson),l.current=e.geojson)}),[t.map,e,j]);return Object(a.useEffect)((function(){if(t.mapIsReady&&e.geojson){if(r.current&&-1!==g.indexOf(e.type)&&i.current&&e.type!==i.current)t.map.cleanup(t.componentId);else if(r.current&&(-1===g.indexOf(e.type)||-1!==g.indexOf(e.type)&&e.type===i.current))return;r.current=!0,O()}}),[t.mapIsReady,O,e]),Object(m.jsx)(m.Fragment,{})};h.propTypes={mapId:i.a.string,type:i.a.string,layout:i.a.object,paint:i.a.object,defaultPaintOverrides:i.a.object,options:i.a.object,geojson:i.a.object,insertBeforeLayer:i.a.string,layerId:i.a.string,onClick:i.a.func,onHover:i.a.func,onLeave:i.a.func,transitionTime:i.a.number},h.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.\n\n@component',methods:[],displayName:"MlGeoJsonLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},type:{type:{name:"string"},required:!1,description:'Type of the layer that will be added to the MapLibre instance.\nPossible values: "line", "circle", "fill"'},layout:{type:{name:"object"},required:!1,description:"Layout property object, that is passed to the addLayer call.\nPossible props depend on the layer type.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill"},paint:{type:{name:"object"},required:!1,description:"Paint property object, that is passed to the addLayer call.\nPossible props depend on the layer type.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill"},defaultPaintOverrides:{type:{name:"object"},required:!1,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.'},options:{type:{name:"object"},required:!1,description:"Javascript object that is spread into the addLayer commands first parameter."},geojson:{type:{name:"object"},required:!1,description:"GeoJSON data that is supposed to be rendered by this component."},insertBeforeLayer:{type:{name:"string"},required:!1,description:'Id of an existing layer in the mapLibre instance to help specify the layer order\nThis layer will be visually beneath the layer with the "insertBeforeLayer" id.'},layerId:{type:{name:"string"},required:!1,description:"Id of the new layer and source that are added to the MapLibre instance"},onClick:{type:{name:"func"},required:!1,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked."},onHover:{type:{name:"func"},required:!1,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered."},onLeave:{type:{name:"func"},required:!1,description:"Leave event handler that is executed whenever a geometry rendered by this component is\nleft/unhovered."},transitionTime:{type:{name:"number"},required:!1,description:'Creates transition animation whenever the geojson prop changes.\nOnly works with layer type "line" and LineString GeoJSON data.'}}};t.a=h;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGeoJsonLayer/MlGeoJsonLayer.js"]={name:"MlGeoJsonLayer",docgenInfo:h.__docgenInfo,path:"src/components/MlGeoJsonLayer/MlGeoJsonLayer.js"})},126:function(e,t,r){"use strict";var n=r(16),a=r(0),o=r(215),i=r(34),s=r(80);t.a=function(e){var t=Object(a.useContext)(i.b),r=Object(s.a)({mapId:e.mapId,watch:{viewport:!1,layers:!0,sources:!1}}),c=Object(a.useRef)(!1),l=Object(a.useRef)(void 0),u=Object(a.useRef)(Object(o.a)()),p=Object(a.useState)(void 0),d=Object(n.a)(p,2),f=d[0],m=d[1];return Object(a.useEffect)((function(){var e=u.current;return function(){l.current&&(l.current.cleanup(e),l.current=void 0),c.current=!1,m(!1)}}),[]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!c.current){if(e.waitForLayer){var n,a=!1;if(null==r||null===(n=r.layers)||void 0===n||n.forEach((function(t){t.id===e.waitForLayer&&(a=!0)})),!a)return}c.current=!0,l.current=t.getMap(e.mapId),m(!0)}}),[t.mapIds,r.layers,t,e.mapId]),{map:l.current,mapIsReady:f,componentId:u.current,layers:r.layers}}},143:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(34),i=r(594),s=r(55),c=r(316),l=r(413),u=r.n(l),p=r(157),d=r.n(p),f=["lng","lat"],m=function(e){var t=this,r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[]},this.wrapper={on:function(e,t,n,a){if(r.eventHandlers[e]){"string"==typeof n&&(a=n,n={}),r.eventHandlers[e].push({handler:t,options:n});var o=[e,t];a&&"string"==typeof a&&(r.initRegisteredElements(a),r.registeredElements[a].wrapperEvents.push(o))}},off:function(e,t){r.eventHandlers[e]&&(r.eventHandlers[e]=r.eventHandlers[e].filter((function(e){return!Object.is(e.handler,t)&&e})))},fire:function(e,t){if(r.eventHandlers[e]){var n=t||window,a=new Event(e);a.data=r,r.eventHandlers[e].forEach((function(e){e.handler.call(n,a)}))}},layerState:[],layerStateStrings:{},oldLayerStateStrings:{},buildLayerObject:function(e){var t,n,a={},o=null===(t=e.paint)||void 0===t?void 0:t._values;Object.keys(o||{}).forEach((function(e){a[e]=void 0!==o[e].value?o[e].value.value:o[e]}));var i={};return o=null===(n=e.layout)||void 0===n?void 0:n._values,Object.keys(o||{}).forEach((function(e){i[e]=void 0!==o[e].value?o[e].value.value:o[e]})),{id:e.id,type:e.type,visible:"none"!==e.visibility,baseLayer:-1!==r.baseLayers.indexOf(e.id),paint:a,layout:i}},buildLayerObjects:function(){return r.style._order.map((function(e){return r.wrapper.buildLayerObject(r.map.style._layers[e])})).filter((function(e){return e}))},refreshLayerState:function(){r.wrapper.layerState=r.wrapper.buildLayerObjects(),r.wrapper.layerStateStrings=r.wrapper.layerState.map((function(e){return JSON.stringify(e)}))},viewportState:{},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:function(){return"function"==typeof r.map.getCenter?{center:function(e){var t=e.lng,r=e.lat;Object(c.a)(e,f);return{lng:t,lat:r}}(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{}},refreshViewport:function(){r.wrapper.viewportState=r.wrapper.getViewport()}},this.initRegisteredElements=function(e,t){(void 0===r.registeredElements[e]||"undefined"!==t&&t)&&(r.registeredElements[e]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=function(e,t,n){r.map.style&&(n&&"string"==typeof n&&void 0!==e.id&&(r.initRegisteredElements(n),r.registeredElements[n].layers.push(e.id),"object"==typeof e.source&&r.registeredElements[n].sources.push(e.id)),r.map.addLayer(e,t))},this.addSource=function(e,t,n,a){if(r.map.style){if("string"==typeof n&&void 0===a)return r.addSource.call(r,e,t,void 0,n);a&&"string"==typeof a&&void 0!==e&&(r.initRegisteredElements(a),r.registeredElements[a].sources.push(e)),r.map.addSource(e,t,n)}},this.addImage=function(e,t,n,a){if(r.map.style){if("string"==typeof n&&void 0===a)return r.addImage.call(r,e,t,void 0,n);a&&"string"==typeof a&&void 0!==e&&(r.initRegisteredElements(a),r.registeredElements[a].images.push(e)),r.map.addImage(e,t,n)}},this.on=function(e,t,n,a){var o;if("string"==typeof n&&"function"==typeof t)return r.on.call(r,e,void 0,t,n);var i=[e,t,n];t||(i=[e,n]),a&&"string"==typeof a&&(r.initRegisteredElements(a),r.registeredElements[a].events.push(i)),(o=r.map).on.apply(o,Object(s.a)(i))},this.addControl=function(e,t,n){n&&"string"==typeof n&&(r.initRegisteredElements(n),r.registeredElements[n].controls.push(e)),r.map.addControl(e,t)},this.cleanup=function(e){r.map.style&&void 0!==r.registeredElements[e]&&(r.registeredElements[e].layers.forEach((function(e){r.map.style.getLayer(e)&&r.map.style.removeLayer(e)})),r.registeredElements[e].sources.forEach((function(e){r.map.style.getSource(e)&&r.map.style.removeSource(e)})),r.registeredElements[e].images.forEach((function(e){r.map.hasImage(e)&&r.map.style.removeImage(e)})),r.registeredElements[e].events.forEach((function(e){var t;(t=r.map).off.apply(t,Object(s.a)(e))})),r.registeredElements[e].controls.forEach((function(e){r.map.removeControl(e)})),r.registeredElements[e].wrapperEvents.forEach((function(e){var t;(t=r.wrapper).off.apply(t,Object(s.a)(e))})),r.initRegisteredElements(e,!0))};["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach((function(e){t[e]=function(){var n;r.map&&t.map.style&&"function"==typeof r.map.style[e]&&(n=r.map.style)[e].apply(n,arguments);return r.map._update?r.map._update(!0):void 0}}));["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach((function(e){t[e]=function(){var t;return!(!r.map||!r.map.style)&&(t=r.map.style)[e].apply(t,arguments)}})),this.addNativeMaplibreFunctionsAndProps=function(){Object.keys(t.map.__proto__).forEach((function(e){void 0===t[e]&&(t[e]=function(){var t;return(t=r.map)[e].apply(t,arguments)})})),Object.keys(t.map).forEach((function(e){void 0===t[e]&&(t[e]=r.map[e])}))};["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach((function(e){t[e]=function(){if("function"==typeof r.map[e]){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=r.map[e]).call.apply(t,[r.map].concat(a))}}})),function(){var t=Object(i.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e.mapOptions.style||-1!==e.mapOptions.style.indexOf("mapbox://")){t.next=3;break}return t.next=3,fetch(e.mapOptions.style).then((function(e){if(e.ok)return e.json();throw new Error("error loading map style.json")})).then((function(t){t.layers.forEach((function(e){r.baseLayers.push(e.id),r.firstSymbolLayer||"symbol"!==e.type||(r.firstSymbolLayer=e.id)})),r.styleJson=t,e.mapOptions.style=t})).catch((function(e){console.log(e)}));case 3:r.map=new d.a.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(),r.wrapper.fire("viewportchange"),r.map.on("move",(function(){r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.fire("viewportchange")})),r.map.on("data",(function(){r.wrapper.refreshLayerState(),r.wrapper.fire("layerchange")})),"function"==typeof e.onReady&&e.onReady(r.map,r);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()},g=(r(1012),r(1)),h=function(e){var t=Object(a.useRef)(null),r=Object(a.useRef)(null),i=Object(a.useContext)(o.b),s=Object(a.useRef)(i),c=Object(a.useRef)(e.mapId),l=e.options;return Object(a.useEffect)((function(){var e=c.current,r=s.current;return function(){var n,a;r.removeMap(e),null===(n=t.current)||void 0===n||null===(a=n.remove)||void 0===a||a.call(n),t.current=null}}),[]),Object(a.useEffect)((function(){r.current&&(t.current=new m({mapOptions:Object(n.a)({container:r.current},l),onReady:function(t,r){t.once("load",(function(){e.mapId?i.registerMap(e.mapId,r):i.setMap(r)})),window.map=r}}))}),[r]),Object(g.jsx)("div",{ref:r,className:"mapContainer"})};h.defaultProps={mapId:void 0,options:{lng:8.607,lat:53.1409349,zoom:10,accessToken:"pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA"}},h.__docgenInfo={description:"Creates a MapLibreGlWrapper instance and registers it in MapContext\nafter the MapLibre-gl load event has fired.\n\nMapLibreMap returns the html node that will be used by MapLibre-gl to render the map.\nThis Component must be kept unaware of any related components that interact with the MapLibre-gl\ninstance.\n\n@component",methods:[],displayName:"MapLibreMap",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the MapLibreGl(Wrapper) instance in mapContext"},options:{defaultValue:{value:'{\n  lng: 8.607,\n  lat: 53.1409349,\n  zoom: 10,\n  accessToken:\n    "pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA",\n}',computed:!1},type:{name:"object"},required:!1,description:"Config object that is passed to the MapLibreGl constructor as first parameter.\nSee https://maplibre.org/maplibre-gl-js-docs/api/map/ for a formal documentation of al\navailable properties."}}};t.a=h;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MapLibreMap/MapLibreMap.js"]={name:"MapLibreMap",docgenInfo:h.__docgenInfo,path:"src/components/MapLibreMap/MapLibreMap.js"})},145:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(215),i=r(34),s=r(80),c=r(1),l=function(e){var t=Object(a.useContext)(i.b),r=Object(s.a)({mapId:e.mapId,watch:{viewport:!1,layers:!0,sources:!1}}),l=Object(a.useRef)(!1),u=Object(a.useRef)(null),p=Object(a.useRef)((e.layerId?e.layerId:"MlLayer-")+Object(o.a)()),d=Object(a.useRef)(e.layerId||p.current),f=Object(a.useRef)(void 0),m=Object(a.useRef)(void 0);return Object(a.useEffect)((function(){var e=p.current;return function(){u.current&&(u.current.cleanup(e),u.current=null)}}),[]),Object(a.useEffect)((function(){var r,n;if(t.mapExists(e.mapId)&&null!==(r=t.getMap(e.mapId))&&void 0!==r&&null!==(n=r.getLayer)&&void 0!==n&&n.call(r,d)&&l.current&&e.options){var a,o=JSON.stringify(e.options.layout);if(e.options.layout&&o!==m.current){for(a in e.options.layout)u.current.setLayoutProperty(d,a,e.options.layout[a]);m.current=o}var i=JSON.stringify(e.options.paint);if(e.options.paint&&i===f.current)for(a in e.options.paint)u.current.setPaintProperty(d,a,e.options.paint[a])}}),[e.options,d,t,e]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!l.current){if(e.insertBeforeLayer){var a,o=!1;if(null==r||null===(a=r.layers)||void 0===a||a.forEach((function(t){t.id===e.insertBeforeLayer&&(o=!0)})),!o)return}var i,s;if(u.current=t.getMap(e.mapId),u.current)l.current=!0,u.current.addLayer(Object(n.a)({id:d.current,type:"background",paint:{"background-color":"rgba(0,0,0,0)"}},e.options),e.insertBeforeLayer,p.current),f.current=JSON.stringify(null===(i=e.options)||void 0===i?void 0:i.paint),m.current=JSON.stringify(null===(s=e.options)||void 0===s?void 0:s.layout)}}),[t.mapIds,t,e,r.layers]),Object(c.jsx)(c.Fragment,{})};l.__docgenInfo={description:"",methods:[],displayName:"MlLayer"},t.a=l,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayer/MlLayer.js"]={name:"MlLayer",docgenInfo:l.__docgenInfo,path:"src/components/MlLayer/MlLayer.js"})},205:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0),a=r.n(n).a.createContext({}),o=a.Provider;t.b=a},206:function(e,t,r){"use strict";r(0);var n=r(34),a=r(143),o=(r(569),r(258)),i=r(640),s=r(1),c=Object(o.a)({}),l=[function(e){return Object(s.jsx)("div",{className:"fullscreen_map",children:Object(s.jsx)(i.a,{theme:c,children:Object(s.jsx)(n.a,{children:Object(s.jsxs)("div",{style:{overflow:"hidden",position:"absolute",top:"0",bottom:"0",left:"0",right:"0"},children:[Object(s.jsx)(e,{}),Object(s.jsxs)("div",{className:"maps",children:[Object(s.jsx)(a.a,{mapId:"map_1",options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-liberty.json",center:[7.0851268,50.73884]}}),Object(s.jsx)(a.a,{mapId:"map_2",options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]}})]})]})})})})}];t.a=l},250:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(126),i=r(1),s=function(e){var t=Object(o.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(a.useRef)(!1),s=Object(a.useRef)(e.imageId||"img_"+(new Date).getTime()),c=Object(a.useRef)(e.layerId||"MlImageMarkerLayer-"+t.componentId);Object(a.useEffect)((function(){if(t.mapIsReady&&(!t.map||t.map.getLayer(c.current))&&e.options){var r;if(e.options.layout)for(r in e.options.layout)t.map.setLayoutProperty(c.current,r,e.options.layout[r]);if(e.options.paint)for(r in e.options.paint)t.map.setPaintProperty(c.current,r,e.options.paint[r])}}),[e.options,c.current,e.mapId]);var l=Object(a.useCallback)((function(){var r=Object(n.a)({id:c.current,layout:{}},e.options);r.layout["icon-image"]=s.current,t.map.addLayer(r,e.insertBeforeLayer,t.componentId)}),[e,t.mapIsReady,t.map]);return Object(a.useEffect)((function(){e.options&&t.mapIsReady&&!r.current&&(r.current=!0,e.imgSrc&&t.map.loadImage(e.imgSrc,(function(e,r){if(e)throw e;t.map.addImage(s.current,r,t.componentId)})),l())}),[t.mapIsReady,t.map,l,e]),Object(a.useEffect)((function(){t.mapIsReady&&(!t.map||t.map.getLayer(c.current))&&e.options&&t.map.getSource(c.current).setData(e.options.source.data)}),[e.options.source.data,e]),Object(i.jsx)(i.Fragment,{})};s.__docgenInfo={description:"",methods:[],displayName:"MlImageMarkerLayer"},t.a=s,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlImageMarkerLayer/MlImageMarkerLayer.js"]={name:"MlImageMarkerLayer",docgenInfo:s.__docgenInfo,path:"src/components/MlImageMarkerLayer/MlImageMarkerLayer.js"})},251:function(e,t,r){"use strict";var n=r(55),a=r(16),o=r(0),i=r(34),s=r(58),c=r(1134),l=r(639),u=r(1129),p=r(638),d=r(610),f=r.n(d),m=r(609),g=r.n(m),h=r(157),y=r(1135),b=r(1127),v=r(1136),j=r(205),O=r(608),x=r(1125),S=r(215),M=r(1),C=function(e){var t=Object(o.useContext)(j.b),r=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlGpxViewer-")+Object(S.a)()),d=Object(o.useContext)(i.b),m=e.mapId,C=Object(o.useRef)(!1),L=Object(o.useRef)(null),w="importer-layer-lines",I="importer-layer-points",E=Object(o.useState)(!1),T=Object(a.a)(E,2),_=T[0],R=T[1],A=Object(o.useRef)(null),P=Object(o.useState)(0),k=Object(a.a)(P,2),H=k[0],F=k[1],N=Object(o.useState)([]),U=Object(a.a)(N,2),B=U[0],G=U[1],D=Object(o.useRef)(null),z=Object(x.a)("(max-width:900px)"),q=Object(o.useRef)(new h.Popup({closeButton:!1,closeOnClick:!0}));Object(o.useEffect)((function(){var e=r.current,t=q.current;return function(){L.current&&(L.current.cleanup(e),L.current.getCanvas().style.cursor="",L.current=null),t.remove()}}),[]),Object(o.useEffect)((function(){d.mapExists(m)&&!C.current&&(C.current=!0,L.current=d.getMap(m),L.current.addSource("import-source",{type:"geojson",data:t.data},r.current),L.current.addLayer({id:w,source:"import-source",type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"}},e.insertBeforeLayer,r.current),L.current.addLayer({id:I,source:"import-source",type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"]},e.insertBeforeLayer,r.current),[w,I].forEach((function(e){L.current.setLayoutProperty(e,"visibility","visible")})),L.current.on("mouseenter",I,(function(t){d.getMap(e.mapId).getCanvas().style.cursor="pointer";for(var r=t.features[0].geometry.coordinates.slice(),n=t.features[0].properties.name;Math.abs(t.lngLat.lng-r[0])>180;)r[0]+=t.lngLat.lng>r[0]?360:-360;q.current.setLngLat(r).setHTML(n).addTo(L.current)})),L.current.on("mouseleave","places",(function(){L.current.getCanvas().style.cursor="",q.current.remove()})),L.current.setZoom(10))}),[d.mapIds,d,t.data,m,e]),Object(o.useEffect)((function(){var e=A.current,t=function(e){F(1e3),V(e)},r=function(){F(0)},n=function(e){F(0),V(e)};return window.addEventListener("dragenter",t),window.addEventListener("dragover",V),e.addEventListener("dragleave",r),window.addEventListener("drop",n),function(){window.removeEventListener("dragenter",t),window.removeEventListener("dragover",V),window.removeEventListener("drop",V),e.removeEventListener("dragleave",r),window.removeEventListener("drop",(function(e){return n}))}}));var V=function(e){e.preventDefault(),e.stopPropagation()};Object(o.useEffect)((function(){if(L.current){var t=e.visible?"visible":"none";[w,I].forEach((function(e){L.current.setLayoutProperty(e,"visibility",t)}))}}),[e.visible]);var W=function(e){if(L.current)try{G([]);var r=(new DOMParser).parseFromString(e,"application/xml");r.querySelector("metadata").childNodes.forEach((function(e){var t=e.textContent,r=e.nodeName;if("link"===e.nodeName&&(t=e.getAttribute("href")),t.trim().length){var a={title:r,value:t,id:(new Date).getTime()};G((function(e){return[].concat(Object(n.a)(e),[a])}))}}));var a=O.a.gpx(r);t.setData(a),L.current.getSource("import-source").setData(a);var o=Object(s.bbox)(a);L.current.fitBounds(o)}catch(e){console.log(e)}};return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("div",{style:{position:"fixed",right:"5px",bottom:z?"40px":"25px",display:"flex",flexDirection:"column",gap:"5px",zIndex:1e3},children:[Object(M.jsxs)(p.a,{onClick:function(){D.current.click()},style:{backgroundColor:"rgba(255,255,255,1)"},size:"large",children:[Object(M.jsx)("input",{ref:D,onChange:function(){var e=D.current.files[0];if(!e)return!1;var t=new FileReader;t.onload=function(e){W(e.currentTarget.result)},t.readAsText(e)},type:"file",id:"input",multiple:!0,style:{display:"none"}}),Object(M.jsx)(g.a,{})]}),Object(M.jsx)(p.a,{onClick:function(){R((function(e){return!e}))},style:{backgroundColor:"rgba(255,255,255,1)"},size:"large",children:Object(M.jsx)(f.a,{})})]}),Object(M.jsxs)(u.a,{variant:"persistent",anchor:"left",open:_,children:[Object(M.jsx)(l.a,{variant:"h6",style:{textAlign:"center",padding:"1em"},noWrap:!0,children:"Informationen zur Route"}),Object(M.jsx)(c.a,{}),Object(M.jsx)(y.a,{children:B.map((function(e){return Object(M.jsx)(b.a,{children:Object(M.jsx)(v.a,{primary:e.value})},"item--".concat(e.id))}))})]}),Object(M.jsx)("div",{onDrop:function(e){if(e.preventDefault(),e.dataTransfer.items){if(e.dataTransfer.items.length>1)return!1;if("file"===e.dataTransfer.items[0].kind){var t=new FileReader;t.onload=function(e){W(e.currentTarget.result)};var r=e.dataTransfer.items[0].getAsFile();t.readAsText(r)}}},ref:A,style:{position:"absolute",left:"0",top:"0",backgroundColor:"rgba(255,255,255,0.5)",width:"100%",height:"100%",zIndex:H},children:Object(M.jsx)(l.a,{variant:"h6",style:{top:"50%",position:"absolute",left:"50%",msTransform:"translate(-50%, -50%)",transform:" translate(-50%, -50%)"},noWrap:!0,children:"Gpx-Datei ablegen"})})]})};C.defaultProps={visible:!0},C.__docgenInfo={description:"MlGPXViewer returns a dropzone and a button to load a GPX Track into the map.\n\n@component",methods:[],displayName:"MlGPXViewer",props:{visible:{defaultValue:{value:"true",computed:!1},type:{name:"bool"},required:!1,description:'Sets the layers layout-property "visibility" to "none" if false or "visible" if true'},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}},t.a=C,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGPXViewer/MlGPXViewer.js"]={name:"MlGPXViewer",docgenInfo:C.__docgenInfo,path:"src/components/MlGPXViewer/MlGPXViewer.js"})},252:function(e,t,r){"use strict";var n=r(16),a=r(0),o=r(120),i=r(1132),s=r(80),c=r(34),l=r(215),u=r(1),p=function(e){var t=Object(a.useContext)(c.b),r=Object(s.a)({mapId:e.mapId,watch:{viewport:!0}}),p=Object(a.useRef)(void 0),d=Object(a.useRef)(!1),f=Object(a.useRef)(void 0),m=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlMarker-")+Object(l.a)()),g=Object(a.useState)({width:"400px",height:"500px"}),h=Object(n.a)(g,2),y=h[0],b=h[1],v=Object(a.useState)(void 0),j=Object(n.a)(v,2),O=j[0],x=j[1];return Object(a.useEffect)((function(){var e=m.current;return function(){f.current&&(f.current.cleanup(e),f.current=void 0),d.current=!1}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!d.current&&(d.current=!0,f.current=t.getMap(e.mapId))}),[t.mapIds,t,e.mapId]),Object(a.useEffect)((function(){var t;if(null!==(t=f.current)&&void 0!==t&&t.project){var r=f.current.project([e.lng,e.lat]);x(r)}}),[e.lng,e.lat,r.viewport]),Object(a.useEffect)((function(){var t,r,n,a;f.current&&null!==(t=p.current)&&void 0!==t&&null!==(r=t.contentWindow)&&void 0!==r&&null!==(n=r.document)&&void 0!==n&&null!==(a=n.body)&&void 0!==a&&a.scrollHeight&&setTimeout((function(){var t,r,n,a,o,i,s,c,l=f.current._container.clientHeight-f.current.project([e.lng,e.lat]).y,u=null===(t=p.current)||void 0===t||null===(r=t.contentWindow)||void 0===r||null===(n=r.document)||void 0===n||null===(a=n.body)||void 0===a?void 0:a.scrollHeight,d=null===(o=p.current)||void 0===o||null===(i=o.contentWindow)||void 0===i||null===(s=i.document)||void 0===s||null===(c=s.body)||void 0===c?void 0:c.scrollWidth;b({width:d,height:l<u?l:u})}),100)}),[e.lng,e.lat,e.content]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(o.a,{geojson:{type:"Feature",geometry:{type:"Point",coordinates:[e.lng,e.lat]},properties:{}},paint:{"circle-radius":14,"circle-color":"rgba(40,200,20,0.5)"},type:"circle",mapId:e.mapId}),O&&Object(u.jsx)(i.a,{sx:{opacity:.7,position:"fixed",display:"flex",left:O.x,top:O.y,width:y.width,height:y.height,"&:hover":{opacity:1},zIndex:-1},children:Object(u.jsx)("iframe",{style:{width:"100%"},srcDoc:e.content,ref:p,sandbox:"allow-same-origin allow-popups-to-escape-sandbox",frameBorder:"0",title:m.current})})]})};p.defaultProps={mapId:void 0},p.__docgenInfo={description:"Adds a marker to the map and displays a marker description next to it\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n@param {number} props.lng\n@param {number} props.lat\n@param {string} props.content\n\n@component",methods:[],displayName:"MlMarker",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},lng:{type:{name:"number"},required:!1,description:"Longitude of the marker position"},lat:{type:{name:"number"},required:!1,description:"Latitude of the marker position"},content:{type:{name:"string"},required:!1,description:"Content of the description popup"}}},t.a=p,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlMarker/MlMarker.js"]={name:"MlMarker",docgenInfo:p.__docgenInfo,path:"src/components/MlMarker/MlMarker.js"})},253:function(e,t,r){"use strict";var n=r(5),a=r(16),o=r(213),i=r(0),s=r(34),c=r(215),l=["title","titleId"];function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function d(e,t){var r=e.title,n=e.titleId,a=p(e,l);return i.createElement("svg",u({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064",ref:t,"aria-labelledby":n},a),r?i.createElement("title",{id:n},r):null,i.createElement("g",{transform:"translate(-86.019554,-58.032633)"},i.createElement("path",{style:{strokeWidth:.744756},d:"m 442.74023,219.33594 -117.62695,32.32422 54.71094,31.12304 c -21.99397,41.5931 -32.8507,84.88283 -38.33008,127.89649 -6.86182,50.94051 -5.95715,103.99765 20.23828,155.46484 5.97246,11.72776 13.65817,23.59773 24.38867,35.06641 2.6597,2.84073 5.65602,5.75455 9.12891,8.68164 0.87557,0.7378 1.85363,1.52609 2.95117,2.35547 0.29669,0.22563 0.63616,0.47742 1.02149,0.75586 l 0.58203,0.42578 34.57812,-15.12305 -0.33789,-0.2207 c -0.0265,-0.0151 -0.0842,-0.0587 -0.18359,-0.13086 -0.46723,-0.34885 -0.9819,-0.76796 -1.56055,-1.25 -2.29757,-1.91343 -4.46539,-4.04643 -6.64062,-6.33985 -8.80052,-9.27114 -15.30333,-19.4993 -20.83985,-30.13867 -24.42289,-46.90715 -24.77465,-97.03535 -18.58008,-146.68164 4.94388,-37.37493 13.65299,-74.4847 30.20508,-109.92969 l 58.6211,33.34766 z",transform:"scale(0.26458333)"})))}var f,m=i.forwardRef(d),g=(r.p,["title","titleId"]);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b(e,t){var r=e.title,n=e.titleId,a=y(e,g);return i.createElement("svg",h({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064",ref:t,"aria-labelledby":n},a),r?i.createElement("title",{id:n},r):null,f||(f=i.createElement("g",{transform:"translate(-86.019554,-58.032633)"},i.createElement("path",{d:"m 94.572523,58.032633 31.122127,8.55245 -14.4756,8.234638 c 5.81924,11.004841 8.69175,22.458582 10.1415,33.839279 1.81552,13.47801 1.57616,27.51604 -5.35471,41.13341 -1.58021,3.10296 -3.61373,6.24356 -6.45284,9.27798 -0.70371,0.75161 -1.49649,1.52256 -2.41535,2.29702 -0.23167,0.19521 -0.49044,0.40378 -0.78083,0.62322 -0.0785,0.0597 -0.16832,0.12632 -0.27027,0.19999 l -0.154,0.11265 -9.148793,-4.00131 0.0894,-0.0584 c 0.007,-0.004 0.02228,-0.0155 0.04857,-0.0346 0.123621,-0.0923 0.259794,-0.20319 0.412895,-0.33073 0.607899,-0.50626 1.181468,-1.07062 1.756997,-1.67742 2.328481,-2.45299 4.049011,-5.15919 5.513881,-7.97419 6.46189,-12.41085 6.55496,-25.67394 4.91598,-38.80952 -1.30807,-9.888781 -3.61235,-19.707408 -7.99176,-29.085561 l -15.510171,8.823235 z"}))))}var v,j=i.forwardRef(b),O=(r.p,["title","titleId"]);function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function M(e,t){var r=e.title,n=e.titleId,a=S(e,O);return i.createElement("svg",x({width:"75.967445mm",height:"234.71339mm",viewBox:"0 0 75.967445 234.71339",ref:t,"aria-labelledby":n},a),r?i.createElement("title",{id:n},r):null,v||(v=i.createElement("g",{transform:"translate(-76.705281,-29.77268)"},i.createElement("path",{d:"m 114.68901,29.77268 37.98372,117.3567 H 76.705281 Z"}),i.createElement("path",{d:"m 114.68901,264.48608 37.98372,-117.3567 H 76.705281 Z"}))))}var C,L,w,I=i.forwardRef(M),E=(r.p,r(161)),T=r(163),_=r(1),R=E.a.div(C||(C=Object(o.a)(["\n  width: 40%;\n  display: flex;\n  align-items: center;\n\n  &:hover {\n    cursor: pointer;\n  }\n  path {\n    filter: drop-shadow(0px 0px 15px rgba(0, 0, 0, 0.2));\n  }\n  &:hover path {\n    filter: drop-shadow(0px 0px 13px rgba(255, 255, 255, 0.1));\n  }\n  path:nth-of-type(2) {\n    fill: #343434;\n  }\n  &:hover path:nth-of-type(2) {\n    fill: #434343;\n  }\n  path:nth-of-type(1) {\n    fill: #e90318;\n  }\n  &:hover path:nth-of-type(1) {\n    fill: #fb4052;\n  }\n"]))),A=E.a.div(L||(L=Object(o.a)(["\n  pointer-events: none;\n  display: flex;\n  z-index: 1002;\n  position: absolute;\n  align-items: center;\n\n  margin-left: -30%;\n  path:nth-of-type(2) {\n  }\n  svg g {\n    transform: translate(-76.7053, -29.7727) scale(2, 1);\n  }\n  svg {\n    z-index: 9990;\n    height: 150px;\n    width: 200px;\n  }\n"]))),P=E.a.div(w||(w=Object(o.a)(["\n  width: 30%;\n  margin-top: 14px;\n  z-index: 999;\n  display: flex;\n\n  svg:hover {\n    cursor: pointer;\n  }\n  svg:hover path {\n    fill: #ececec;\n    filter: drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.1));\n  }\n  path {\n    fill: #bbb;\n  }\n  svg {\n    transform: scale(0.6);\n    z-index: 9990;\n    height: 172px;\n  }\n"]))),k=function(e){var t=Object(i.useContext)(s.b),r=Object(i.useRef)(!1),o=Object(i.useRef)(void 0),l=Object(i.useRef)((e.idPrefix?e.idPrefix:"MlNavigationCompass-")+Object(c.a)()),u=Object(i.useState)(0),p=Object(a.a)(u,2),d=p[0],f=p[1];return Object(i.useEffect)((function(){var e=l.current;return function(){o.current&&(o.current.cleanup(e),o.current=void 0),r.current=!1}}),[]),Object(i.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,o.current=t.getMap(e.mapId),o.current.on("rotate",(function(){f(Math.round(o.current.getBearing()))}),l.current),f(Math.round(o.current.getBearing())))}),[t.mapIds,t,e.mapId]),Object(_.jsx)(_.Fragment,{children:Object(_.jsx)("div",{className:Object(T.a)(Object(n.a)({zIndex:1e3,top:0,position:"absolute"},e.style)),children:Object(_.jsxs)("div",{className:Object(T.a)(Object(n.a)({position:"absolute",border:"10px solid #bcbcbc",backgroundColor:"#717171",background:"radial-gradient(#717171, #414141)",height:"200px",width:"200px",borderRadius:"50%",display:"flex",justifyContent:"center",transform:"scale(0.2) translateX(-448px) translateY(-448px)"},e.backgroundStyle)),children:[Object(_.jsx)(P,{className:Object(T.a)(Object(n.a)({},e.rotateRightStyle)),children:Object(_.jsx)(m,{onClick:function(){var e,t,r=Math.round(null===(e=o.current)||void 0===e?void 0:e.getBearing()),n=Math.round(r%90);r>0&&(n=90-n),0===n&&(n=90),null===(t=o.current)||void 0===t||t.setBearing(Math.round(r+Math.abs(n)))}})}),Object(_.jsx)(R,{className:Object(T.a)(Object(n.a)({},e.needleStyle)),onClick:function(){var e;null===(e=o.current)||void 0===e||e.setBearing(0)},children:Object(_.jsx)(A,{style:{transform:"rotate("+d+"deg)"},children:Object(_.jsx)(I,{})})}),Object(_.jsx)(P,{className:Object(T.a)(Object(n.a)({},e.rotateLeftStyle)),children:Object(_.jsx)(j,{onClick:function(){var e,t,r=Math.round(null===(e=o.current)||void 0===e?void 0:e.getBearing()),n=Math.round(r%90);r<0&&(n=90+n),0===n&&(n=90),null===(t=o.current)||void 0===t||t.setBearing(Math.round(r-Math.abs(n)))}})})]})})})};k.__docgenInfo={description:"Navigation component that displays a compass component which indicates the current oriantation of the map it is registered for and offers controls to turn the bearing 90° left/right or reset north to point up.\n\nAll style props are applied using @emotion/css to allow more complex css selectors.\n\n@component",methods:[],displayName:"MlNavigationCompass",props:{idPrefix:{type:{name:"string"},required:!1,description:"Component id prefix"},style:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the component."},backgroundStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the background."},needleStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the compass needle."},rotateRightStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the rotate right button."},rotateLeftStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the rotate left button."}}};t.a=k;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlNavigationCompass/MlNavigationCompass.js"]={name:"MlNavigationCompass",docgenInfo:k.__docgenInfo,path:"src/components/MlNavigationCompass/MlNavigationCompass.js"})},254:function(e,t,r){"use strict";var n=r(5),a=r(16),o=r(0),i=r(126),s=r(1130),c=r(607),l=r.n(c),u=r(58),p=r(120),d=r(250),f=r.p+"static/media/marker.2f07dbae.png",m=r(1),g=function(e){var t=Object(i.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(o.useState)(!1),c=Object(a.a)(r,2),g=c[0],h=c[1],y=Object(o.useState)(void 0),b=Object(a.a)(y,2),v=b[0],j=b[1],O=Object(o.useRef)(void 0),x=Object(o.useState)(!1),S=Object(a.a)(x,2),M=S[0],C=S[1],L=Object(o.useState)(),w=Object(a.a)(L,2),I=w[0],E=w[1];Object(o.useEffect)((function(){return function(){O.current&&(navigator.geolocation.clearWatch(O.current),O.current=void 0)}}),[]);var T=Object(o.useCallback)((function(e){if(t.map){t.map.setCenter([e.coords.longitude,e.coords.latitude]);var r=Object(u.point)([e.coords.longitude,e.coords.latitude]);j(r),E(Object(u.circle)(r,e.coords.accuracy/1e3))}}),[t.map]),_=function(e){console.log("Access of user location denied"),C(!0)};return Object(o.useEffect)((function(){t.map&&(g?O.current=navigator.geolocation.watchPosition(T,_):navigator.geolocation.clearWatch(O.current))}),[g,T]),Object(m.jsxs)(m.Fragment,{children:[g&&v&&Object(m.jsx)(p.a,{geojson:I,type:"fill",paint:Object(n.a)({"fill-color":"#ee7700","fill-opacity":.5},e.accuracyPaint),insertBeforeLayer:"MlFollowGpsMarker"}),g&&v&&Object(m.jsx)(d.a,{layerId:"MlFollowGpsMarker",options:{type:"symbol",source:{type:"geojson",data:v},layout:Object(n.a)({"icon-size":.1,"icon-offset":[0,-340]},e.markerLayout)},imgSrc:e.markerImage||f}),Object(m.jsxs)(s.a,{sx:Object(n.a)({zIndex:1002,color:g?e.onColor:e.offColor},e.style),disabled:M,onClick:function(){h(!g)},children:[" ",Object(m.jsx)(l.a,{sx:{fontSize:e.style.fontSize}})," "]})]})};g.defaultProps={mapId:void 0,style:{minWidth:"30px",minHeight:"30px",width:"30px",height:"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,fontSize:"1.3em",":hover":{backgroundColor:"#515151",color:"#ececec"}},onColor:"#ececec",offColor:"#666"},g.__docgenInfo={description:"Adds a button that makes the map follow the users GPS position using\nnavigator.geolocation.watchPosition if activated\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlFollowGps",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},style:{defaultValue:{value:'{\n  minWidth: "30px",\n  minHeight: "30px",\n  width: "30px",\n  height: "30px",\n  backgroundColor: "#414141",\n  borderRadius: "23%",\n  margin: 0.15,\n  fontSize: "1.3em",\n  ":hover": {\n    backgroundColor: "#515151",\n    color: "#ececec",\n  },\n}',computed:!1},type:{name:"object"},required:!1,description:"CSS style object that is applied to the button component"},onColor:{defaultValue:{value:'"#ececec"',computed:!1},type:{name:"string"},required:!1,description:"Active button font color"},offColor:{defaultValue:{value:'"#666"',computed:!1},type:{name:"string"},required:!1,description:"Inactive button font color"},accuracyPaint:{type:{name:"object"},required:!1,description:'Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy circle.\nUse any available paint prop from layer type "fill".\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill'},markerLayout:{type:{name:"object"},required:!1,description:'Marker layout property object, that is passed to the MlImageMarkerLayer responsible for drawing the position marker.\nUse any available layout property from layer type "symbol".\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol'},markerImage:{type:{name:"string"},required:!1,description:"Replace the default marker image with a custom one."}}};t.a=g;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFollowGps/MlFollowGps.js"]={name:"MlFollowGps",docgenInfo:g.__docgenInfo,path:"src/components/MlFollowGps/MlFollowGps.js"})},322:function(e,t,r){"use strict";var n=r(16),a=r(0),o=r(205),i=r(1),s=function(e){var t=e.children,r=Object(a.useState)({type:"FeatureCollection",features:[]}),s=Object(n.a)(r,2),c={data:s[0],setData:s[1],getEmptyFeatureCollection:function(){return{type:"FeatureCollection",features:[]}}};return Object(i.jsx)(o.a,{value:c,children:t})};s.__docgenInfo={description:"",methods:[],displayName:"GeoJsonProvider",props:{children:{type:{name:"node"},required:!0,description:""}}},t.a=s,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGPXViewer/util/GeoJsonProvider.js"]={name:"GeoJsonProvider",docgenInfo:s.__docgenInfo,path:"src/components/MlGPXViewer/util/GeoJsonProvider.js"})},327:function(e){e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"coordinates":[[[7.08646747303149,50.74485058672653],[7.084287513691095,50.74371917250187],[7.084437772332876,50.743610683782215],[7.084640903561933,50.743721758552354],[7.085805654941254,50.74293993704128],[7.087023278906713,50.74218320888983],[7.087791368229503,50.74258090834434],[7.088796806075749,50.743261830692745],[7.089275088452752,50.743701110992674],[7.088087117762917,50.74409411011173],[7.087662548338368,50.743784963165815],[7.087184330538875,50.7440368518605],[7.087233860417484,50.744077781245316],[7.08714938625954,50.744122118772154],[7.087057544749172,50.74427276821896],[7.087104984084277,50.744509715654885],[7.08646747303149,50.74485058672653]]],"type":"Polygon"}}]}')},40:function(e,t,r){"use strict";r(0);var n=r(34),a=r(143),o=(r(569),r(258)),i=r(640),s=r(1),c=Object(o.a)({}),l=[function(e){return Object(s.jsx)("div",{className:"fullscreen_map",children:Object(s.jsx)(i.a,{theme:c,children:Object(s.jsxs)(n.a,{children:[Object(s.jsx)(e,{}),Object(s.jsx)(a.a,{options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"})]})})})}];t.a=l},569:function(e,t,r){},608:function(e,t,r){"use strict";(function(e){var n=function(){var t,n=/\s*/g,a=/^\s*|\s*$/g,o=/\s+/;function i(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function s(e,t){return e.getElementsByTagName(t)}function c(e,t){return e.getAttribute(t)}function l(e,t){return parseFloat(c(e,t))}function u(e,t){var r=s(e,t);return r.length?r[0]:null}function p(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function d(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function f(e,t){var r,n,a={};for(n=0;n<t.length;n++)(r=u(e,t[n]))&&(a[t[n]]=d(r));return a}function m(e,t){for(var r in t)e[r]=t[r]}function g(e){return p(e.replace(n,"").split(","))}function h(e){for(var t=e.replace(a,"").split(o),r=[],n=0;n<t.length;n++)r.push(g(t[n]));return r}function y(e){var t,r=[l(e,"lon"),l(e,"lat")],n=u(e,"ele"),a=u(e,"gpxtpx:hr")||u(e,"hr"),o=u(e,"time");return n&&(t=parseFloat(d(n)),isNaN(t)||r.push(t)),{coordinates:r,time:o?d(o):null,heartRate:a?parseFloat(d(a)):null}}if("undefined"!=typeof XMLSerializer)t=new XMLSerializer;else{var b="object"==typeof e&&!e.browser,v="object"==typeof Titanium;if("object"!=typeof exports||!b&&!v)throw new Error("Unable to initialize serializer");t=new(r(1068).XMLSerializer)}function j(e){return void 0!==e.xml?e.xml:t.serializeToString(e)}return{kml:function(e){for(var t={type:"FeatureCollection",features:[]},r={},n={},a={},o=["Polygon","LineString","Point","Track","gx:Track"],l=s(e,"Placemark"),f=s(e,"Style"),m=s(e,"StyleMap"),y=0;y<f.length;y++){var b=i(j(f[y])).toString(16);r["#"+c(f[y],"id")]=b,n[b]=f[y]}for(var v=0;v<m.length;v++){r["#"+c(m[v],"id")]=i(j(m[v])).toString(16);for(var O=s(m[v],"Pair"),x={},S=0;S<O.length;S++)x[d(u(O[S],"key"))]=d(u(O[S],"styleUrl"));a["#"+c(m[v],"id")]=x}for(var M=0;M<l.length;M++)t.features=t.features.concat(w(l[M]));function C(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function L(e){var t=s(e,"coord"),r=[],n=[];0===t.length&&(t=s(e,"gx:coord"));for(var a=0;a<t.length;a++)r.push(p(d(t[a]).split(" ")));for(var o=s(e,"when"),i=0;i<o.length;i++)n.push(d(o[i]));return{coords:r,times:n}}function w(e){var t,i=function e(t){var r,n,a,i,c,l=[],p=[];if(u(t,"MultiGeometry"))return e(u(t,"MultiGeometry"));if(u(t,"MultiTrack"))return e(u(t,"MultiTrack"));if(u(t,"gx:MultiTrack"))return e(u(t,"gx:MultiTrack"));for(a=0;a<o.length;a++)if(n=s(t,o[a]))for(i=0;i<n.length;i++)if(r=n[i],"Point"===o[a])l.push({type:"Point",coordinates:g(d(u(r,"coordinates")))});else if("LineString"===o[a])l.push({type:"LineString",coordinates:h(d(u(r,"coordinates")))});else if("Polygon"===o[a]){var f=s(r,"LinearRing"),m=[];for(c=0;c<f.length;c++)m.push(h(d(u(f[c],"coordinates"))));l.push({type:"Polygon",coordinates:m})}else if("Track"===o[a]||"gx:Track"===o[a]){var y=L(r);l.push({type:"LineString",coordinates:y.coords}),y.times.length&&p.push(y.times)}return{geoms:l,coordTimes:p}}(e),l={},p=d(u(e,"name")),f=d(u(e,"address")),m=d(u(e,"styleUrl")),y=d(u(e,"description")),b=u(e,"TimeSpan"),v=u(e,"TimeStamp"),j=u(e,"ExtendedData"),O=u(e,"LineStyle"),x=u(e,"PolyStyle"),S=u(e,"visibility");if(!i.geoms.length)return[];if(p&&(l.name=p),f&&(l.address=f),m){"#"!==m[0]&&(m="#"+m),l.styleUrl=m,r[m]&&(l.styleHash=r[m]),a[m]&&(l.styleMapHash=a[m],l.styleHash=r[a[m].normal]);var M=n[l.styleHash];if(M){O||(O=u(M,"LineStyle")),x||(x=u(M,"PolyStyle"));var w=u(M,"IconStyle");if(w){var I=u(w,"Icon");if(I){var E=d(u(I,"href"));E&&(l.icon=E)}}}}if(y&&(l.description=y),b){var T=d(u(b,"begin")),_=d(u(b,"end"));l.timespan={begin:T,end:_}}if(v&&(l.timestamp=d(u(v,"when"))),O){var R=C(d(u(O,"color"))),A=R[0],P=R[1],k=parseFloat(d(u(O,"width")));A&&(l.stroke=A),isNaN(P)||(l["stroke-opacity"]=P),isNaN(k)||(l["stroke-width"]=k)}if(x){var H=C(d(u(x,"color"))),F=H[0],N=H[1],U=d(u(x,"fill")),B=d(u(x,"outline"));F&&(l.fill=F),isNaN(N)||(l["fill-opacity"]=N),U&&(l["fill-opacity"]="1"===U?l["fill-opacity"]||1:0),B&&(l["stroke-opacity"]="1"===B?l["stroke-opacity"]||1:0)}if(j){var G=s(j,"Data"),D=s(j,"SimpleData");for(t=0;t<G.length;t++)l[G[t].getAttribute("name")]=d(u(G[t],"value"));for(t=0;t<D.length;t++)l[D[t].getAttribute("name")]=d(D[t])}S&&(l.visibility=d(S)),i.coordTimes.length&&(l.coordTimes=1===i.coordTimes.length?i.coordTimes[0]:i.coordTimes);var z={type:"Feature",geometry:1===i.geoms.length?i.geoms[0]:{type:"GeometryCollection",geometries:i.geoms},properties:l};return c(e,"id")&&(z.id=c(e,"id")),[z]}return t},gpx:function(e){var t,r,n=s(e,"trk"),a=s(e,"rte"),o=s(e,"wpt"),i={type:"FeatureCollection",features:[]};for(t=0;t<n.length;t++)(r=g(n[t]))&&i.features.push(r);for(t=0;t<a.length;t++)(r=h(a[t]))&&i.features.push(r);for(t=0;t<o.length;t++)i.features.push(b(o[t]));function l(e,t){for(var r=0;r<t;r++)e.push(null);return e}function p(e,t){var r=s(e,t),n=[],a=[],o=[],i=r.length;if(i<2)return{};for(var c=0;c<i;c++){var u=y(r[c]);n.push(u.coordinates),u.time&&a.push(u.time),(u.heartRate||o.length)&&(o.length||l(o,c),o.push(u.heartRate||null))}return{line:n,times:a,heartRates:o}}function g(e){for(var t,r=s(e,"trkseg"),n=[],a=[],o=[],i=0;i<r.length;i++)if((t=p(r[i],"trkpt"))&&(t.line&&n.push(t.line),t.times&&t.times.length&&a.push(t.times),o.length||t.heartRates&&t.heartRates.length)){if(!o.length)for(var c=0;c<i;c++)o.push(l([],n[c].length));t.heartRates&&t.heartRates.length?o.push(t.heartRates):o.push(l([],t.line.length||0))}if(0!==n.length){var d=j(e);return m(d,v(u(e,"extensions"))),a.length&&(d.coordTimes=1===n.length?a[0]:a),o.length&&(d.heartRates=1===n.length?o[0]:o),{type:"Feature",properties:d,geometry:{type:1===n.length?"LineString":"MultiLineString",coordinates:1===n.length?n[0]:n}}}}function h(e){var t=p(e,"rtept");if(t.line){var r=j(e);return m(r,v(u(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}function b(e){var t=j(e);return m(t,f(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:y(e).coordinates}}}function v(e){var t={};if(e){var r=u(e,"line");if(r){var n=d(u(r,"color")),a=parseFloat(d(u(r,"opacity"))),o=parseFloat(d(u(r,"width")));n&&(t.stroke=n),isNaN(a)||(t["stroke-opacity"]=a),isNaN(o)||(t["stroke-width"]=96*o/25.4)}}return t}function j(e){var t=f(e,["name","cmt","desc","type","time","keywords"]),r=s(e,"link");r.length&&(t.links=[]);for(var n,a=0;a<r.length;a++)m(n={href:c(r[a],"href")},f(r[a],["text","type"])),t.links.push(n);return t}return i}}}();t.a=n}).call(this,r(165))},611:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.1074676513671875,50.74340774029213],[7.0992279052734375,50.756441089372665],[7.079315185546874,50.764693667025014],[7.045669555664062,50.77945780529241],[7.030563354492187,50.79161300845443],[7.0291900634765625,50.80940599750376],[7.0236968994140625,50.820685846099174],[7.0085906982421875,50.825891011253546],[6.9879913330078125,50.826758482363275],[6.97906494140625,50.835432306955276],[6.9824981689453125,50.84583876895451],[6.9962310791015625,50.85147463352982],[7.012023925781249,50.85710981721644],[7.021636962890625,50.86664473085768],[7.0367431640625,50.872278081520406],[7.0477294921875,50.877044231111014],[7.052536010742187,50.88397594225127]]}}')},612:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.0635223388671875,50.71385204707258],[7.06146240234375,50.709721458354075],[7.063865661621094,50.70298129536074],[7.064552307128906,50.69906720767511],[7.059059143066406,50.69428287906098],[7.05596923828125,50.68797551838366],[7.0580291748046875,50.680797145321655],[7.062835693359375,50.67514068397085],[7.060432434082031,50.6686131506577],[7.051849365234375,50.659255436656736],[7.044639587402344,50.6512019574539],[7.0484161376953125,50.64271166020676],[7.0566558837890625,50.63748609931014]]}}')},617:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.1074676513671875,50.74340774029213],[7.0992279052734375,50.756441089372665],[7.079315185546874,50.764693667025014],[7.045669555664062,50.77945780529241],[7.030563354492187,50.79161300845443],[7.0291900634765625,50.80940599750376],[7.0236968994140625,50.820685846099174],[7.0085906982421875,50.825891011253546],[6.9879913330078125,50.826758482363275],[6.97906494140625,50.835432306955276],[6.9824981689453125,50.84583876895451],[6.9962310791015625,50.85147463352982],[7.012023925781249,50.85710981721644],[7.021636962890625,50.86664473085768],[7.0367431640625,50.872278081520406],[7.0477294921875,50.877044231111014],[7.052536010742187,50.88397594225127]]}}')},618:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.0635223388671875,50.71385204707258],[7.06146240234375,50.709721458354075],[7.063865661621094,50.70298129536074],[7.064552307128906,50.69906720767511],[7.059059143066406,50.69428287906098],[7.05596923828125,50.68797551838366],[7.0580291748046875,50.680797145321655],[7.062835693359375,50.67514068397085],[7.060432434082031,50.6686131506577],[7.051849365234375,50.659255436656736],[7.044639587402344,50.6512019574539],[7.0484161376953125,50.64271166020676],[7.0566558837890625,50.63748609931014]]}}')},693:function(e,t,r){r(694),r(850),r(851),r(1099),r(1090),r(1101),r(1102),r(1103),r(1100),r(1093),r(1104),r(1092),r(1094),r(1105),e.exports=r(1015)},760:function(e,t){},80:function(e,t,r){"use strict";var n=r(16),a=r(0),o=r(3),i=r.n(o),s=r(215),c=r(34);function l(e){var t=Object(a.useContext)(c.b),r=Object(a.useRef)(!1),o=Object(a.useRef)(void 0),i=Object(a.useState)(void 0),l=Object(n.a)(i,2),u=l[0],p=l[1],d=Object(a.useRef)(void 0),f=Object(a.useState)(void 0),m=Object(n.a)(f,2),g=m[0],h=m[1],y=Object(a.useRef)(void 0),b=Object(a.useRef)(Object(s.a)()),v=Object(a.useCallback)((function(t){var r,n;return!((null==e||null===(r=e.filter)||void 0===r||!r.includeBaseLayers)&&t.baseLayer)&&(void 0===(null===(n=e.filter)||void 0===n?void 0:n.matchLayerIds)||(e.filter.matchLayerIds instanceof RegExp?e.filter.matchLayerIds.test(t.id):t.id.includes(e.filter.matchLayerIds)))}),[e.filter]),j=Object(a.useCallback)((function(){var e=o.current.wrapper.layerState.filter(v),t=JSON.stringify(e);y.current!==t&&(y.current=t,h(e))}),[v]);return Object(a.useEffect)((function(){var e=b.current;return function(){o.current&&(o.current.cleanup(e),o.current=void 0),r.current=!1}}),[]),Object(a.useEffect)((function(){var n,a,i,s;t.mapExists(e.mapId)&&!r.current&&(r.current=!0,o.current=t.getMap(e.mapId),null!=e&&null!==(n=e.watch)&&void 0!==n&&n.viewport&&(p(o.current.wrapper.viewportState),o.current.wrapper.on("viewportchange",(function(){var e,t;d.current!==(null===(e=o.current)||void 0===e?void 0:e.wrapper.viewportStateString)&&p(null===(t=o.current)||void 0===t?void 0:t.wrapper.viewportState)}),b.current)),null!=e&&null!==(a=e.watch)&&void 0!==a&&a.layers&&(j(),o.current.wrapper.on("layerchange",j,{includeBaseLayers:null==e||null===(i=e.filter)||void 0===i?void 0:i.includeBaseLayers,matchLayerIds:null==e||null===(s=e.filter)||void 0===s?void 0:s.matchLayerIds},b.current)))}),[t.mapIds,t,e.mapId,j]),{layers:g,viewport:u}}l.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}},l.propTypes={mapId:i.a.string,watch:i.a.shape({layers:i.a.bool,sources:i.a.bool,viewport:i.a.bool}),filter:i.a.shape({includeBaseLayers:i.a.bool,matchLayerIds:i.a.oneOfType([i.a.string,i.a.instanceOf(RegExp)]),matchSourceIds:i.a.oneOfType([i.a.string,i.a.instanceOf(RegExp)])})},t.a=l},851:function(e,t,r){"use strict";r.r(t);r(481)},86:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r(0);var n=r(1131),a=r(1133),o=r(1);function i(e){return Object(o.jsx)("div",{style:{flexGrow:1,zIndex:120,position:"absolute",top:0,left:0,right:0},children:Object(o.jsx)(n.a,{sx:{minHeight:"62px",backgroundColor:"#f1f1f1"},color:"primary",position:"static",children:Object(o.jsx)(a.a,{children:e.children})})})}i.__docgenInfo={description:"",methods:[],displayName:"TopToolbar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/TopToolbar.js"]={name:"TopToolbar",docgenInfo:i.__docgenInfo,path:"src/ui_components/TopToolbar.js"})}});
//# sourceMappingURL=main~24120820.d875ab0c.iframe.bundle.js.map